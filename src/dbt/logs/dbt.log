[0m10:06:09.115095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4BB839B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4BB83CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4BB839E0>]}


============================== 10:06:09.137339 | 9e5746d6-e6bf-4651-a5b4-d77384afe9fe ==============================
[0m10:06:09.137339 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:06:09.137339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Cyber Defense\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init medical_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:06:09.158414 [info ] [MainThread]: Creating dbt configuration folder at C:\Users\Cyber Defense\.dbt
[0m10:06:09.158414 [debug] [MainThread]: Starter project path: C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\include\starter_project
[0m10:06:09.190517 [info ] [MainThread]: 
Your new dbt project "medical_dbt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m10:06:09.191518 [info ] [MainThread]: Setting up your profile.
[0m10:06:09.192518 [error] [MainThread]: Encountered an error:

[0m10:06:09.276518 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 483, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\init.py", line 346, in run
    self.setup_profile(profile_name)
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\init.py", line 242, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\click\termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\Lib\site-packages\click\termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m10:06:09.277515 [debug] [MainThread]: Command `dbt init` failed at 10:06:09.277515 after 0.37 seconds
[0m10:06:09.277515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C48E5E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4C3E85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4BBC5910>]}
[0m10:06:09.277515 [debug] [MainThread]: Flushing usage events
[0m10:06:10.371664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:32.336948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A6534620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A9F5CDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A73EE7E0>]}


============================== 10:10:32.340705 | 2b879c1a-bc24-4dfc-a10d-1a9664ee7622 ==============================
[0m10:10:32.340705 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:10:32.341703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Cyber Defense\\Desktop\\week7\\medical_insights\\src\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Cyber Defense\\Desktop\\week7\\medical_insights\\src\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:10:32.376740 [info ] [MainThread]: dbt version: 1.10.4
[0m10:10:32.376740 [info ] [MainThread]: python version: 3.12.8
[0m10:10:32.376740 [info ] [MainThread]: python path: C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\python.exe
[0m10:10:32.376740 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:10:32.531317 [info ] [MainThread]: Using profiles dir at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt
[0m10:10:32.531317 [info ] [MainThread]: Using profiles.yml file at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt\profiles.yml
[0m10:10:32.531317 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt\dbt_project.yml
[0m10:10:32.531317 [info ] [MainThread]: adapter type: postgres
[0m10:10:32.531317 [info ] [MainThread]: adapter version: 1.9.0
[0m10:10:32.539480 [info ] [MainThread]: Configuration:
[0m10:10:32.540472 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:10:32.540472 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m10:10:32.540472 [info ] [MainThread]: Required dependencies:
[0m10:10:32.540472 [debug] [MainThread]: Executing "git --help"
[0m10:10:32.553655 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:10:32.553655 [debug] [MainThread]: STDERR: "b''"
[0m10:10:32.553655 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:10:32.553655 [info ] [MainThread]: Connection:
[0m10:10:32.553655 [info ] [MainThread]:   host: db
[0m10:10:32.553655 [info ] [MainThread]:   port: 5432
[0m10:10:32.553655 [info ] [MainThread]:   user: user
[0m10:10:32.553655 [info ] [MainThread]:   database: medical_insights
[0m10:10:32.553655 [info ] [MainThread]:   schema: public
[0m10:10:32.553655 [info ] [MainThread]:   connect_timeout: 10
[0m10:10:32.553655 [info ] [MainThread]:   role: None
[0m10:10:32.553655 [info ] [MainThread]:   search_path: None
[0m10:10:32.553655 [info ] [MainThread]:   keepalives_idle: 0
[0m10:10:32.553655 [info ] [MainThread]:   sslmode: None
[0m10:10:32.553655 [info ] [MainThread]:   sslcert: None
[0m10:10:32.568704 [info ] [MainThread]:   sslkey: None
[0m10:10:32.568704 [info ] [MainThread]:   sslrootcert: None
[0m10:10:32.569682 [info ] [MainThread]:   application_name: dbt
[0m10:10:32.569682 [info ] [MainThread]:   retries: 1
[0m10:10:32.570084 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:10:32.943725 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:10:35.310476 [debug] [MainThread]: Using postgres connection "debug"
[0m10:10:35.310476 [debug] [MainThread]: On debug: select 1 as id
[0m10:10:35.310476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:38.015075 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: No such host is known. 

[0m10:10:40.716043 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:10:40.716043 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:10:40.716043 [debug] [MainThread]: On debug: No close available on handle
[0m10:10:40.717053 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:10:40.717053 [info ] [MainThread]: [31m2 checks failed:[0m
[0m10:10:40.717053 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  source-paths and model-paths cannot both be defined. The `source-paths` config has been deprecated in favor of `model-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt\dbt_project.yml


[0m10:10:40.717053 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "db" to address: No such host is known. 
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:10:40.718049 [debug] [MainThread]: Command `dbt debug` failed at 10:10:40.718049 after 8.62 seconds
[0m10:10:40.718049 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:10:40.719049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A9A6A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A9A68710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A8F399A0>]}
[0m10:10:40.719049 [debug] [MainThread]: Flushing usage events
[0m10:10:41.761901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:28.422717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470F6B3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470F6B36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470F6B2570>]}


============================== 10:11:28.428063 | 34292139-3109-4c35-a5d3-f2891b91ecd5 ==============================
[0m10:11:28.428063 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:11:28.428063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Cyber Defense\\Desktop\\week7\\medical_insights\\src\\dbt\\logs', 'profiles_dir': 'C:\\Users\\Cyber Defense\\Desktop\\week7\\medical_insights\\src\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:11:28.445058 [info ] [MainThread]: dbt version: 1.10.4
[0m10:11:28.446060 [info ] [MainThread]: python version: 3.12.8
[0m10:11:28.446060 [info ] [MainThread]: python path: C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\python.exe
[0m10:11:28.446060 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:11:28.492878 [info ] [MainThread]: Using profiles dir at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt
[0m10:11:28.492878 [info ] [MainThread]: Using profiles.yml file at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt\profiles.yml
[0m10:11:28.492878 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt\dbt_project.yml
[0m10:11:28.493876 [info ] [MainThread]: adapter type: postgres
[0m10:11:28.493876 [info ] [MainThread]: adapter version: 1.9.0
[0m10:11:28.564253 [info ] [MainThread]: Configuration:
[0m10:11:28.565260 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:11:28.565260 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:11:28.565260 [info ] [MainThread]: Required dependencies:
[0m10:11:28.566259 [debug] [MainThread]: Executing "git --help"
[0m10:11:28.591074 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:11:28.591509 [debug] [MainThread]: STDERR: "b''"
[0m10:11:28.591980 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:11:28.591980 [info ] [MainThread]: Connection:
[0m10:11:28.593004 [info ] [MainThread]:   host: db
[0m10:11:28.593004 [info ] [MainThread]:   port: 5432
[0m10:11:28.593004 [info ] [MainThread]:   user: user
[0m10:11:28.594005 [info ] [MainThread]:   database: medical_insights
[0m10:11:28.594005 [info ] [MainThread]:   schema: public
[0m10:11:28.594005 [info ] [MainThread]:   connect_timeout: 10
[0m10:11:28.594005 [info ] [MainThread]:   role: None
[0m10:11:28.595009 [info ] [MainThread]:   search_path: None
[0m10:11:28.595009 [info ] [MainThread]:   keepalives_idle: 0
[0m10:11:28.595009 [info ] [MainThread]:   sslmode: None
[0m10:11:28.595009 [info ] [MainThread]:   sslcert: None
[0m10:11:28.595009 [info ] [MainThread]:   sslkey: None
[0m10:11:28.595009 [info ] [MainThread]:   sslrootcert: None
[0m10:11:28.595009 [info ] [MainThread]:   application_name: dbt
[0m10:11:28.595009 [info ] [MainThread]:   retries: 1
[0m10:11:28.595009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:11:28.795499 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:11:28.847876 [debug] [MainThread]: Using postgres connection "debug"
[0m10:11:28.847876 [debug] [MainThread]: On debug: select 1 as id
[0m10:11:28.848409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:31.537749 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: No such host is known. 

[0m10:11:34.237529 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:11:34.237529 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:11:34.238491 [debug] [MainThread]: On debug: No close available on handle
[0m10:11:34.238491 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:11:34.239488 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:11:34.239488 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "db" to address: No such host is known. 
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:11:34.240490 [debug] [MainThread]: Command `dbt debug` failed at 10:11:34.240490 after 5.97 seconds
[0m10:11:34.240490 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:11:34.240490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470FC96A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470FDEEAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470C90E570>]}
[0m10:11:34.240490 [debug] [MainThread]: Flushing usage events
[0m10:11:35.292233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:13:47.815370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0666e03910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0665b6a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0665b6a740>]}


============================== 07:13:47.818670 | 2c81f140-70fb-4a7a-b7cf-fb8415b522c3 ==============================
[0m07:13:47.818670 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:13:47.820510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/src/dbt/logs', 'profiles_dir': '/app/src/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /app/src/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:13:47.829615 [info ] [MainThread]: dbt version: 1.10.4
[0m07:13:47.831352 [info ] [MainThread]: python version: 3.10.18
[0m07:13:47.832862 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m07:13:47.834363 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m07:13:47.887779 [info ] [MainThread]: Using profiles dir at /app/src/dbt
[0m07:13:47.889476 [info ] [MainThread]: Using profiles.yml file at /app/src/dbt/profiles.yml
[0m07:13:47.890727 [info ] [MainThread]: Using dbt_project.yml file at /app/src/dbt/dbt_project.yml
[0m07:13:47.892426 [info ] [MainThread]: adapter type: postgres
[0m07:13:47.894407 [info ] [MainThread]: adapter version: 1.9.0
[0m07:13:48.002960 [info ] [MainThread]: Configuration:
[0m07:13:48.004848 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:13:48.006765 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:13:48.008463 [info ] [MainThread]: Required dependencies:
[0m07:13:48.010414 [debug] [MainThread]: Executing "git --help"
[0m07:13:48.012241 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m07:13:48.013292 [info ] [MainThread]: Connection:
[0m07:13:48.014456 [info ] [MainThread]:   host: db
[0m07:13:48.015755 [info ] [MainThread]:   port: 5432
[0m07:13:48.016925 [info ] [MainThread]:   user: user
[0m07:13:48.018110 [info ] [MainThread]:   database: medical_insights
[0m07:13:48.019115 [info ] [MainThread]:   schema: public
[0m07:13:48.020481 [info ] [MainThread]:   connect_timeout: 10
[0m07:13:48.022108 [info ] [MainThread]:   role: None
[0m07:13:48.023529 [info ] [MainThread]:   search_path: None
[0m07:13:48.024733 [info ] [MainThread]:   keepalives_idle: 0
[0m07:13:48.025896 [info ] [MainThread]:   sslmode: None
[0m07:13:48.027026 [info ] [MainThread]:   sslcert: None
[0m07:13:48.027846 [info ] [MainThread]:   sslkey: None
[0m07:13:48.028631 [info ] [MainThread]:   sslrootcert: None
[0m07:13:48.029819 [info ] [MainThread]:   application_name: dbt
[0m07:13:48.031113 [info ] [MainThread]:   retries: 1
[0m07:13:48.032450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:13:48.081206 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:13:48.099484 [debug] [MainThread]: Using postgres connection "debug"
[0m07:13:48.100708 [debug] [MainThread]: On debug: select 1 as id
[0m07:13:48.101566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:13:48.105928 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m07:13:48.108650 [debug] [MainThread]: On debug: Close
[0m07:13:48.110096 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:13:48.112139 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:13:48.114033 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m07:13:48.116220 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.393111, "process_in_blocks": "0", "process_kernel_time": 0.070458, "process_mem_max_rss": "109760", "process_out_blocks": "0", "process_user_time": 1.358834}
[0m07:13:48.117534 [debug] [MainThread]: Command `dbt debug` failed at 07:13:48.117427 after 0.39 seconds
[0m07:13:48.118517 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:13:48.119394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0666e03910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066696c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06651db130>]}
[0m07:13:48.120271 [debug] [MainThread]: Flushing usage events
[0m07:13:49.045372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:09.141730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB6725F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB810B080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB93B42F0>]}


============================== 10:17:09.144939 | 19d5beca-c5b3-4e79-abb4-792f68923476 ==============================
[0m10:17:09.144939 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:17:09.146011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Cyber Defense\\Desktop\\week7\\medical_insights\\src\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Cyber Defense\\Desktop\\week7\\medical_insights\\src\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:09.163065 [info ] [MainThread]: dbt version: 1.10.4
[0m10:17:09.163065 [info ] [MainThread]: python version: 3.12.8
[0m10:17:09.163065 [info ] [MainThread]: python path: C:\Users\Cyber Defense\AppData\Local\Programs\Python\Python312\python.exe
[0m10:17:09.165407 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:17:09.214476 [info ] [MainThread]: Using profiles dir at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt
[0m10:17:09.215013 [info ] [MainThread]: Using profiles.yml file at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt\profiles.yml
[0m10:17:09.215013 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Cyber Defense\Desktop\week7\medical_insights\src\dbt\dbt_project.yml
[0m10:17:09.216079 [info ] [MainThread]: adapter type: postgres
[0m10:17:09.216079 [info ] [MainThread]: adapter version: 1.9.0
[0m10:17:09.286402 [info ] [MainThread]: Configuration:
[0m10:17:09.286402 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:17:09.286402 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:17:09.286402 [info ] [MainThread]: Required dependencies:
[0m10:17:09.286402 [debug] [MainThread]: Executing "git --help"
[0m10:17:09.315548 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:17:09.315548 [debug] [MainThread]: STDERR: "b''"
[0m10:17:09.315548 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:17:09.315548 [info ] [MainThread]: Connection:
[0m10:17:09.319692 [info ] [MainThread]:   host: db
[0m10:17:09.319692 [info ] [MainThread]:   port: 5432
[0m10:17:09.320207 [info ] [MainThread]:   user: user
[0m10:17:09.320207 [info ] [MainThread]:   database: medical_insights
[0m10:17:09.321254 [info ] [MainThread]:   schema: public
[0m10:17:09.321254 [info ] [MainThread]:   connect_timeout: 10
[0m10:17:09.321254 [info ] [MainThread]:   role: None
[0m10:17:09.322252 [info ] [MainThread]:   search_path: None
[0m10:17:09.322252 [info ] [MainThread]:   keepalives_idle: 0
[0m10:17:09.322252 [info ] [MainThread]:   sslmode: None
[0m10:17:09.323250 [info ] [MainThread]:   sslcert: None
[0m10:17:09.324249 [info ] [MainThread]:   sslkey: None
[0m10:17:09.324249 [info ] [MainThread]:   sslrootcert: None
[0m10:17:09.325249 [info ] [MainThread]:   application_name: dbt
[0m10:17:09.325249 [info ] [MainThread]:   retries: 1
[0m10:17:09.325249 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:17:09.504946 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:17:09.553195 [debug] [MainThread]: Using postgres connection "debug"
[0m10:17:09.553195 [debug] [MainThread]: On debug: select 1 as id
[0m10:17:09.553195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:12.250863 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: No such host is known. 

[0m10:17:14.951231 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:17:14.951231 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:17:14.951231 [debug] [MainThread]: On debug: No close available on handle
[0m10:17:14.951231 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:17:14.951231 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:17:14.951231 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "db" to address: No such host is known. 
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:17:14.951231 [debug] [MainThread]: Command `dbt debug` failed at 10:17:14.951231 after 5.95 seconds
[0m10:17:14.951231 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:17:14.951231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBAE9A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBAE9B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB6725F70>]}
[0m10:17:14.951231 [debug] [MainThread]: Flushing usage events
[0m10:17:15.885075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:18:23.802144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746d45f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746c1c2860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746c1c2800>]}


============================== 07:18:23.805029 | 4364e149-5911-4896-a223-d7602d01af1e ==============================
[0m07:18:23.805029 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:18:23.806489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/src/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /app/src/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:18:23.816030 [info ] [MainThread]: dbt version: 1.10.4
[0m07:18:23.817616 [info ] [MainThread]: python version: 3.10.18
[0m07:18:23.820423 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m07:18:23.822810 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m07:18:23.824925 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m07:18:23.826986 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m07:18:23.828722 [info ] [MainThread]: Using dbt_project.yml file at /app/src/dbt/dbt_project.yml
[0m07:18:23.945526 [info ] [MainThread]: Configuration:
[0m07:18:23.947797 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m07:18:23.949264 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:18:23.951089 [info ] [MainThread]: Required dependencies:
[0m07:18:23.952702 [debug] [MainThread]: Executing "git --help"
[0m07:18:23.954141 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m07:18:23.955505 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:18:23.956733 [info ] [MainThread]: [31m2 checks failed:[0m
[0m07:18:23.958148 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m07:18:23.959304 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m07:18:23.961147 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.2303616, "process_in_blocks": "0", "process_kernel_time": 0.079806, "process_mem_max_rss": "97488", "process_out_blocks": "0", "process_user_time": 1.256957}
[0m07:18:23.962225 [debug] [MainThread]: Command `dbt debug` failed at 07:18:23.962109 after 0.23 seconds
[0m07:18:23.963356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746d45f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746c1c2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746ca6bbe0>]}
[0m07:18:23.964356 [debug] [MainThread]: Flushing usage events
[0m07:18:24.889292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:22:02.636440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9ae77910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d99bce830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d99bce7d0>]}


============================== 07:22:02.639979 | 67f09d7e-67c0-446c-bcd3-c66c6f7c2245 ==============================
[0m07:22:02.639979 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:22:02.641862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/src/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --project-dir /app/src/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:22:02.649058 [info ] [MainThread]: dbt version: 1.10.4
[0m07:22:02.650414 [info ] [MainThread]: python version: 3.10.18
[0m07:22:02.651840 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m07:22:02.653373 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m07:22:02.655121 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m07:22:02.656806 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m07:22:02.658353 [info ] [MainThread]: Using dbt_project.yml file at /app/src/dbt/dbt_project.yml
[0m07:22:02.771023 [info ] [MainThread]: Configuration:
[0m07:22:02.773175 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m07:22:02.774705 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:22:02.776119 [info ] [MainThread]: Required dependencies:
[0m07:22:02.777680 [debug] [MainThread]: Executing "git --help"
[0m07:22:02.779202 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m07:22:02.780028 [info ] [MainThread]: Connection test skipped since no profile was found
[0m07:22:02.781320 [info ] [MainThread]: [31m2 checks failed:[0m
[0m07:22:02.782215 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m07:22:02.783412 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m07:22:02.784798 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21925731, "process_in_blocks": "0", "process_kernel_time": 0.049593, "process_mem_max_rss": "97548", "process_out_blocks": "0", "process_user_time": 1.259687}
[0m07:22:02.785752 [debug] [MainThread]: Command `dbt debug` failed at 07:22:02.785658 after 0.22 seconds
[0m07:22:02.786693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9ae77910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d99bce830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9ab250c0>]}
[0m07:22:02.787925 [debug] [MainThread]: Flushing usage events
[0m07:22:03.737108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:23:16.263762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b665b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b53be980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b53be830>]}


============================== 07:23:16.267330 | 31ddec3b-2429-41f4-9ad2-6d4b3d130338 ==============================
[0m07:23:16.267330 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:23:16.269221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/src/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --project-dir /app/src/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:23:16.276902 [info ] [MainThread]: dbt version: 1.10.4
[0m07:23:16.278275 [info ] [MainThread]: python version: 3.10.18
[0m07:23:16.279746 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m07:23:16.281779 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m07:23:16.328864 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m07:23:16.330512 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m07:23:16.332986 [info ] [MainThread]: Using dbt_project.yml file at /app/src/dbt/dbt_project.yml
[0m07:23:16.334772 [info ] [MainThread]: adapter type: postgres
[0m07:23:16.335946 [info ] [MainThread]: adapter version: 1.9.0
[0m07:23:16.449852 [info ] [MainThread]: Configuration:
[0m07:23:16.451926 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:23:16.453874 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:23:16.455646 [info ] [MainThread]: Required dependencies:
[0m07:23:16.456944 [debug] [MainThread]: Executing "git --help"
[0m07:23:16.458697 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m07:23:16.459814 [info ] [MainThread]: Connection:
[0m07:23:16.460787 [info ] [MainThread]:   host: db
[0m07:23:16.462011 [info ] [MainThread]:   port: 5432
[0m07:23:16.462917 [info ] [MainThread]:   user: user
[0m07:23:16.464426 [info ] [MainThread]:   database: medical_insights
[0m07:23:16.465849 [info ] [MainThread]:   schema: public
[0m07:23:16.467658 [info ] [MainThread]:   connect_timeout: 10
[0m07:23:16.468908 [info ] [MainThread]:   role: None
[0m07:23:16.470170 [info ] [MainThread]:   search_path: None
[0m07:23:16.471764 [info ] [MainThread]:   keepalives_idle: 0
[0m07:23:16.473257 [info ] [MainThread]:   sslmode: None
[0m07:23:16.474652 [info ] [MainThread]:   sslcert: None
[0m07:23:16.475738 [info ] [MainThread]:   sslkey: None
[0m07:23:16.477105 [info ] [MainThread]:   sslrootcert: None
[0m07:23:16.478983 [info ] [MainThread]:   application_name: dbt
[0m07:23:16.481082 [info ] [MainThread]:   retries: 1
[0m07:23:16.483045 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:23:16.531492 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:23:16.551612 [debug] [MainThread]: Using postgres connection "debug"
[0m07:23:16.553679 [debug] [MainThread]: On debug: select 1 as id
[0m07:23:16.554914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:23:16.559658 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m07:23:16.561393 [debug] [MainThread]: On debug: Close
[0m07:23:16.562602 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:23:16.564440 [info ] [MainThread]: [31m1 check failed:[0m
[0m07:23:16.567321 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m07:23:16.570121 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.38286534, "process_in_blocks": "0", "process_kernel_time": 0.079886, "process_mem_max_rss": "109744", "process_out_blocks": "8", "process_user_time": 1.358074}
[0m07:23:16.571459 [debug] [MainThread]: Command `dbt debug` failed at 07:23:16.571345 after 0.38 seconds
[0m07:23:16.572890 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:23:16.574105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b665b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b53be8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b4903220>]}
[0m07:23:16.575285 [debug] [MainThread]: Flushing usage events
[0m07:23:17.522208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:23:29.955832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c32ccf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c31a0e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c31a0e8f0>]}


============================== 07:23:29.959338 | cb47a036-c2e6-4992-a91c-1bd2f320da42 ==============================
[0m07:23:29.959338 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:23:29.961894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/src/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/src/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:23:30.175244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c31142bf0>]}
[0m07:23:30.237479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c31a0e1d0>]}
[0m07:23:30.239624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:23:30.302111 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:23:30.308318 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:23:30.310512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c30d57e20>]}
[0m07:23:31.740151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2c8d4ac0>]}
[0m07:23:31.864388 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:23:31.883104 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:23:31.918155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2c72ee30>]}
[0m07:23:31.920269 [info ] [MainThread]: Found 4 models, 18 data tests, 1 source, 433 macros
[0m07:23:31.922055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2c72edd0>]}
[0m07:23:31.925232 [info ] [MainThread]: 
[0m07:23:31.928050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:23:31.930668 [info ] [MainThread]: 
[0m07:23:31.933041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:23:31.939042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights'
[0m07:23:32.037008 [debug] [ThreadPool]: Using postgres connection "list_medical_insights"
[0m07:23:32.039191 [debug] [ThreadPool]: On list_medical_insights: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights"} */

    select distinct nspname from pg_namespace
  
[0m07:23:32.040741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:32.048564 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m07:23:32.051613 [debug] [ThreadPool]: On list_medical_insights: Close
[0m07:23:32.055159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_insights, now list_medical_insights_public)
[0m07:23:32.063195 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:23:32.065551 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m07:23:32.067584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:23:32.072108 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:23:32.073585 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:23:32.075102 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:23:32.086572 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m07:23:32.089474 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m07:23:32.091328 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m07:23:32.097631 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:32.099190 [debug] [MainThread]: On master: BEGIN
[0m07:23:32.100402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:23:32.103915 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:23:32.105123 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:32.106210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:23:32.116694 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m07:23:32.120215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2c78c6a0>]}
[0m07:23:32.121758 [debug] [MainThread]: On master: ROLLBACK
[0m07:23:32.123145 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:32.124781 [debug] [MainThread]: On master: BEGIN
[0m07:23:32.127197 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:23:32.128975 [debug] [MainThread]: On master: COMMIT
[0m07:23:32.130896 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:32.132518 [debug] [MainThread]: On master: COMMIT
[0m07:23:32.134225 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:23:32.135515 [debug] [MainThread]: On master: Close
[0m07:23:32.141803 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m07:23:32.144058 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_dates ................................... [RUN]
[0m07:23:32.146525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m07:23:32.148198 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m07:23:32.156034 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m07:23:32.191380 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m07:23:32.228460 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_dates"
[0m07:23:32.255399 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:23:32.257163 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: BEGIN
[0m07:23:32.258592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:32.264327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:23:32.266417 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:23:32.268091 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */

  create view "medical_insights"."public"."dim_dates__dbt_tmp"
    
    
  as (
    -- models/marts/dim_dates.sql

WITH date_spine AS (
    SELECT
        GENERATE_SERIES(
            '2023-01-01'::DATE,
            CURRENT_DATE + INTERVAL '1 year',
            '1 day'::INTERVAL
        )::DATE AS date_day
),

date_attributes AS (
    SELECT
        date_day,
        EXTRACT(YEAR FROM date_day) AS year,
        EXTRACT(MONTH FROM date_day) AS month,
        TO_CHAR(date_day, 'Month') AS month_name,
        EXTRACT(DAY FROM date_day) AS day_of_month,
        EXTRACT(DOW FROM date_day) AS day_of_week, -- Sunday = 0, Saturday = 6
        TO_CHAR(date_day, 'Day') AS day_name,
        EXTRACT(DOY FROM date_day) AS day_of_year,
        EXTRACT(WEEK FROM date_day) AS week_of_year,
        EXTRACT(QUARTER FROM date_day) AS quarter_of_year,
        TO_CHAR(date_day, 'YYYY-MM') AS year_month,
        TO_CHAR(date_day, 'YYYY-MM-DD') AS full_date_string,
        (CASE WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE ELSE FALSE END) AS is_weekend
    FROM date_spine
)

SELECT *
FROM date_attributes
  );
[0m07:23:32.279896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m07:23:32.287464 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:23:32.289147 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m07:23:32.291008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:23:32.305927 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m07:23:32.307879 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:23:32.309566 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m07:23:32.313113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:23:32.320294 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_dates__dbt_backup"
[0m07:23:32.325383 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:23:32.327462 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
drop view if exists "medical_insights"."public"."dim_dates__dbt_backup" cascade
[0m07:23:32.330099 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:23:32.335080 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: Close
[0m07:23:32.339592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2f98a140>]}
[0m07:23:32.342170 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_dates .............................. [[32mCREATE VIEW[0m in 0.19s]
[0m07:23:32.343859 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m07:23:32.345184 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m07:23:32.347442 [info ] [Thread-1 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m07:23:32.349782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.stg_telegram_messages)
[0m07:23:32.351784 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m07:23:32.357778 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m07:23:32.378739 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m07:23:32.384606 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.stg_telegram_messages"
[0m07:23:32.404436 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:23:32.406216 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: BEGIN
[0m07:23:32.408032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:32.414646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:23:32.417096 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:23:32.419253 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */

  create view "medical_insights"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

WITH raw_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        data AS raw_data,
        scraped_at
    FROM "medical_insights"."raw"."telegram_messages"
),

cleaned_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        scraped_at,
        raw_data->>'message' AS message_text,
        (raw_data->>'date')::TIMESTAMP AS message_date,
        (raw_data->>'views')::INT AS views_count,
        (raw_data->>'forwards')::INT AS forwards_count,
        (raw_data->>'replies')->>'replies' AS replies_count, -- Assuming replies is a JSON object with a 'replies' key
        (raw_data->>'reactions') IS NOT NULL AS has_reactions,
        (raw_data->>'photo') IS NOT NULL AS has_photo,
        -- Extract product mentions (placeholder regex - refine as needed)
        REGEXP_MATCHES(raw_data->>'message', '(?i)(paracetamol|amoxicillin|ibuprofen|antibiotic|cream|pill)', 'g') AS product_mentions
    FROM raw_messages
    WHERE raw_data->>'message' IS NOT NULL OR raw_data->>'photo' IS NOT NULL
)

SELECT
    id,
    channel_name,
    message_id,
    message_text,
    message_date,
    COALESCE(views_count, 0) AS views_count,
    COALESCE(forwards_count, 0) AS forwards_count,
    COALESCE(replies_count::INT, 0) AS replies_count,
    has_reactions,
    has_photo,
    product_mentions,
    scraped_at
FROM cleaned_messages
  );
[0m07:23:32.422971 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text ->> unknown
LINE 29:         (raw_data->>'replies')->>'replies' AS replies_count,...
                                       ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m07:23:32.424935 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: ROLLBACK
[0m07:23:32.427368 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: Close
[0m07:23:32.435839 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  operator does not exist: text ->> unknown
  LINE 29:         (raw_data->>'replies')->>'replies' AS replies_count,...
                                         ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/medical_dbt/models/staging/stg_telegram_messages.sql
[0m07:23:32.438023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb47a036-c2e6-4992-a91c-1bd2f320da42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2f9baf20>]}
[0m07:23:32.439961 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.stg_telegram_messages .............. [[31mERROR[0m in 0.09s]
[0m07:23:32.441980 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m07:23:32.444149 [debug] [Thread-4 (]: Marking all children of 'model.medical_dbt.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  operator does not exist: text ->> unknown
  LINE 29:         (raw_data->>'replies')->>'replies' AS replies_count,...
                                         ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/medical_dbt/models/staging/stg_telegram_messages.sql.
[0m07:23:32.446651 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m07:23:32.447958 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.dim_channels ....................................... [[33mSKIP[0m]
[0m07:23:32.449355 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m07:23:32.450969 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m07:23:32.452237 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.fct_messages ....................................... [[33mSKIP[0m]
[0m07:23:32.453562 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m07:23:32.455464 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:32.456605 [debug] [MainThread]: On master: BEGIN
[0m07:23:32.457932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:23:32.462814 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:23:32.464454 [debug] [MainThread]: On master: COMMIT
[0m07:23:32.465844 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:32.467071 [debug] [MainThread]: On master: COMMIT
[0m07:23:32.468772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:23:32.470188 [debug] [MainThread]: On master: Close
[0m07:23:32.471719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:32.472952 [debug] [MainThread]: Connection 'model.medical_dbt.stg_telegram_messages' was properly closed.
[0m07:23:32.474164 [info ] [MainThread]: 
[0m07:23:32.475645 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m07:23:32.478641 [debug] [MainThread]: Command end result
[0m07:23:32.524683 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:23:32.537752 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:23:32.551248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m07:23:32.552297 [info ] [MainThread]: 
[0m07:23:32.553965 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:23:32.555916 [info ] [MainThread]: 
[0m07:23:32.557528 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)[0m
[0m07:23:32.559145 [error] [MainThread]:   Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  operator does not exist: text ->> unknown
  LINE 29:         (raw_data->>'replies')->>'replies' AS replies_count,...
                                         ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/medical_dbt/models/staging/stg_telegram_messages.sql
[0m07:23:32.561406 [info ] [MainThread]: 
[0m07:23:32.563013 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/stg_telegram_messages.sql
[0m07:23:32.564642 [info ] [MainThread]: 
[0m07:23:32.566462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m07:23:32.568554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6806965, "process_in_blocks": "5408", "process_kernel_time": 0.160214, "process_mem_max_rss": "127704", "process_out_blocks": "72", "process_user_time": 3.06411}
[0m07:23:32.569936 [debug] [MainThread]: Command `dbt run` failed at 07:23:32.569805 after 2.68 seconds
[0m07:23:32.571285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c32ccf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2f915de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2c78d300>]}
[0m07:23:32.573196 [debug] [MainThread]: Flushing usage events
[0m07:23:33.508982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:24:49.782747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98886b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9875aab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9875aaad0>]}


============================== 07:24:49.786251 | 374f7691-ee06-4fba-a0d0-869e2cad9035 ==============================
[0m07:24:49.786251 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:24:49.787513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/src/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/src/dbt', 'send_anonymous_usage_stats': 'True'}
[0m07:24:49.996066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff986d5c190>]}
[0m07:24:50.056930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98850be50>]}
[0m07:24:50.059221 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:24:50.123633 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:24:50.390830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:24:50.392158 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/stg_telegram_messages.sql
[0m07:24:50.860584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98414c220>]}
[0m07:24:50.983626 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:24:51.014152 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:24:51.044788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98590fdc0>]}
[0m07:24:51.046604 [info ] [MainThread]: Found 4 models, 18 data tests, 1 source, 433 macros
[0m07:24:51.048552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98590f250>]}
[0m07:24:51.051947 [info ] [MainThread]: 
[0m07:24:51.053428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:24:51.054963 [info ] [MainThread]: 
[0m07:24:51.057066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:24:51.063141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights'
[0m07:24:51.099079 [debug] [ThreadPool]: Using postgres connection "list_medical_insights"
[0m07:24:51.100637 [debug] [ThreadPool]: On list_medical_insights: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights"} */

    select distinct nspname from pg_namespace
  
[0m07:24:51.101970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:51.122149 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m07:24:51.124838 [debug] [ThreadPool]: On list_medical_insights: Close
[0m07:24:51.127517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_insights, now list_medical_insights_public)
[0m07:24:51.135050 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:24:51.136180 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m07:24:51.137156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:51.140472 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m07:24:51.141323 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:24:51.142286 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:24:51.146620 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:24:51.149291 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m07:24:51.150362 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m07:24:51.155804 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:51.156712 [debug] [MainThread]: On master: BEGIN
[0m07:24:51.157476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:24:51.160539 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:24:51.162256 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:51.163504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:24:51.169359 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:24:51.170992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9841d0220>]}
[0m07:24:51.171930 [debug] [MainThread]: On master: ROLLBACK
[0m07:24:51.173259 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:51.173981 [debug] [MainThread]: On master: BEGIN
[0m07:24:51.175025 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:24:51.175864 [debug] [MainThread]: On master: COMMIT
[0m07:24:51.176655 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:51.177975 [debug] [MainThread]: On master: COMMIT
[0m07:24:51.179582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:24:51.180550 [debug] [MainThread]: On master: Close
[0m07:24:51.185028 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m07:24:51.186200 [info ] [Thread-1 (]: 1 of 4 START sql view model public.dim_dates ................................... [RUN]
[0m07:24:51.187924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m07:24:51.188889 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m07:24:51.196730 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m07:24:51.206672 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m07:24:51.244631 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_dates"
[0m07:24:51.253173 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:24:51.254279 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: BEGIN
[0m07:24:51.255054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:51.258889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:24:51.260037 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:24:51.261783 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */

  create view "medical_insights"."public"."dim_dates__dbt_tmp"
    
    
  as (
    -- models/marts/dim_dates.sql

WITH date_spine AS (
    SELECT
        GENERATE_SERIES(
            '2023-01-01'::DATE,
            CURRENT_DATE + INTERVAL '1 year',
            '1 day'::INTERVAL
        )::DATE AS date_day
),

date_attributes AS (
    SELECT
        date_day,
        EXTRACT(YEAR FROM date_day) AS year,
        EXTRACT(MONTH FROM date_day) AS month,
        TO_CHAR(date_day, 'Month') AS month_name,
        EXTRACT(DAY FROM date_day) AS day_of_month,
        EXTRACT(DOW FROM date_day) AS day_of_week, -- Sunday = 0, Saturday = 6
        TO_CHAR(date_day, 'Day') AS day_name,
        EXTRACT(DOY FROM date_day) AS day_of_year,
        EXTRACT(WEEK FROM date_day) AS week_of_year,
        EXTRACT(QUARTER FROM date_day) AS quarter_of_year,
        TO_CHAR(date_day, 'YYYY-MM') AS year_month,
        TO_CHAR(date_day, 'YYYY-MM-DD') AS full_date_string,
        (CASE WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE ELSE FALSE END) AS is_weekend
    FROM date_spine
)

SELECT *
FROM date_attributes
  );
[0m07:24:51.266457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:24:51.272967 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:24:51.273961 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m07:24:51.275833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:24:51.279516 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:24:51.280758 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m07:24:51.281958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:24:51.297649 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m07:24:51.299034 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:24:51.300020 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m07:24:51.302041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:24:51.307856 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_dates__dbt_backup"
[0m07:24:51.312621 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:24:51.313945 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
drop view if exists "medical_insights"."public"."dim_dates__dbt_backup" cascade
[0m07:24:51.317258 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:24:51.319921 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: Close
[0m07:24:51.322205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97d8582e0>]}
[0m07:24:51.323456 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.dim_dates .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m07:24:51.324933 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m07:24:51.325796 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m07:24:51.327984 [info ] [Thread-1 (]: 2 of 4 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m07:24:51.330933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.stg_telegram_messages)
[0m07:24:51.332575 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m07:24:51.337137 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m07:24:51.349412 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m07:24:51.356843 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.stg_telegram_messages"
[0m07:24:51.379314 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:24:51.381239 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: BEGIN
[0m07:24:51.382675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:51.387228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:24:51.389428 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:24:51.391165 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */

  create view "medical_insights"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

WITH raw_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        data AS raw_data,
        scraped_at
    FROM "medical_insights"."raw"."telegram_messages"
),

cleaned_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        scraped_at,
        raw_data->>'message' AS message_text,
        (raw_data->>'date')::TIMESTAMP AS message_date,
        (raw_data->>'views')::INT AS views_count,
        (raw_data->>'forwards')::INT AS forwards_count,
        (raw_data->'replies'->>'replies') AS replies_count, -- Fixed extraction for replies_count
        (raw_data->>'reactions') IS NOT NULL AS has_reactions,
        (raw_data->>'photo') IS NOT NULL AS has_photo,
        -- Extract product mentions (placeholder regex - refine as needed)
        REGEXP_MATCHES(raw_data->>'message', '(?i)(paracetamol|amoxicillin|ibuprofen|antibiotic|cream|pill)', 'g') AS product_mentions
    FROM raw_messages
    WHERE raw_data->>'message' IS NOT NULL OR raw_data->>'photo' IS NOT NULL
)

SELECT
    id,
    channel_name,
    message_id,
    message_text,
    message_date,
    COALESCE(views_count, 0) AS views_count,
    COALESCE(forwards_count, 0) AS forwards_count,
    COALESCE(replies_count::INT, 0) AS replies_count,
    has_reactions,
    has_photo,
    product_mentions,
    scraped_at
FROM cleaned_messages
  );
[0m07:24:51.396774 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:24:51.402692 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:24:51.404799 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m07:24:51.407050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:24:51.409587 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m07:24:51.411231 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:24:51.412827 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m07:24:51.415363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:24:51.418689 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."stg_telegram_messages__dbt_backup"
[0m07:24:51.420050 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:24:51.421268 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
drop view if exists "medical_insights"."public"."stg_telegram_messages__dbt_backup" cascade
[0m07:24:51.422763 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:24:51.425299 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: Close
[0m07:24:51.426711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff988887370>]}
[0m07:24:51.428799 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 0.10s]
[0m07:24:51.430545 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m07:24:51.432773 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m07:24:51.434161 [info ] [Thread-1 (]: 3 of 4 START sql view model public.dim_channels ................................ [RUN]
[0m07:24:51.435462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.stg_telegram_messages, now model.medical_dbt.dim_channels)
[0m07:24:51.436615 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_channels
[0m07:24:51.440025 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_channels"
[0m07:24:51.451365 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_channels
[0m07:24:51.456186 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_channels"
[0m07:24:51.469360 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:24:51.471049 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: BEGIN
[0m07:24:51.472569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:51.476508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:24:51.477884 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:24:51.479228 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */

  create view "medical_insights"."public"."dim_channels__dbt_tmp"
    
    
  as (
    -- models/marts/dim_channels.sql

SELECT DISTINCT
    channel_name,
    MD5(channel_name) AS channel_sk -- Surrogate key for channel
FROM "medical_insights"."public"."stg_telegram_messages"
  );
[0m07:24:51.483285 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:24:51.488084 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:24:51.489606 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
alter table "medical_insights"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m07:24:51.491134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:24:51.493028 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m07:24:51.494258 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:24:51.495517 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m07:24:51.498132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:24:51.501439 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_channels__dbt_backup"
[0m07:24:51.502992 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:24:51.504453 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
drop view if exists "medical_insights"."public"."dim_channels__dbt_backup" cascade
[0m07:24:51.505793 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:24:51.507757 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: Close
[0m07:24:51.509160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97d8b6320>]}
[0m07:24:51.510759 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.dim_channels ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m07:24:51.512716 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m07:24:51.514768 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m07:24:51.516216 [info ] [Thread-1 (]: 4 of 4 START sql view model public.fct_messages ................................ [RUN]
[0m07:24:51.517546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_channels, now model.medical_dbt.fct_messages)
[0m07:24:51.518926 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_messages
[0m07:24:51.523119 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_messages"
[0m07:24:51.535356 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_messages
[0m07:24:51.541253 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_messages"
[0m07:24:51.556134 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:24:51.557895 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: BEGIN
[0m07:24:51.559605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:51.564825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:24:51.566829 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:24:51.568528 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */

  create view "medical_insights"."public"."fct_messages__dbt_tmp"
    
    
  as (
    -- models/marts/fct_messages.sql

WITH stg_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        message_text,
        message_date,
        views_count,
        forwards_count,
        replies_count,
        has_reactions,
        has_photo,
        product_mentions,
        scraped_at
    FROM "medical_insights"."public"."stg_telegram_messages"
),

channels AS (
    SELECT
        channel_name,
        channel_sk
    FROM "medical_insights"."public"."dim_channels"
),

dates AS (
    SELECT
        date_day,
        year,
        month,
        day_of_month
    FROM "medical_insights"."public"."dim_dates"
)

SELECT
    sm.id AS message_pk,
    sm.message_id,
    sm.message_text,
    LENGTH(sm.message_text) AS message_length,
    sm.message_date,
    sm.views_count,
    sm.forwards_count,
    sm.replies_count,
    sm.has_reactions,
    sm.has_photo,
    sm.product_mentions,
    sm.scraped_at,
    c.channel_sk,
    d.date_day AS message_date_key
FROM stg_messages sm
LEFT JOIN channels c ON sm.channel_name = c.channel_name
LEFT JOIN dates d ON sm.message_date::DATE = d.date_day
  );
[0m07:24:51.576524 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m07:24:51.582010 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:24:51.583755 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
alter table "medical_insights"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m07:24:51.585745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:24:51.587925 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m07:24:51.589626 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:24:51.590833 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m07:24:51.593952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:24:51.598773 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_messages__dbt_backup"
[0m07:24:51.600504 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:24:51.602031 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
drop view if exists "medical_insights"."public"."fct_messages__dbt_backup" cascade
[0m07:24:51.603568 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:24:51.605517 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: Close
[0m07:24:51.606950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374f7691-ee06-4fba-a0d0-869e2cad9035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97c66e5c0>]}
[0m07:24:51.608329 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.fct_messages ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m07:24:51.609816 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m07:24:51.611902 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:51.613819 [debug] [MainThread]: On master: BEGIN
[0m07:24:51.614935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:24:51.618378 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:24:51.619469 [debug] [MainThread]: On master: COMMIT
[0m07:24:51.620559 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:51.621553 [debug] [MainThread]: On master: COMMIT
[0m07:24:51.622660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:24:51.623723 [debug] [MainThread]: On master: Close
[0m07:24:51.625025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:51.626207 [debug] [MainThread]: Connection 'model.medical_dbt.fct_messages' was properly closed.
[0m07:24:51.627384 [info ] [MainThread]: 
[0m07:24:51.628993 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m07:24:51.631089 [debug] [MainThread]: Command end result
[0m07:24:51.672124 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:24:51.677345 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:24:51.694475 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m07:24:51.696105 [info ] [MainThread]: 
[0m07:24:51.698107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:24:51.700775 [info ] [MainThread]: 
[0m07:24:51.702440 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m07:24:51.705972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0037286, "process_in_blocks": "94992", "process_kernel_time": 0.152659, "process_mem_max_rss": "128588", "process_out_blocks": "0", "process_user_time": 2.401843}
[0m07:24:51.707647 [debug] [MainThread]: Command `dbt run` succeeded at 07:24:51.707522 after 2.01 seconds
[0m07:24:51.709276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98886b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98853f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff986d5c490>]}
[0m07:24:51.710949 [debug] [MainThread]: Flushing usage events
[0m07:24:52.702888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:37:04.586926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49de4b3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49dd20ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49dd20ee30>]}


============================== 07:37:04.593814 | bb3388df-0345-4e42-8f0d-9c645a690443 ==============================
[0m07:37:04.593814 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:37:04.597466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/src/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /app/src/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:37:04.806977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb3388df-0345-4e42-8f0d-9c645a690443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49dc952c80>]}
[0m07:37:04.908784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb3388df-0345-4e42-8f0d-9c645a690443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49dda97280>]}
[0m07:37:04.912137 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:37:05.007199 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:37:05.697978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:05.700255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:05.801396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb3388df-0345-4e42-8f0d-9c645a690443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49db590b50>]}
[0m07:37:05.913862 [error] [MainThread]: Encountered an error:

[0m07:37:05.950582 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 2122, in parse_manifest
    write_manifest(manifest, runtime_config.project_target_path)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 2100, in write_manifest
    manifest.write(path)
  File "/usr/local/lib/python3.10/site-packages/dbt/contracts/graph/manifest.py", line 1231, in write
    writable.write(path)
  File "/usr/local/lib/python3.10/site-packages/dbt/artifacts/schemas/base.py", line 36, in write
    write_json(path, self.to_dict(omit_none=False, context={"artifact": True}))  # type: ignore
  File "<string>", line 3, in __mashumaro_to_dict__
  File "<string>", line 4, in __mashumaro_to_dict__
  File "<string>", line 4, in <dictcomp>
  File "<string>", line 3, in __pack_union_WritableManifest_nodes__9fbd4f7a18044abe8bbd72546f485222
  File "<string>", line 2, in __mashumaro_to_dict__
  File "/usr/local/lib/python3.10/site-packages/mashumaro/core/meta/code/builder.py", line 1140, in add_pack_method
    self._add_pack_method_lines(method_name)
  File "/usr/local/lib/python3.10/site-packages/mashumaro/core/meta/code/builder.py", line 881, in _add_pack_method_lines
    if self.metadatas.get(fname, {}).get("serialize") == "omit":
  File "/usr/local/lib/python3.10/site-packages/mashumaro/core/meta/code/builder.py", line 262, in metadatas
    for name, field in self.dataclass_fields.items()
  File "/usr/local/lib/python3.10/site-packages/mashumaro/core/meta/code/builder.py", line 246, in dataclass_fields
    for name in self.__get_field_types(recursive=False):
  File "/usr/local/lib/python3.10/site-packages/mashumaro/core/meta/code/builder.py", line 183, in __get_field_types
    field_type_hints = typing_extensions.get_type_hints(
  File "/usr/local/lib/python3.10/site-packages/typing_extensions.py", line 1458, in get_type_hints
    hint = typing.get_type_hints(
  File "/usr/local/lib/python3.10/typing.py", line 1833, in get_type_hints
    value = _eval_type(value, base_globals, base_locals)
  File "/usr/local/lib/python3.10/typing.py", line 328, in _eval_type
    if isinstance(t, (_GenericAlias, GenericAlias, types.UnionType)):
KeyboardInterrupt

[0m07:37:05.957289 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.5388073, "process_in_blocks": "768", "process_kernel_time": 0.15089, "process_mem_max_rss": "108796", "process_out_blocks": "0", "process_user_time": 2.263357}
[0m07:37:05.958916 [debug] [MainThread]: Command `dbt test` failed at 07:37:05.958687 after 1.54 seconds
[0m07:37:05.960543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49de4b3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49db5d3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49db5d3130>]}
[0m07:37:05.962972 [debug] [MainThread]: Flushing usage events
[0m07:37:07.186139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:37:14.188051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1184b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc105b70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc105b7040>]}


============================== 07:37:14.195110 | 6873ffe4-41ab-4165-a263-cc357459ed52 ==============================
[0m07:37:14.195110 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:37:14.198801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/src/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --project-dir /app/src/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:37:14.415318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6873ffe4-41ab-4165-a263-cc357459ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1047b310>]}
[0m07:37:14.499326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6873ffe4-41ab-4165-a263-cc357459ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc10754310>]}
[0m07:37:14.502795 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:37:14.569818 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:37:15.215093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:15.217328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:15.312854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6873ffe4-41ab-4165-a263-cc357459ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0efacbe0>]}
[0m07:37:15.403214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6873ffe4-41ab-4165-a263-cc357459ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0ef38e50>]}
[0m07:37:15.406574 [info ] [MainThread]: Found 4 models, 18 data tests, 1 source, 433 macros
[0m07:37:15.409013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6873ffe4-41ab-4165-a263-cc357459ed52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc10e839a0>]}
[0m07:37:15.414650 [info ] [MainThread]: 
[0m07:37:15.416758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:15.419769 [info ] [MainThread]: 
[0m07:37:15.422586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:15.436425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights_public'
[0m07:37:15.565381 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:37:15.569184 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m07:37:15.572524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:15.582420 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m07:37:15.585135 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:37:15.592741 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:37:15.599668 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m07:37:15.606910 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m07:37:15.610016 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m07:37:15.620599 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:15.623770 [debug] [MainThread]: On master: BEGIN
[0m07:37:15.626019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:15.633203 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:37:15.639224 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:15.642291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:37:15.646622 [debug] [MainThread]: On master: ROLLBACK
[0m07:37:15.649505 [debug] [MainThread]: On master: Close
[0m07:37:15.652605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:15.656277 [debug] [MainThread]: Connection 'list_medical_insights_public' was properly closed.
[0m07:37:15.659796 [error] [MainThread]: Encountered an error:

[0m07:37:15.678580 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 372, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 277, in docs_generate
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/docs/generate.py", line 219, in run
    compile_results = CompileTask.run(self)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 599, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 508, in before_run
    self.populate_adapter_cache(adapter)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 498, in populate_adapter_cache
    adapter.set_relations_cache(cachable_nodes)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 617, in set_relations_cache
    self._relations_cache_for_schemas(relation_configs, required_schemas)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/postgres/impl.py", line 145, in _relations_cache_for_schemas
    self._link_cached_relations(manifest)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/postgres/impl.py", line 141, in _link_cached_relations
    self._link_cached_database_relations(schemas)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/postgres/impl.py", line 111, in _link_cached_database_relations
    table = self.execute_macro(GET_RELATIONS_MACRO_NAME)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1275, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 26, in macro
  File "/usr/local/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.10/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 437, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/sql/connections.py", line 219, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/sql/connections.py", line 137, in add_query
    fire_event(
  File "/usr/local/lib/python3.10/site-packages/dbt_common/events/functions.py", line 142, in fire_event
    get_event_manager().fire_event(
  File "/usr/local/lib/python3.10/site-packages/dbt_common/events/event_manager.py", line 81, in fire_event
    logger.write_line(msg)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/events/logger.py", line 137, in write_line
    send_to_logger(self._python_logger, level, line)
  File "/usr/local/lib/python3.10/site-packages/dbt_common/events/logger.py", line 65, in send_to_logger
    logger.debug(log_line)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1465, in debug
    self._log(DEBUG, msg, args, **kwargs)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1624, in _log
    self.handle(record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1634, in handle
    self.callHandlers(record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1696, in callHandlers
    hdlr.handle(record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 968, in handle
    self.emit(record)
  File "/usr/local/lib/python3.10/logging/handlers.py", line 75, in emit
    logging.FileHandler.emit(self, record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1218, in emit
    StreamHandler.emit(self, record)
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/usr/local/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
KeyboardInterrupt

[0m07:37:15.683063 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 1.6455766, "process_in_blocks": "992", "process_kernel_time": 0.131767, "process_mem_max_rss": "117576", "process_out_blocks": "0", "process_user_time": 2.300866}
[0m07:37:15.686146 [debug] [MainThread]: Command `dbt docs generate` failed at 07:37:15.685937 after 1.65 seconds
[0m07:37:15.688746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1184b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0eb2f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0eb2f6a0>]}
[0m07:37:15.691491 [debug] [MainThread]: Flushing usage events
[0m07:37:16.807603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:43.311549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadd76b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadc4c2a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadc4c2a10>]}


============================== 07:39:43.320463 | 813802bb-7415-4cb1-b66a-056e5c68deae ==============================
[0m07:39:43.320463 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:39:43.323777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/src/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --project-dir /app/src/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:39:43.700341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadc4a0fd0>]}
[0m07:39:43.768316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadc4c2140>]}
[0m07:39:43.772412 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:39:43.856164 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:39:44.670969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:39:44.673942 [debug] [MainThread]: Partial parsing: added file: medical_dbt://models/marts/fct_image_detections.sql
[0m07:39:44.676668 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/marts/schema.yml
[0m07:39:45.442250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad8161ed0>]}
[0m07:39:45.665479 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:39:45.697192 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:39:45.759708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad8163490>]}
[0m07:39:45.761995 [info ] [MainThread]: Found 5 models, 22 data tests, 1 source, 433 macros
[0m07:39:45.765003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad8163160>]}
[0m07:39:45.769682 [info ] [MainThread]: 
[0m07:39:45.775189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:45.777804 [info ] [MainThread]: 
[0m07:39:45.781352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:39:45.793796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights'
[0m07:39:45.857301 [debug] [ThreadPool]: Using postgres connection "list_medical_insights"
[0m07:39:45.860270 [debug] [ThreadPool]: On list_medical_insights: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights"} */

    select distinct nspname from pg_namespace
  
[0m07:39:45.862912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:45.898348 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m07:39:45.903036 [debug] [ThreadPool]: On list_medical_insights: Close
[0m07:39:45.908695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights_public'
[0m07:39:45.920379 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:39:45.922946 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m07:39:45.925028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:45.936661 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m07:39:45.940047 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:39:45.942217 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:39:45.949603 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m07:39:45.953027 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m07:39:45.955313 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m07:39:45.972930 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:45.974967 [debug] [MainThread]: On master: BEGIN
[0m07:39:45.976623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:39:45.983233 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:39:45.985871 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:45.988660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:39:46.008236 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m07:39:46.014399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadab1c070>]}
[0m07:39:46.016838 [debug] [MainThread]: On master: ROLLBACK
[0m07:39:46.020152 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:46.022460 [debug] [MainThread]: On master: BEGIN
[0m07:39:46.024953 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:39:46.027445 [debug] [MainThread]: On master: COMMIT
[0m07:39:46.030380 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:46.033857 [debug] [MainThread]: On master: COMMIT
[0m07:39:46.036636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:39:46.039141 [debug] [MainThread]: On master: Close
[0m07:39:46.050076 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m07:39:46.054506 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_dates ................................... [RUN]
[0m07:39:46.058317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m07:39:46.060631 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m07:39:46.076418 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m07:39:46.107225 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m07:39:46.170605 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_dates"
[0m07:39:46.204840 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:39:46.207851 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: BEGIN
[0m07:39:46.211513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:46.219352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:39:46.221921 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:39:46.224102 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */

  create view "medical_insights"."public"."dim_dates__dbt_tmp"
    
    
  as (
    -- models/marts/dim_dates.sql

WITH date_spine AS (
    SELECT
        GENERATE_SERIES(
            '2023-01-01'::DATE,
            CURRENT_DATE + INTERVAL '1 year',
            '1 day'::INTERVAL
        )::DATE AS date_day
),

date_attributes AS (
    SELECT
        date_day,
        EXTRACT(YEAR FROM date_day) AS year,
        EXTRACT(MONTH FROM date_day) AS month,
        TO_CHAR(date_day, 'Month') AS month_name,
        EXTRACT(DAY FROM date_day) AS day_of_month,
        EXTRACT(DOW FROM date_day) AS day_of_week, -- Sunday = 0, Saturday = 6
        TO_CHAR(date_day, 'Day') AS day_name,
        EXTRACT(DOY FROM date_day) AS day_of_year,
        EXTRACT(WEEK FROM date_day) AS week_of_year,
        EXTRACT(QUARTER FROM date_day) AS quarter_of_year,
        TO_CHAR(date_day, 'YYYY-MM') AS year_month,
        TO_CHAR(date_day, 'YYYY-MM-DD') AS full_date_string,
        (CASE WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE ELSE FALSE END) AS is_weekend
    FROM date_spine
)

SELECT *
FROM date_attributes
  );
[0m07:39:46.249774 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m07:39:46.265325 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:39:46.268216 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m07:39:46.272706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:39:46.280150 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:39:46.282699 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m07:39:46.285960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:39:46.313876 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m07:39:46.316969 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:39:46.319983 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m07:39:46.328252 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:39:46.342914 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_dates__dbt_backup"
[0m07:39:46.351675 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m07:39:46.353578 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
drop view if exists "medical_insights"."public"."dim_dates__dbt_backup" cascade
[0m07:39:46.360303 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m07:39:46.366798 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: Close
[0m07:39:46.372179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaded3b7c0>]}
[0m07:39:46.374513 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_dates .............................. [[32mCREATE VIEW[0m in 0.31s]
[0m07:39:46.378286 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m07:39:46.381104 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_image_detections
[0m07:39:46.383734 [info ] [Thread-1 (]: 2 of 5 START sql view model public.fct_image_detections ........................ [RUN]
[0m07:39:46.388687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.fct_image_detections)
[0m07:39:46.390443 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_image_detections
[0m07:39:46.394559 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_image_detections"
[0m07:39:46.430171 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_image_detections
[0m07:39:46.440416 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_image_detections"
[0m07:39:46.467632 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m07:39:46.470106 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: BEGIN
[0m07:39:46.472549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:46.479919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:39:46.482516 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m07:39:46.485255 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */

  create view "medical_insights"."public"."fct_image_detections__dbt_tmp"
    
    
  as (
    -- models/marts/fct_image_detections.sql

SELECT
    md5(concat(message_id::text, object_class, detection_time::text)) AS detection_pk, -- surrogate key
    message_id,
    image_id,
    object_class,
    confidence_score,
    detection_time
FROM (
    VALUES
        (NULL, NULL, NULL, NULL, NULL) -- Placeholder row, to be replaced by enrichment process
) AS t(message_id, image_id, object_class, confidence_score, detection_time)
WHERE message_id IS NOT NULL
  );
[0m07:39:46.511147 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m07:39:46.518329 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m07:39:46.521205 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m07:39:46.524325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:39:46.528276 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m07:39:46.530611 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m07:39:46.533034 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m07:39:46.537384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:39:46.545045 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_image_detections__dbt_backup"
[0m07:39:46.548772 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m07:39:46.551427 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
drop view if exists "medical_insights"."public"."fct_image_detections__dbt_backup" cascade
[0m07:39:46.554199 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:39:46.559131 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: Close
[0m07:39:46.561845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad25d8640>]}
[0m07:39:46.564650 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.fct_image_detections ................... [[32mCREATE VIEW[0m in 0.17s]
[0m07:39:46.567029 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_image_detections
[0m07:39:46.569423 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m07:39:46.571931 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m07:39:46.573963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.fct_image_detections, now model.medical_dbt.stg_telegram_messages)
[0m07:39:46.575971 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m07:39:46.582342 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.608006 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m07:39:46.618484 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.643471 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.646290 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: BEGIN
[0m07:39:46.649661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:46.658112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:39:46.662808 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.665828 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */

  create view "medical_insights"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

WITH raw_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        data AS raw_data,
        scraped_at
    FROM "medical_insights"."raw"."telegram_messages"
),

cleaned_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        scraped_at,
        raw_data->>'message' AS message_text,
        (raw_data->>'date')::TIMESTAMP AS message_date,
        (raw_data->>'views')::INT AS views_count,
        (raw_data->>'forwards')::INT AS forwards_count,
        (raw_data->'replies'->>'replies') AS replies_count, -- Fixed extraction for replies_count
        (raw_data->>'reactions') IS NOT NULL AS has_reactions,
        (raw_data->>'photo') IS NOT NULL AS has_photo,
        -- Extract product mentions (placeholder regex - refine as needed)
        REGEXP_MATCHES(raw_data->>'message', '(?i)(paracetamol|amoxicillin|ibuprofen|antibiotic|cream|pill)', 'g') AS product_mentions
    FROM raw_messages
    WHERE raw_data->>'message' IS NOT NULL OR raw_data->>'photo' IS NOT NULL
)

SELECT
    id,
    channel_name,
    message_id,
    message_text,
    message_date,
    COALESCE(views_count, 0) AS views_count,
    COALESCE(forwards_count, 0) AS forwards_count,
    COALESCE(replies_count::INT, 0) AS replies_count,
    has_reactions,
    has_photo,
    product_mentions,
    scraped_at
FROM cleaned_messages
  );
[0m07:39:46.672162 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:39:46.682257 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.685388 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m07:39:46.689517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:39:46.696616 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.699835 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m07:39:46.703611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:39:46.708375 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m07:39:46.710925 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.713171 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m07:39:46.733466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m07:39:46.738845 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."stg_telegram_messages__dbt_backup"
[0m07:39:46.741346 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m07:39:46.743447 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
drop view if exists "medical_insights"."public"."stg_telegram_messages__dbt_backup" cascade
[0m07:39:46.750566 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m07:39:46.753916 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: Close
[0m07:39:46.756923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdada36b8b0>]}
[0m07:39:46.759518 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 0.18s]
[0m07:39:46.762074 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m07:39:46.764547 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m07:39:46.767171 [info ] [Thread-1 (]: 4 of 5 START sql view model public.dim_channels ................................ [RUN]
[0m07:39:46.771054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.stg_telegram_messages, now model.medical_dbt.dim_channels)
[0m07:39:46.774802 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_channels
[0m07:39:46.781593 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_channels"
[0m07:39:46.806934 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_channels
[0m07:39:46.813273 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_channels"
[0m07:39:46.833929 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:39:46.836289 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: BEGIN
[0m07:39:46.838560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:46.844799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:39:46.849889 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:39:46.852438 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */

  create view "medical_insights"."public"."dim_channels__dbt_tmp"
    
    
  as (
    -- models/marts/dim_channels.sql

SELECT DISTINCT
    channel_name,
    MD5(channel_name) AS channel_sk -- Surrogate key for channel
FROM "medical_insights"."public"."stg_telegram_messages"
  );
[0m07:39:46.858444 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:39:46.864604 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:39:46.866995 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
alter table "medical_insights"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m07:39:46.870201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:39:46.892095 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m07:39:46.894763 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:39:46.897836 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m07:39:46.902206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:39:46.907978 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_channels__dbt_backup"
[0m07:39:46.910683 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m07:39:46.913171 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
drop view if exists "medical_insights"."public"."dim_channels__dbt_backup" cascade
[0m07:39:46.915826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:39:46.920028 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: Close
[0m07:39:46.922398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadd7bd000>]}
[0m07:39:46.925205 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.dim_channels ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m07:39:46.929303 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m07:39:46.932143 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m07:39:46.934531 [info ] [Thread-1 (]: 5 of 5 START sql view model public.fct_messages ................................ [RUN]
[0m07:39:46.937496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_channels, now model.medical_dbt.fct_messages)
[0m07:39:46.940669 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_messages
[0m07:39:46.949503 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_messages"
[0m07:39:46.982672 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_messages
[0m07:39:46.990269 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_messages"
[0m07:39:47.015070 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:39:47.017154 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: BEGIN
[0m07:39:47.019268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:47.027300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:39:47.029970 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:39:47.049819 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */

  create view "medical_insights"."public"."fct_messages__dbt_tmp"
    
    
  as (
    -- models/marts/fct_messages.sql

WITH stg_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        message_text,
        message_date,
        views_count,
        forwards_count,
        replies_count,
        has_reactions,
        has_photo,
        product_mentions,
        scraped_at
    FROM "medical_insights"."public"."stg_telegram_messages"
),

channels AS (
    SELECT
        channel_name,
        channel_sk
    FROM "medical_insights"."public"."dim_channels"
),

dates AS (
    SELECT
        date_day,
        year,
        month,
        day_of_month
    FROM "medical_insights"."public"."dim_dates"
)

SELECT
    sm.id AS message_pk,
    sm.message_id,
    sm.message_text,
    LENGTH(sm.message_text) AS message_length,
    sm.message_date,
    sm.views_count,
    sm.forwards_count,
    sm.replies_count,
    sm.has_reactions,
    sm.has_photo,
    sm.product_mentions,
    sm.scraped_at,
    c.channel_sk,
    d.date_day AS message_date_key
FROM stg_messages sm
LEFT JOIN channels c ON sm.channel_name = c.channel_name
LEFT JOIN dates d ON sm.message_date::DATE = d.date_day
  );
[0m07:39:47.057872 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:39:47.064205 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:39:47.066645 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
alter table "medical_insights"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m07:39:47.070284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:39:47.073944 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m07:39:47.076414 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:39:47.078956 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m07:39:47.082956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:39:47.087451 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_messages__dbt_backup"
[0m07:39:47.090639 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m07:39:47.092727 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
drop view if exists "medical_insights"."public"."fct_messages__dbt_backup" cascade
[0m07:39:47.095466 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:39:47.098835 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: Close
[0m07:39:47.101425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813802bb-7415-4cb1-b66a-056e5c68deae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad25ad600>]}
[0m07:39:47.104205 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.fct_messages ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m07:39:47.107188 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m07:39:47.110628 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:47.112638 [debug] [MainThread]: On master: BEGIN
[0m07:39:47.114433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:39:47.121433 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:39:47.123318 [debug] [MainThread]: On master: COMMIT
[0m07:39:47.125312 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:47.127466 [debug] [MainThread]: On master: COMMIT
[0m07:39:47.129841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:39:47.131769 [debug] [MainThread]: On master: Close
[0m07:39:47.133981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:47.137814 [debug] [MainThread]: Connection 'list_medical_insights' was properly closed.
[0m07:39:47.139640 [debug] [MainThread]: Connection 'model.medical_dbt.fct_messages' was properly closed.
[0m07:39:47.141284 [info ] [MainThread]: 
[0m07:39:47.144157 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m07:39:47.147994 [debug] [MainThread]: Command end result
[0m07:39:47.231391 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:39:47.261381 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:39:47.279751 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m07:39:47.281690 [info ] [MainThread]: 
[0m07:39:47.283784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:39:47.286732 [info ] [MainThread]: 
[0m07:39:47.289046 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m07:39:47.311274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.176862, "process_in_blocks": "95312", "process_kernel_time": 0.311026, "process_mem_max_rss": "128416", "process_out_blocks": "0", "process_user_time": 3.963083}
[0m07:39:47.314030 [debug] [MainThread]: Command `dbt run` succeeded at 07:39:47.313784 after 4.18 seconds
[0m07:39:47.316137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdadd76b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad819ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdade09e260>]}
[0m07:39:47.318464 [debug] [MainThread]: Flushing usage events
[0m07:39:48.619628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:53:09.819117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e2ed79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e1c1aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e1c1ae90>]}


============================== 07:53:09.833400 | e9fc716c-97a9-48d5-b639-abb6e51fed2c ==============================
[0m07:53:09.833400 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:53:09.837073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/src/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /app/src/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:53:10.215725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9fc716c-97a9-48d5-b639-abb6e51fed2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e1343310>]}
[0m07:53:10.287667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9fc716c-97a9-48d5-b639-abb6e51fed2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e245d7e0>]}
[0m07:53:10.292494 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:53:10.380820 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:53:11.069094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:53:11.072250 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/schema.yml
[0m07:53:11.074456 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/stg_telegram_messages.sql
[0m07:53:11.869401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9fc716c-97a9-48d5-b639-abb6e51fed2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dca46470>]}
[0m07:53:12.079848 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:53:12.116101 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:53:12.208743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9fc716c-97a9-48d5-b639-abb6e51fed2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e0779e10>]}
[0m07:53:12.212056 [info ] [MainThread]: Found 5 models, 23 data tests, 1 source, 433 macros
[0m07:53:12.214600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9fc716c-97a9-48d5-b639-abb6e51fed2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e0ffb880>]}
[0m07:53:12.225113 [info ] [MainThread]: 
[0m07:53:12.229249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:53:12.232968 [info ] [MainThread]: 
[0m07:53:12.236269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:53:12.244586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights_public'
[0m07:53:12.314527 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:53:12.318648 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m07:53:12.321280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:12.350956 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m07:53:12.354338 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:53:12.357562 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:53:12.381567 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m07:53:12.387211 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m07:53:12.390753 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m07:53:12.402231 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:12.407239 [debug] [MainThread]: On master: BEGIN
[0m07:53:12.410918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:53:12.420126 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:53:12.423150 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:12.425801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:53:12.442111 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m07:53:12.446528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9fc716c-97a9-48d5-b639-abb6e51fed2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67df7ee1a0>]}
[0m07:53:12.449786 [debug] [MainThread]: On master: ROLLBACK
[0m07:53:12.452435 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:12.454862 [debug] [MainThread]: On master: BEGIN
[0m07:53:12.457716 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:53:12.459741 [debug] [MainThread]: On master: COMMIT
[0m07:53:12.461739 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:12.464094 [debug] [MainThread]: On master: COMMIT
[0m07:53:12.466853 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:53:12.469304 [debug] [MainThread]: On master: Close
[0m07:53:12.478753 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:53:12.481516 [info ] [Thread-1 (]: 1 of 23 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m07:53:12.485720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m07:53:12.488566 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:53:12.521581 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:53:12.589425 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:53:12.621127 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:53:12.682272 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:53:12.684919 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m07:53:12.688204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:12.696945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:53:12.700315 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:53:12.703206 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_insights"."public"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m07:53:12.738130 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m07:53:12.749129 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m07:53:12.752101 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m07:53:12.754467 [info ] [Thread-1 (]: 1 of 23 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.27s]
[0m07:53:12.757571 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:53:12.760019 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:53:12.762199 [info ] [Thread-1 (]: 2 of 23 START test not_null_dim_channels_channel_sk ............................ [RUN]
[0m07:53:12.764062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac)
[0m07:53:12.765962 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:53:12.777255 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:53:12.802915 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:53:12.808398 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:53:12.831941 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:53:12.834231 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: BEGIN
[0m07:53:12.836669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:12.843302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:12.844809 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:53:12.846672 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."dim_channels"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m07:53:12.852012 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m07:53:12.855665 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: ROLLBACK
[0m07:53:12.858047 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: Close
[0m07:53:12.860510 [info ] [Thread-1 (]: 2 of 23 PASS not_null_dim_channels_channel_sk .................................. [[32mPASS[0m in 0.10s]
[0m07:53:12.862497 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:53:12.864460 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:53:12.866600 [info ] [Thread-1 (]: 3 of 23 START test not_null_dim_dates_date_day ................................. [RUN]
[0m07:53:12.868490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac, now test.medical_dbt.not_null_dim_dates_date_day.1717af99fb)
[0m07:53:12.870262 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:53:12.876520 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:53:12.911214 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:53:12.917601 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:53:12.955157 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:53:12.958373 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: BEGIN
[0m07:53:12.961204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:12.969780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:53:12.973424 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:53:12.976584 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "medical_insights"."public"."dim_dates"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m07:53:12.982884 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m07:53:12.987944 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: ROLLBACK
[0m07:53:12.990950 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: Close
[0m07:53:12.994043 [info ] [Thread-1 (]: 3 of 23 PASS not_null_dim_dates_date_day ....................................... [[32mPASS[0m in 0.13s]
[0m07:53:12.997366 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:53:13.001138 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:53:13.003733 [info ] [Thread-1 (]: 4 of 23 START test not_null_fct_image_detections_detection_pk .................. [RUN]
[0m07:53:13.006601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_dates_date_day.1717af99fb, now test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6)
[0m07:53:13.009952 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:53:13.019047 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:53:13.054922 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:53:13.061925 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:53:13.084647 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:53:13.087344 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: BEGIN
[0m07:53:13.089831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:13.096213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:53:13.098921 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:53:13.101410 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select detection_pk
from "medical_insights"."public"."fct_image_detections"
where detection_pk is null



  
  
      
    ) dbt_internal_test
[0m07:53:13.104645 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m07:53:13.108697 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: ROLLBACK
[0m07:53:13.110808 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: Close
[0m07:53:13.113192 [info ] [Thread-1 (]: 4 of 23 PASS not_null_fct_image_detections_detection_pk ........................ [[32mPASS[0m in 0.11s]
[0m07:53:13.115930 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:53:13.118312 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:53:13.120391 [info ] [Thread-1 (]: 5 of 23 START test not_null_fct_image_detections_message_id .................... [RUN]
[0m07:53:13.122357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6, now test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8)
[0m07:53:13.124574 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:53:13.132518 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:53:13.157639 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:53:13.166519 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:53:13.192240 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:53:13.194676 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: BEGIN
[0m07:53:13.196804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:13.205594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:53:13.208266 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:53:13.210876 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_image_detections"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m07:53:13.216987 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m07:53:13.221837 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: ROLLBACK
[0m07:53:13.225056 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: Close
[0m07:53:13.227917 [info ] [Thread-1 (]: 5 of 23 PASS not_null_fct_image_detections_message_id .......................... [[32mPASS[0m in 0.11s]
[0m07:53:13.230701 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:53:13.233455 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:53:13.235733 [info ] [Thread-1 (]: 6 of 23 START test not_null_fct_image_detections_object_class .................. [RUN]
[0m07:53:13.238143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8, now test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24)
[0m07:53:13.240536 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:53:13.251070 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:53:13.279920 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:53:13.286388 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:53:13.331701 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:53:13.334295 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: BEGIN
[0m07:53:13.336445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:13.343291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:13.345933 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:53:13.348079 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select object_class
from "medical_insights"."public"."fct_image_detections"
where object_class is null



  
  
      
    ) dbt_internal_test
[0m07:53:13.351774 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:53:13.355777 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: ROLLBACK
[0m07:53:13.360503 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: Close
[0m07:53:13.363959 [info ] [Thread-1 (]: 6 of 23 PASS not_null_fct_image_detections_object_class ........................ [[32mPASS[0m in 0.13s]
[0m07:53:13.366706 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:53:13.368833 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:53:13.370406 [info ] [Thread-1 (]: 7 of 23 START test not_null_fct_messages_channel_sk ............................ [RUN]
[0m07:53:13.372136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24, now test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3)
[0m07:53:13.373684 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:53:13.381417 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:53:13.406574 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:53:13.412270 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:53:13.435885 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:53:13.438573 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: BEGIN
[0m07:53:13.440969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:13.448818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:53:13.452196 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:53:13.454799 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."fct_messages"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m07:53:13.523892 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.066 seconds
[0m07:53:13.528907 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: ROLLBACK
[0m07:53:13.531496 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: Close
[0m07:53:13.534051 [info ] [Thread-1 (]: 7 of 23 PASS not_null_fct_messages_channel_sk .................................. [[32mPASS[0m in 0.16s]
[0m07:53:13.536406 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:53:13.538157 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:53:13.540483 [info ] [Thread-1 (]: 8 of 23 START test not_null_fct_messages_message_date_key ...................... [RUN]
[0m07:53:13.542690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3, now test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3)
[0m07:53:13.544788 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:53:13.554308 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:53:13.578952 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:53:13.586015 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:53:13.607953 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:53:13.610503 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: BEGIN
[0m07:53:13.612875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:13.621303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:53:13.623734 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:53:13.625734 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date_key
from "medical_insights"."public"."fct_messages"
where message_date_key is null



  
  
      
    ) dbt_internal_test
[0m07:53:13.678016 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m07:53:13.682995 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: ROLLBACK
[0m07:53:13.686381 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: Close
[0m07:53:13.689749 [error] [Thread-1 (]: 8 of 23 FAIL 4 not_null_fct_messages_message_date_key .......................... [[31mFAIL 4[0m in 0.15s]
[0m07:53:13.693031 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:53:13.695843 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:53:13.698301 [info ] [Thread-1 (]: 9 of 23 START test not_null_fct_messages_message_id ............................ [RUN]
[0m07:53:13.701202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3, now test.medical_dbt.not_null_fct_messages_message_id.de346706b5)
[0m07:53:13.704865 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:53:13.716354 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:53:13.746107 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:53:13.752994 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:53:13.782730 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:53:13.785844 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: BEGIN
[0m07:53:13.788483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:13.795340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:13.797769 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:53:13.800340 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m07:53:13.806969 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m07:53:13.811498 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m07:53:13.813835 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: Close
[0m07:53:13.817160 [info ] [Thread-1 (]: 9 of 23 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 0.12s]
[0m07:53:13.820171 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:53:13.822477 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:53:13.824592 [info ] [Thread-1 (]: 10 of 23 START test not_null_fct_messages_message_pk ........................... [RUN]
[0m07:53:13.826547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_id.de346706b5, now test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec)
[0m07:53:13.828598 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:53:13.837184 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:53:13.883934 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:53:13.890627 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:53:13.915752 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:53:13.918224 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: BEGIN
[0m07:53:13.920218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:13.927204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:13.929563 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:53:13.931878 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_insights"."public"."fct_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m07:53:13.936899 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m07:53:13.946675 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: ROLLBACK
[0m07:53:13.949533 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: Close
[0m07:53:13.953290 [info ] [Thread-1 (]: 10 of 23 PASS not_null_fct_messages_message_pk ................................. [[32mPASS[0m in 0.13s]
[0m07:53:13.957231 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:53:13.961265 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:53:13.965445 [info ] [Thread-1 (]: 11 of 23 START test not_null_stg_telegram_messages_id .......................... [RUN]
[0m07:53:13.970300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec, now test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m07:53:13.974356 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:53:13.987696 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:53:14.057993 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:53:14.064096 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:53:14.112902 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:53:14.114800 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m07:53:14.116796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:14.123071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:53:14.125083 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:53:14.127616 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "medical_insights"."public"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m07:53:14.131014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:53:14.135098 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m07:53:14.137532 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m07:53:14.140337 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stg_telegram_messages_id ................................ [[32mPASS[0m in 0.17s]
[0m07:53:14.142183 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:53:14.144155 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:53:14.145968 [info ] [Thread-1 (]: 12 of 23 START test not_null_stg_telegram_messages_message_id .................. [RUN]
[0m07:53:14.147848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m07:53:14.150064 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:53:14.156910 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:53:14.186441 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:53:14.193580 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:53:14.227110 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:53:14.231759 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: BEGIN
[0m07:53:14.234776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:14.241083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:53:14.243476 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:53:14.245898 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m07:53:14.250500 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:53:14.254628 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m07:53:14.257539 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m07:53:14.260488 [info ] [Thread-1 (]: 12 of 23 PASS not_null_stg_telegram_messages_message_id ........................ [[32mPASS[0m in 0.11s]
[0m07:53:14.263269 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:53:14.265710 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:53:14.268245 [info ] [Thread-1 (]: 13 of 23 START test relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [RUN]
[0m07:53:14.270353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241)
[0m07:53:14.272617 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:53:14.288459 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:53:14.320546 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:53:14.327616 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:53:14.356185 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:53:14.358992 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: BEGIN
[0m07:53:14.361431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:14.368713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:14.371487 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:53:14.373804 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_sk as from_field
    from "medical_insights"."public"."fct_messages"
    where channel_sk is not null
),

parent as (
    select channel_sk as to_field
    from "medical_insights"."public"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m07:53:14.438816 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.062 seconds
[0m07:53:14.445880 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: ROLLBACK
[0m07:53:14.448300 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: Close
[0m07:53:14.452673 [info ] [Thread-1 (]: 13 of 23 PASS relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [[32mPASS[0m in 0.18s]
[0m07:53:14.458735 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:53:14.460966 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:53:14.462867 [info ] [Thread-1 (]: 14 of 23 START test relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [RUN]
[0m07:53:14.467533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241, now test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1)
[0m07:53:14.470092 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:53:14.481987 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:53:14.512690 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:53:14.518404 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:53:14.572444 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:53:14.575601 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: BEGIN
[0m07:53:14.578074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:14.586165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:53:14.588826 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:53:14.591248 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select message_date_key as from_field
    from "medical_insights"."public"."fct_messages"
    where message_date_key is not null
),

parent as (
    select date_day as to_field
    from "medical_insights"."public"."dim_dates"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m07:53:14.636418 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.042 seconds
[0m07:53:14.641451 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: ROLLBACK
[0m07:53:14.644865 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: Close
[0m07:53:14.647344 [info ] [Thread-1 (]: 14 of 23 PASS relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [[32mPASS[0m in 0.18s]
[0m07:53:14.651040 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:53:14.657056 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:53:14.659675 [info ] [Thread-1 (]: 15 of 23 START test unique_dim_channels_channel_name ........................... [RUN]
[0m07:53:14.666536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1, now test.medical_dbt.unique_dim_channels_channel_name.e57614abc8)
[0m07:53:14.670080 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:53:14.684519 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:53:14.713858 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:53:14.721657 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:53:14.766220 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:53:14.769004 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m07:53:14.771578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:14.779274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:53:14.783984 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:53:14.787856 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:14.811818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m07:53:14.816665 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m07:53:14.819366 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: Close
[0m07:53:14.822008 [info ] [Thread-1 (]: 15 of 23 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.16s]
[0m07:53:14.824320 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:53:14.827430 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:53:14.830060 [info ] [Thread-1 (]: 16 of 23 START test unique_dim_channels_channel_sk ............................. [RUN]
[0m07:53:14.832254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_name.e57614abc8, now test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2)
[0m07:53:14.834231 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:53:14.845596 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:53:14.877029 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:53:14.883504 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:53:14.913987 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:53:14.917526 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: BEGIN
[0m07:53:14.920952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:14.928195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:14.930908 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:53:14.934248 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_sk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_sk is not null
group by channel_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:14.968115 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.031 seconds
[0m07:53:14.975694 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: ROLLBACK
[0m07:53:14.979017 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: Close
[0m07:53:14.982463 [info ] [Thread-1 (]: 16 of 23 PASS unique_dim_channels_channel_sk ................................... [[32mPASS[0m in 0.15s]
[0m07:53:14.994361 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:53:15.000418 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:53:15.003662 [info ] [Thread-1 (]: 17 of 23 START test unique_dim_dates_date_day .................................. [RUN]
[0m07:53:15.006889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2, now test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7)
[0m07:53:15.009988 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:53:15.019902 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:53:15.068850 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:53:15.074420 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:53:15.098653 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:53:15.101091 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: BEGIN
[0m07:53:15.103247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:15.110747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:15.112928 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:53:15.115167 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_dates"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:15.119911 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m07:53:15.124144 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: ROLLBACK
[0m07:53:15.127271 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: Close
[0m07:53:15.129801 [info ] [Thread-1 (]: 17 of 23 PASS unique_dim_dates_date_day ........................................ [[32mPASS[0m in 0.12s]
[0m07:53:15.131935 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:53:15.134262 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:53:15.136272 [info ] [Thread-1 (]: 18 of 23 START test unique_fct_image_detections_detection_pk ................... [RUN]
[0m07:53:15.138518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7, now test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de)
[0m07:53:15.140120 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:53:15.147530 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:53:15.169316 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:53:15.176172 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:53:15.200092 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:53:15.201912 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: BEGIN
[0m07:53:15.203478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:15.210430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:15.213391 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:53:15.215270 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    detection_pk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_image_detections"
where detection_pk is not null
group by detection_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:15.218781 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:53:15.222328 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: ROLLBACK
[0m07:53:15.224594 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: Close
[0m07:53:15.227235 [info ] [Thread-1 (]: 18 of 23 PASS unique_fct_image_detections_detection_pk ......................... [[32mPASS[0m in 0.09s]
[0m07:53:15.229187 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:53:15.231419 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:53:15.233506 [info ] [Thread-1 (]: 19 of 23 START test unique_fct_messages_message_id ............................. [RUN]
[0m07:53:15.235411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de, now test.medical_dbt.unique_fct_messages_message_id.655aa1a48d)
[0m07:53:15.236814 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:53:15.244580 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:53:15.266400 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:53:15.273905 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:53:15.299146 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:53:15.301529 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: BEGIN
[0m07:53:15.303676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:15.311281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:53:15.313341 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:53:15.315080 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:15.372117 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.055 seconds
[0m07:53:15.376760 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: ROLLBACK
[0m07:53:15.383029 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: Close
[0m07:53:15.386299 [error] [Thread-1 (]: 19 of 23 FAIL 21 unique_fct_messages_message_id ................................ [[31mFAIL 21[0m in 0.15s]
[0m07:53:15.389717 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:53:15.394208 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:53:15.396800 [info ] [Thread-1 (]: 20 of 23 START test unique_fct_messages_message_pk ............................. [RUN]
[0m07:53:15.399394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_messages_message_id.655aa1a48d, now test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66)
[0m07:53:15.402615 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:53:15.417116 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:53:15.456599 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:53:15.491886 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:53:15.519343 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:53:15.521570 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: BEGIN
[0m07:53:15.523544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:15.530146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:15.532601 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:53:15.535142 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:15.592557 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.053 seconds
[0m07:53:15.599281 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: ROLLBACK
[0m07:53:15.601900 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: Close
[0m07:53:15.604388 [error] [Thread-1 (]: 20 of 23 FAIL 21 unique_fct_messages_message_pk ................................ [[31mFAIL 21[0m in 0.20s]
[0m07:53:15.607762 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:53:15.610160 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:53:15.612114 [info ] [Thread-1 (]: 21 of 23 START test unique_stg_telegram_messages_channel_message_unique ........ [RUN]
[0m07:53:15.615916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66, now test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb)
[0m07:53:15.617659 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:53:15.624463 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:53:15.649895 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:53:15.656178 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:53:15.686847 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:53:15.689362 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: BEGIN
[0m07:53:15.691521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:15.698697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:53:15.702152 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:53:15.703929 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_message_unique as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where channel_message_unique is not null
group by channel_message_unique
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:15.725445 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_message_unique" does not exist
LINE 15:     channel_message_unique as unique_field,
             ^

[0m07:53:15.728059 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: ROLLBACK
[0m07:53:15.731042 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: Close
[0m07:53:15.743384 [debug] [Thread-1 (]: Database Error in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)
  column "channel_message_unique" does not exist
  LINE 15:     channel_message_unique as unique_field,
               ^
  compiled code at target/run/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql
[0m07:53:15.746249 [error] [Thread-1 (]: 21 of 23 ERROR unique_stg_telegram_messages_channel_message_unique ............. [[31mERROR[0m in 0.13s]
[0m07:53:15.749337 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:53:15.751493 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:53:15.752333 [debug] [Thread-4 (]: Marking all children of 'test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)
  column "channel_message_unique" does not exist
  LINE 15:     channel_message_unique as unique_field,
               ^
  compiled code at target/run/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql.
[0m07:53:15.754506 [info ] [Thread-1 (]: 22 of 23 START test unique_stg_telegram_messages_id ............................ [RUN]
[0m07:53:15.759881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb, now test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a)
[0m07:53:15.761827 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:53:15.770538 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:53:15.798488 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:53:15.808767 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:53:15.836833 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:53:15.845262 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: BEGIN
[0m07:53:15.848269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:15.857107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:53:15.860070 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:53:15.862995 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:15.887287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m07:53:15.892992 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: ROLLBACK
[0m07:53:15.896361 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: Close
[0m07:53:15.901924 [error] [Thread-1 (]: 22 of 23 FAIL 21 unique_stg_telegram_messages_id ............................... [[31mFAIL 21[0m in 0.14s]
[0m07:53:15.904870 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:53:15.907656 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:53:15.909964 [info ] [Thread-1 (]: 23 of 23 START test unique_stg_telegram_messages_message_id .................... [RUN]
[0m07:53:15.912946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a, now test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m07:53:15.916016 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:53:15.924554 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:53:15.955857 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:53:15.962134 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:53:16.012362 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:53:16.015300 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: BEGIN
[0m07:53:16.017827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:16.025865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:53:16.028607 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:53:16.031052 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:53:16.061358 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m07:53:16.066308 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m07:53:16.069173 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m07:53:16.085034 [error] [Thread-1 (]: 23 of 23 FAIL 21 unique_stg_telegram_messages_message_id ....................... [[31mFAIL 21[0m in 0.17s]
[0m07:53:16.091194 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:53:16.096729 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:16.099445 [debug] [MainThread]: On master: BEGIN
[0m07:53:16.107783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:53:16.114404 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:53:16.116528 [debug] [MainThread]: On master: COMMIT
[0m07:53:16.118274 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:16.120096 [debug] [MainThread]: On master: COMMIT
[0m07:53:16.122184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:53:16.123633 [debug] [MainThread]: On master: Close
[0m07:53:16.125532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:16.127343 [debug] [MainThread]: Connection 'test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m07:53:16.129714 [info ] [MainThread]: 
[0m07:53:16.131503 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m07:53:16.136446 [debug] [MainThread]: Command end result
[0m07:53:16.310230 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:53:16.322068 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:53:16.349006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m07:53:16.352234 [info ] [MainThread]: 
[0m07:53:16.355461 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m07:53:16.357189 [info ] [MainThread]: 
[0m07:53:16.358974 [error] [MainThread]: [31mFailure in test not_null_fct_messages_message_date_key (models/marts/schema.yml)[0m
[0m07:53:16.360781 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m07:53:16.362246 [info ] [MainThread]: 
[0m07:53:16.364669 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/not_null_fct_messages_message_date_key.sql
[0m07:53:16.366687 [info ] [MainThread]: 
[0m07:53:16.368877 [error] [MainThread]: [31mFailure in test unique_fct_messages_message_id (models/marts/schema.yml)[0m
[0m07:53:16.371752 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:53:16.373289 [info ] [MainThread]: 
[0m07:53:16.377258 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/unique_fct_messages_message_id.sql
[0m07:53:16.379633 [info ] [MainThread]: 
[0m07:53:16.381352 [error] [MainThread]: [31mFailure in test unique_fct_messages_message_pk (models/marts/schema.yml)[0m
[0m07:53:16.383111 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:53:16.385253 [info ] [MainThread]: 
[0m07:53:16.387251 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/unique_fct_messages_message_pk.sql
[0m07:53:16.388551 [info ] [MainThread]: 
[0m07:53:16.392015 [error] [MainThread]: [31mFailure in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)[0m
[0m07:53:16.394335 [error] [MainThread]:   Database Error in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)
  column "channel_message_unique" does not exist
  LINE 15:     channel_message_unique as unique_field,
               ^
  compiled code at target/run/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql
[0m07:53:16.395810 [info ] [MainThread]: 
[0m07:53:16.401107 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql
[0m07:53:16.403314 [info ] [MainThread]: 
[0m07:53:16.406080 [error] [MainThread]: [31mFailure in test unique_stg_telegram_messages_id (models/staging/schema.yml)[0m
[0m07:53:16.408674 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:53:16.410893 [info ] [MainThread]: 
[0m07:53:16.412812 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_id.sql
[0m07:53:16.414458 [info ] [MainThread]: 
[0m07:53:16.416125 [error] [MainThread]: [31mFailure in test unique_stg_telegram_messages_message_id (models/staging/schema.yml)[0m
[0m07:53:16.417846 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:53:16.419176 [info ] [MainThread]: 
[0m07:53:16.421090 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_message_id.sql
[0m07:53:16.422969 [info ] [MainThread]: 
[0m07:53:16.427066 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=23
[0m07:53:16.431082 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.7911882, "process_in_blocks": "23160", "process_kernel_time": 0.302102, "process_mem_max_rss": "125388", "process_out_blocks": "0", "process_user_time": 3.977678}
[0m07:53:16.433160 [debug] [MainThread]: Command `dbt test` failed at 07:53:16.432984 after 6.79 seconds
[0m07:53:16.434991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e2ed79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dca97eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67dca95c30>]}
[0m07:53:16.436719 [debug] [MainThread]: Flushing usage events
[0m07:53:17.491303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:58:50.295822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c13467910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c121c2d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c121c2ce0>]}


============================== 07:58:50.304753 | d2d25f88-303c-4f19-b5d0-783a66ada43d ==============================
[0m07:58:50.304753 [info ] [MainThread]: Running with dbt=1.10.4
[0m07:58:50.307976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/src/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --project-dir /app/src/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:58:50.718950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d25f88-303c-4f19-b5d0-783a66ada43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c11953dc0>]}
[0m07:58:50.803098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2d25f88-303c-4f19-b5d0-783a66ada43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1236c8e0>]}
[0m07:58:50.806264 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:58:50.932911 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m07:58:51.719582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:58:51.722432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:58:51.829498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d25f88-303c-4f19-b5d0-783a66ada43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c105fe1d0>]}
[0m07:58:52.125795 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:58:52.142698 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:58:52.233465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2d25f88-303c-4f19-b5d0-783a66ada43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c105595a0>]}
[0m07:58:52.236510 [info ] [MainThread]: Found 5 models, 23 data tests, 1 source, 433 macros
[0m07:58:52.240061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d25f88-303c-4f19-b5d0-783a66ada43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c105595d0>]}
[0m07:58:52.247203 [info ] [MainThread]: 
[0m07:58:52.251149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:58:52.257782 [info ] [MainThread]: 
[0m07:58:52.260460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:58:52.270205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights_public'
[0m07:58:52.336849 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:58:52.340000 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m07:58:52.342639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:58:52.370313 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m07:58:52.372556 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m07:58:52.374742 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:58:52.391134 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m07:58:52.394955 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m07:58:52.397210 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m07:58:52.407283 [debug] [MainThread]: Using postgres connection "master"
[0m07:58:52.409228 [debug] [MainThread]: On master: BEGIN
[0m07:58:52.411090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:58:52.417761 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:58:52.420991 [debug] [MainThread]: Using postgres connection "master"
[0m07:58:52.422860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:58:52.439595 [debug] [MainThread]: SQL status: SELECT 5 in 0.015 seconds
[0m07:58:52.443925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d25f88-303c-4f19-b5d0-783a66ada43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c13d73190>]}
[0m07:58:52.446083 [debug] [MainThread]: On master: ROLLBACK
[0m07:58:52.448149 [debug] [MainThread]: Using postgres connection "master"
[0m07:58:52.450682 [debug] [MainThread]: On master: BEGIN
[0m07:58:52.453167 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:58:52.455753 [debug] [MainThread]: On master: COMMIT
[0m07:58:52.457691 [debug] [MainThread]: Using postgres connection "master"
[0m07:58:52.459672 [debug] [MainThread]: On master: COMMIT
[0m07:58:52.461764 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:58:52.463583 [debug] [MainThread]: On master: Close
[0m07:58:52.471948 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:58:52.474398 [info ] [Thread-1 (]: 1 of 23 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m07:58:52.477363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m07:58:52.479143 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:58:52.505744 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:58:52.528798 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:58:52.552015 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:58:52.566197 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:58:52.568143 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m07:58:52.572145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:52.577879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:52.579322 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m07:58:52.580850 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_insights"."public"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m07:58:52.584021 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:58:52.595811 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m07:58:52.601739 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m07:58:52.604021 [info ] [Thread-1 (]: 1 of 23 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.13s]
[0m07:58:52.608082 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m07:58:52.610250 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:58:52.612461 [info ] [Thread-1 (]: 2 of 23 START test not_null_dim_channels_channel_sk ............................ [RUN]
[0m07:58:52.615102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac)
[0m07:58:52.617234 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:58:52.626150 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:58:52.645817 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:58:52.651822 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:58:52.686273 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:58:52.688810 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: BEGIN
[0m07:58:52.692530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:52.698039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:52.699497 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m07:58:52.709053 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."dim_channels"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m07:58:52.713646 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:58:52.717172 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: ROLLBACK
[0m07:58:52.719705 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: Close
[0m07:58:52.722237 [info ] [Thread-1 (]: 2 of 23 PASS not_null_dim_channels_channel_sk .................................. [[32mPASS[0m in 0.11s]
[0m07:58:52.724801 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m07:58:52.727007 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:58:52.729080 [info ] [Thread-1 (]: 3 of 23 START test not_null_dim_dates_date_day ................................. [RUN]
[0m07:58:52.731230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac, now test.medical_dbt.not_null_dim_dates_date_day.1717af99fb)
[0m07:58:52.733189 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:58:52.740720 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:58:52.762793 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:58:52.768858 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:58:52.791893 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:58:52.793978 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: BEGIN
[0m07:58:52.796112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:52.803544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:58:52.805729 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m07:58:52.808074 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "medical_insights"."public"."dim_dates"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m07:58:52.832076 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m07:58:52.836566 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: ROLLBACK
[0m07:58:52.838681 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: Close
[0m07:58:52.840879 [info ] [Thread-1 (]: 3 of 23 PASS not_null_dim_dates_date_day ....................................... [[32mPASS[0m in 0.11s]
[0m07:58:52.845951 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m07:58:52.847896 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:58:52.849778 [info ] [Thread-1 (]: 4 of 23 START test not_null_fct_image_detections_detection_pk .................. [RUN]
[0m07:58:52.852563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_dates_date_day.1717af99fb, now test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6)
[0m07:58:52.855737 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:58:52.867458 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:58:52.885539 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:58:52.894200 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:58:52.913966 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:58:52.915384 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: BEGIN
[0m07:58:52.916656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:52.921573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:58:52.923273 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m07:58:52.924726 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select detection_pk
from "medical_insights"."public"."fct_image_detections"
where detection_pk is null



  
  
      
    ) dbt_internal_test
[0m07:58:52.926933 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m07:58:52.929593 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: ROLLBACK
[0m07:58:52.931064 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: Close
[0m07:58:52.932599 [info ] [Thread-1 (]: 4 of 23 PASS not_null_fct_image_detections_detection_pk ........................ [[32mPASS[0m in 0.08s]
[0m07:58:52.935921 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m07:58:52.937389 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:58:52.938560 [info ] [Thread-1 (]: 5 of 23 START test not_null_fct_image_detections_message_id .................... [RUN]
[0m07:58:52.940256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6, now test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8)
[0m07:58:52.941943 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:58:52.948681 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:58:52.976919 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:58:52.981577 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:58:53.000793 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:58:53.002686 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: BEGIN
[0m07:58:53.004642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.010034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:58:53.012105 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m07:58:53.013973 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_image_detections"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.016620 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m07:58:53.019640 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: ROLLBACK
[0m07:58:53.022139 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: Close
[0m07:58:53.024688 [info ] [Thread-1 (]: 5 of 23 PASS not_null_fct_image_detections_message_id .......................... [[32mPASS[0m in 0.08s]
[0m07:58:53.026740 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m07:58:53.028089 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:58:53.029428 [info ] [Thread-1 (]: 6 of 23 START test not_null_fct_image_detections_object_class .................. [RUN]
[0m07:58:53.031370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8, now test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24)
[0m07:58:53.032834 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:58:53.040301 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:58:53.060017 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:58:53.064437 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:58:53.081183 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:58:53.082945 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: BEGIN
[0m07:58:53.084552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.089545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:58:53.091904 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m07:58:53.093551 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select object_class
from "medical_insights"."public"."fct_image_detections"
where object_class is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.096403 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m07:58:53.104443 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: ROLLBACK
[0m07:58:53.106151 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: Close
[0m07:58:53.107784 [info ] [Thread-1 (]: 6 of 23 PASS not_null_fct_image_detections_object_class ........................ [[32mPASS[0m in 0.08s]
[0m07:58:53.110176 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m07:58:53.111883 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:58:53.113395 [info ] [Thread-1 (]: 7 of 23 START test not_null_fct_messages_channel_sk ............................ [RUN]
[0m07:58:53.115407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24, now test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3)
[0m07:58:53.116995 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:58:53.125937 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:58:53.141142 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:58:53.148076 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:58:53.171959 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:58:53.173849 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: BEGIN
[0m07:58:53.175679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.181286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:53.183504 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m07:58:53.185867 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."fct_messages"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.224595 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.036 seconds
[0m07:58:53.229755 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: ROLLBACK
[0m07:58:53.232142 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: Close
[0m07:58:53.236497 [info ] [Thread-1 (]: 7 of 23 PASS not_null_fct_messages_channel_sk .................................. [[32mPASS[0m in 0.12s]
[0m07:58:53.238886 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m07:58:53.240917 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:58:53.242621 [info ] [Thread-1 (]: 8 of 23 START test not_null_fct_messages_message_date_key ...................... [RUN]
[0m07:58:53.244632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3, now test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3)
[0m07:58:53.246564 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:58:53.255237 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:58:53.267253 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:58:53.271572 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:58:53.288049 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:58:53.289899 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: BEGIN
[0m07:58:53.291500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.296724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:58:53.298332 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m07:58:53.300094 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date_key
from "medical_insights"."public"."fct_messages"
where message_date_key is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.339001 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.037 seconds
[0m07:58:53.342985 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: ROLLBACK
[0m07:58:53.344950 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: Close
[0m07:58:53.346973 [error] [Thread-1 (]: 8 of 23 FAIL 4 not_null_fct_messages_message_date_key .......................... [[31mFAIL 4[0m in 0.10s]
[0m07:58:53.350528 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m07:58:53.352371 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:58:53.354350 [info ] [Thread-1 (]: 9 of 23 START test not_null_fct_messages_message_id ............................ [RUN]
[0m07:58:53.357083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3, now test.medical_dbt.not_null_fct_messages_message_id.de346706b5)
[0m07:58:53.359578 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:58:53.366585 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:58:53.392046 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:58:53.397482 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:58:53.417659 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:58:53.419996 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: BEGIN
[0m07:58:53.422188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.427851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:53.429655 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m07:58:53.433233 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.438643 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m07:58:53.442097 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m07:58:53.444126 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: Close
[0m07:58:53.446169 [info ] [Thread-1 (]: 9 of 23 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 0.09s]
[0m07:58:53.449391 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m07:58:53.451339 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:58:53.453423 [info ] [Thread-1 (]: 10 of 23 START test not_null_fct_messages_message_pk ........................... [RUN]
[0m07:58:53.456359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_id.de346706b5, now test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec)
[0m07:58:53.461366 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:58:53.470427 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:58:53.489529 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:58:53.497157 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:58:53.520341 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:58:53.522659 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: BEGIN
[0m07:58:53.524715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.532368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:58:53.535564 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m07:58:53.538536 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_insights"."public"."fct_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.544861 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m07:58:53.550518 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: ROLLBACK
[0m07:58:53.554583 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: Close
[0m07:58:53.558503 [info ] [Thread-1 (]: 10 of 23 PASS not_null_fct_messages_message_pk ................................. [[32mPASS[0m in 0.10s]
[0m07:58:53.561273 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m07:58:53.563517 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:58:53.565714 [info ] [Thread-1 (]: 11 of 23 START test not_null_stg_telegram_messages_id .......................... [RUN]
[0m07:58:53.568253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec, now test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m07:58:53.570542 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:58:53.579013 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:58:53.600395 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:58:53.607699 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:58:53.625192 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:58:53.627531 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m07:58:53.629313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.635705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:53.637829 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m07:58:53.640150 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "medical_insights"."public"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.643829 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:58:53.647167 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m07:58:53.649374 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m07:58:53.651587 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stg_telegram_messages_id ................................ [[32mPASS[0m in 0.08s]
[0m07:58:53.654046 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m07:58:53.655666 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:58:53.657244 [info ] [Thread-1 (]: 12 of 23 START test not_null_stg_telegram_messages_message_id .................. [RUN]
[0m07:58:53.658994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m07:58:53.660583 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:58:53.669004 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:58:53.685980 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:58:53.691807 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:58:53.707495 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:58:53.709703 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: BEGIN
[0m07:58:53.711663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.717556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:53.719397 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m07:58:53.721179 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.724649 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:58:53.728258 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m07:58:53.730031 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m07:58:53.732068 [info ] [Thread-1 (]: 12 of 23 PASS not_null_stg_telegram_messages_message_id ........................ [[32mPASS[0m in 0.07s]
[0m07:58:53.733982 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m07:58:53.735627 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:58:53.737155 [info ] [Thread-1 (]: 13 of 23 START test relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [RUN]
[0m07:58:53.739407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241)
[0m07:58:53.740969 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:58:53.757775 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:58:53.776250 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:58:53.781091 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:58:53.796521 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:58:53.798150 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: BEGIN
[0m07:58:53.799581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.805280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:53.807161 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m07:58:53.808841 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_sk as from_field
    from "medical_insights"."public"."fct_messages"
    where channel_sk is not null
),

parent as (
    select channel_sk as to_field
    from "medical_insights"."public"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.868666 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m07:58:53.872172 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: ROLLBACK
[0m07:58:53.874461 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: Close
[0m07:58:53.876190 [info ] [Thread-1 (]: 13 of 23 PASS relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [[32mPASS[0m in 0.14s]
[0m07:58:53.879308 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m07:58:53.881179 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:58:53.883022 [info ] [Thread-1 (]: 14 of 23 START test relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [RUN]
[0m07:58:53.885677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241, now test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1)
[0m07:58:53.887197 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:58:53.895722 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:58:53.912045 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:58:53.916478 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:58:53.929449 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:58:53.931060 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: BEGIN
[0m07:58:53.932550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:53.937303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:58:53.938808 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m07:58:53.940669 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select message_date_key as from_field
    from "medical_insights"."public"."fct_messages"
    where message_date_key is not null
),

parent as (
    select date_day as to_field
    from "medical_insights"."public"."dim_dates"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m07:58:53.979153 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.036 seconds
[0m07:58:53.983226 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: ROLLBACK
[0m07:58:53.984977 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: Close
[0m07:58:53.986717 [info ] [Thread-1 (]: 14 of 23 PASS relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [[32mPASS[0m in 0.10s]
[0m07:58:53.988996 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m07:58:53.990461 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:58:53.991796 [info ] [Thread-1 (]: 15 of 23 START test unique_dim_channels_channel_name ........................... [RUN]
[0m07:58:53.993397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1, now test.medical_dbt.unique_dim_channels_channel_name.e57614abc8)
[0m07:58:53.994830 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:58:54.007890 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:58:54.024615 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:58:54.029090 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:58:54.045524 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:58:54.046850 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m07:58:54.047940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.052355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:58:54.055720 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m07:58:54.057294 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.086674 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.028 seconds
[0m07:58:54.090993 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m07:58:54.093762 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: Close
[0m07:58:54.097342 [info ] [Thread-1 (]: 15 of 23 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.10s]
[0m07:58:54.100700 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m07:58:54.102984 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:58:54.105137 [info ] [Thread-1 (]: 16 of 23 START test unique_dim_channels_channel_sk ............................. [RUN]
[0m07:58:54.107510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_name.e57614abc8, now test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2)
[0m07:58:54.110708 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:58:54.120778 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:58:54.150763 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:58:54.158260 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:58:54.186535 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:58:54.188607 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: BEGIN
[0m07:58:54.190140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.196110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:54.198512 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m07:58:54.200889 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_sk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_sk is not null
group by channel_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.221961 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m07:58:54.227342 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: ROLLBACK
[0m07:58:54.231370 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: Close
[0m07:58:54.234920 [info ] [Thread-1 (]: 16 of 23 PASS unique_dim_channels_channel_sk ................................... [[32mPASS[0m in 0.13s]
[0m07:58:54.237700 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m07:58:54.239886 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:58:54.241566 [info ] [Thread-1 (]: 17 of 23 START test unique_dim_dates_date_day .................................. [RUN]
[0m07:58:54.243483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2, now test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7)
[0m07:58:54.245306 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:58:54.254071 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:58:54.275884 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:58:54.281069 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:58:54.304146 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:58:54.306801 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: BEGIN
[0m07:58:54.308914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.315242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:54.317559 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m07:58:54.319674 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_dates"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.323559 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m07:58:54.327230 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: ROLLBACK
[0m07:58:54.329130 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: Close
[0m07:58:54.331526 [info ] [Thread-1 (]: 17 of 23 PASS unique_dim_dates_date_day ........................................ [[32mPASS[0m in 0.09s]
[0m07:58:54.333198 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m07:58:54.334772 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:58:54.336292 [info ] [Thread-1 (]: 18 of 23 START test unique_fct_image_detections_detection_pk ................... [RUN]
[0m07:58:54.337947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7, now test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de)
[0m07:58:54.339345 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:58:54.346789 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:58:54.364838 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:58:54.374149 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:58:54.391887 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:58:54.393835 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: BEGIN
[0m07:58:54.395603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.401710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:54.404246 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m07:58:54.406296 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    detection_pk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_image_detections"
where detection_pk is not null
group by detection_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.410577 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m07:58:54.414922 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: ROLLBACK
[0m07:58:54.416739 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: Close
[0m07:58:54.419312 [info ] [Thread-1 (]: 18 of 23 PASS unique_fct_image_detections_detection_pk ......................... [[32mPASS[0m in 0.08s]
[0m07:58:54.421796 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m07:58:54.423837 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:58:54.425692 [info ] [Thread-1 (]: 19 of 23 START test unique_fct_messages_message_id ............................. [RUN]
[0m07:58:54.428280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de, now test.medical_dbt.unique_fct_messages_message_id.655aa1a48d)
[0m07:58:54.430150 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:58:54.437878 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:58:54.457287 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:58:54.463791 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:58:54.484357 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:58:54.486523 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: BEGIN
[0m07:58:54.488416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.494819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:54.497191 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m07:58:54.499114 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.555008 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.054 seconds
[0m07:58:54.560044 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: ROLLBACK
[0m07:58:54.563089 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: Close
[0m07:58:54.565735 [error] [Thread-1 (]: 19 of 23 FAIL 21 unique_fct_messages_message_id ................................ [[31mFAIL 21[0m in 0.14s]
[0m07:58:54.568745 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m07:58:54.571312 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:58:54.573853 [info ] [Thread-1 (]: 20 of 23 START test unique_fct_messages_message_pk ............................. [RUN]
[0m07:58:54.576345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_messages_message_id.655aa1a48d, now test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66)
[0m07:58:54.578937 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:58:54.587124 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:58:54.614449 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:58:54.620428 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:58:54.646853 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:58:54.667185 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: BEGIN
[0m07:58:54.670007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.679011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:58:54.682099 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m07:58:54.684804 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.734870 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m07:58:54.738584 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: ROLLBACK
[0m07:58:54.740553 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: Close
[0m07:58:54.742573 [error] [Thread-1 (]: 20 of 23 FAIL 21 unique_fct_messages_message_pk ................................ [[31mFAIL 21[0m in 0.17s]
[0m07:58:54.745382 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m07:58:54.747379 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:58:54.753446 [info ] [Thread-1 (]: 21 of 23 START test unique_stg_telegram_messages_channel_message_unique ........ [RUN]
[0m07:58:54.758581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66, now test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb)
[0m07:58:54.760748 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:58:54.772671 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:58:54.803451 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:58:54.810910 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:58:54.839707 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:58:54.842391 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: BEGIN
[0m07:58:54.844855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.850311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:58:54.852141 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m07:58:54.853978 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_message_unique as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where channel_message_unique is not null
group by channel_message_unique
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.873745 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_message_unique" does not exist
LINE 15:     channel_message_unique as unique_field,
             ^

[0m07:58:54.875362 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: ROLLBACK
[0m07:58:54.876905 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: Close
[0m07:58:54.884256 [debug] [Thread-1 (]: Database Error in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)
  column "channel_message_unique" does not exist
  LINE 15:     channel_message_unique as unique_field,
               ^
  compiled code at target/run/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql
[0m07:58:54.888694 [error] [Thread-1 (]: 21 of 23 ERROR unique_stg_telegram_messages_channel_message_unique ............. [[31mERROR[0m in 0.13s]
[0m07:58:54.891752 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m07:58:54.893211 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:58:54.894049 [debug] [Thread-4 (]: Marking all children of 'test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)
  column "channel_message_unique" does not exist
  LINE 15:     channel_message_unique as unique_field,
               ^
  compiled code at target/run/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql.
[0m07:58:54.895937 [info ] [Thread-1 (]: 22 of 23 START test unique_stg_telegram_messages_id ............................ [RUN]
[0m07:58:54.899821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb, now test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a)
[0m07:58:54.901827 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:58:54.910471 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:58:54.927048 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:58:54.932194 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:58:54.948129 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:58:54.950010 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: BEGIN
[0m07:58:54.951381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:54.957526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:58:54.959197 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"
[0m07:58:54.960535 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:54.980764 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m07:58:54.984506 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: ROLLBACK
[0m07:58:54.986243 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a: Close
[0m07:58:54.988076 [error] [Thread-1 (]: 22 of 23 FAIL 21 unique_stg_telegram_messages_id ............................... [[31mFAIL 21[0m in 0.09s]
[0m07:58:54.990958 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a
[0m07:58:54.993446 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:58:54.995586 [info ] [Thread-1 (]: 23 of 23 START test unique_stg_telegram_messages_message_id .................... [RUN]
[0m07:58:54.997668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_stg_telegram_messages_id.58b6a8a35a, now test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1)
[0m07:58:54.999750 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:58:55.010097 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:58:55.041260 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:58:55.049157 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:58:55.086363 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:58:55.089101 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: BEGIN
[0m07:58:55.091587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:55.099985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:58:55.102695 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m07:58:55.105954 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:58:55.133138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m07:58:55.137231 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m07:58:55.139902 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m07:58:55.143419 [error] [Thread-1 (]: 23 of 23 FAIL 21 unique_stg_telegram_messages_message_id ....................... [[31mFAIL 21[0m in 0.15s]
[0m07:58:55.147463 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m07:58:55.151630 [debug] [MainThread]: Using postgres connection "master"
[0m07:58:55.159737 [debug] [MainThread]: On master: BEGIN
[0m07:58:55.163003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:58:55.171335 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:58:55.173823 [debug] [MainThread]: On master: COMMIT
[0m07:58:55.177762 [debug] [MainThread]: Using postgres connection "master"
[0m07:58:55.180171 [debug] [MainThread]: On master: COMMIT
[0m07:58:55.182664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:58:55.184842 [debug] [MainThread]: On master: Close
[0m07:58:55.190191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:58:55.191915 [debug] [MainThread]: Connection 'test.medical_dbt.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m07:58:55.194191 [info ] [MainThread]: 
[0m07:58:55.197439 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m07:58:55.204410 [debug] [MainThread]: Command end result
[0m07:58:55.308859 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m07:58:55.320515 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m07:58:55.346330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m07:58:55.348322 [info ] [MainThread]: 
[0m07:58:55.351590 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m07:58:55.353615 [info ] [MainThread]: 
[0m07:58:55.356822 [error] [MainThread]: [31mFailure in test not_null_fct_messages_message_date_key (models/marts/schema.yml)[0m
[0m07:58:55.359845 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m07:58:55.362051 [info ] [MainThread]: 
[0m07:58:55.364292 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/not_null_fct_messages_message_date_key.sql
[0m07:58:55.366616 [info ] [MainThread]: 
[0m07:58:55.369249 [error] [MainThread]: [31mFailure in test unique_fct_messages_message_id (models/marts/schema.yml)[0m
[0m07:58:55.372093 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:58:55.376809 [info ] [MainThread]: 
[0m07:58:55.380339 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/unique_fct_messages_message_id.sql
[0m07:58:55.382478 [info ] [MainThread]: 
[0m07:58:55.384638 [error] [MainThread]: [31mFailure in test unique_fct_messages_message_pk (models/marts/schema.yml)[0m
[0m07:58:55.387073 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:58:55.389836 [info ] [MainThread]: 
[0m07:58:55.393514 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/unique_fct_messages_message_pk.sql
[0m07:58:55.398068 [info ] [MainThread]: 
[0m07:58:55.400280 [error] [MainThread]: [31mFailure in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)[0m
[0m07:58:55.402288 [error] [MainThread]:   Database Error in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)
  column "channel_message_unique" does not exist
  LINE 15:     channel_message_unique as unique_field,
               ^
  compiled code at target/run/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql
[0m07:58:55.404560 [info ] [MainThread]: 
[0m07:58:55.406419 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql
[0m07:58:55.408127 [info ] [MainThread]: 
[0m07:58:55.410280 [error] [MainThread]: [31mFailure in test unique_stg_telegram_messages_id (models/staging/schema.yml)[0m
[0m07:58:55.412137 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:58:55.413978 [info ] [MainThread]: 
[0m07:58:55.417292 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_id.sql
[0m07:58:55.418889 [info ] [MainThread]: 
[0m07:58:55.421611 [error] [MainThread]: [31mFailure in test unique_stg_telegram_messages_message_id (models/staging/schema.yml)[0m
[0m07:58:55.423572 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m07:58:55.425456 [info ] [MainThread]: 
[0m07:58:55.427399 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_message_id.sql
[0m07:58:55.429421 [info ] [MainThread]: 
[0m07:58:55.431245 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=23
[0m07:58:55.452146 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.3280506, "process_in_blocks": "95864", "process_kernel_time": 0.432738, "process_mem_max_rss": "120360", "process_out_blocks": "0", "process_user_time": 3.966773}
[0m07:58:55.454697 [debug] [MainThread]: Command `dbt test` failed at 07:58:55.454299 after 5.33 seconds
[0m07:58:55.456514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c13467910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0d881ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0d862410>]}
[0m07:58:55.458068 [debug] [MainThread]: Flushing usage events
[0m07:58:56.574269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:00:53.658418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9acbc77940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aca9ceb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aca9ceb30>]}


============================== 08:00:53.668591 | bdffdeb0-9cb5-4b62-986e-527f6d8457cc ==============================
[0m08:00:53.668591 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:00:53.672218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/src/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/src/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:00:54.143893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aca9ae710>]}
[0m08:00:54.241203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9acd4b6920>]}
[0m08:00:54.246835 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:00:54.349375 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:00:55.207269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:00:55.212745 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/schema.yml
[0m08:00:55.215829 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/stg_telegram_messages.sql
[0m08:00:55.911685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac1739db0>]}
[0m08:00:56.109725 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:00:56.146080 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:00:56.206890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac17333d0>]}
[0m08:00:56.211588 [info ] [MainThread]: Found 5 models, 21 data tests, 1 source, 433 macros
[0m08:00:56.214173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac17301c0>]}
[0m08:00:56.218608 [info ] [MainThread]: 
[0m08:00:56.224030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:00:56.228334 [info ] [MainThread]: 
[0m08:00:56.231995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:00:56.240609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights'
[0m08:00:56.299639 [debug] [ThreadPool]: Using postgres connection "list_medical_insights"
[0m08:00:56.302012 [debug] [ThreadPool]: On list_medical_insights: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights"} */

    select distinct nspname from pg_namespace
  
[0m08:00:56.303874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:56.333847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m08:00:56.337335 [debug] [ThreadPool]: On list_medical_insights: Close
[0m08:00:56.342212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_insights, now list_medical_insights_public)
[0m08:00:56.352439 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:00:56.354879 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m08:00:56.358172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:56.365062 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:00:56.367110 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:00:56.370834 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:00:56.380365 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m08:00:56.384059 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m08:00:56.386587 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m08:00:56.398126 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:56.401514 [debug] [MainThread]: On master: BEGIN
[0m08:00:56.403709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:00:56.412202 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:00:56.414942 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:56.417585 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:00:56.431400 [debug] [MainThread]: SQL status: SELECT 5 in 0.012 seconds
[0m08:00:56.436551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac17909d0>]}
[0m08:00:56.439826 [debug] [MainThread]: On master: ROLLBACK
[0m08:00:56.443337 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:56.446226 [debug] [MainThread]: On master: BEGIN
[0m08:00:56.449805 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:00:56.453817 [debug] [MainThread]: On master: COMMIT
[0m08:00:56.456344 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:56.459071 [debug] [MainThread]: On master: COMMIT
[0m08:00:56.461678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:00:56.464398 [debug] [MainThread]: On master: Close
[0m08:00:56.474176 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m08:00:56.477204 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_dates ................................... [RUN]
[0m08:00:56.479725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m08:00:56.482045 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m08:00:56.495955 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m08:00:56.520880 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m08:00:56.575285 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_dates"
[0m08:00:56.601090 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:00:56.603376 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: BEGIN
[0m08:00:56.607516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:56.615570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:00:56.617914 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:00:56.620205 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */

  create view "medical_insights"."public"."dim_dates__dbt_tmp"
    
    
  as (
    -- models/marts/dim_dates.sql

WITH date_spine AS (
    SELECT
        GENERATE_SERIES(
            '2023-01-01'::DATE,
            CURRENT_DATE + INTERVAL '1 year',
            '1 day'::INTERVAL
        )::DATE AS date_day
),

date_attributes AS (
    SELECT
        date_day,
        EXTRACT(YEAR FROM date_day) AS year,
        EXTRACT(MONTH FROM date_day) AS month,
        TO_CHAR(date_day, 'Month') AS month_name,
        EXTRACT(DAY FROM date_day) AS day_of_month,
        EXTRACT(DOW FROM date_day) AS day_of_week, -- Sunday = 0, Saturday = 6
        TO_CHAR(date_day, 'Day') AS day_name,
        EXTRACT(DOY FROM date_day) AS day_of_year,
        EXTRACT(WEEK FROM date_day) AS week_of_year,
        EXTRACT(QUARTER FROM date_day) AS quarter_of_year,
        TO_CHAR(date_day, 'YYYY-MM') AS year_month,
        TO_CHAR(date_day, 'YYYY-MM-DD') AS full_date_string,
        (CASE WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE ELSE FALSE END) AS is_weekend
    FROM date_spine
)

SELECT *
FROM date_attributes
  );
[0m08:00:56.649772 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m08:00:56.662040 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:00:56.665002 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m08:00:56.669384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:00:56.678916 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:00:56.681733 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m08:00:56.685307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:00:56.725788 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m08:00:56.729255 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:00:56.732290 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m08:00:56.739716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:00:56.755746 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_dates__dbt_backup"
[0m08:00:56.766439 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:00:56.769519 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
drop view if exists "medical_insights"."public"."dim_dates__dbt_backup" cascade
[0m08:00:56.778727 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m08:00:56.785978 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: Close
[0m08:00:56.793395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9acd2477f0>]}
[0m08:00:56.798284 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_dates .............................. [[32mCREATE VIEW[0m in 0.31s]
[0m08:00:56.801280 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m08:00:56.803892 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_image_detections
[0m08:00:56.806749 [info ] [Thread-1 (]: 2 of 5 START sql view model public.fct_image_detections ........................ [RUN]
[0m08:00:56.810591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.fct_image_detections)
[0m08:00:56.813775 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_image_detections
[0m08:00:56.819259 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_image_detections"
[0m08:00:56.851069 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_image_detections
[0m08:00:56.861014 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_image_detections"
[0m08:00:56.890128 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:00:56.893600 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: BEGIN
[0m08:00:56.896541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:56.904973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:00:56.911452 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:00:56.914417 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */

  create view "medical_insights"."public"."fct_image_detections__dbt_tmp"
    
    
  as (
    -- models/marts/fct_image_detections.sql

SELECT
    md5(concat(message_id::text, object_class, detection_time::text)) AS detection_pk, -- surrogate key
    message_id,
    image_id,
    object_class,
    confidence_score,
    detection_time
FROM (
    VALUES
        (NULL, NULL, NULL, NULL, NULL) -- Placeholder row, to be replaced by enrichment process
) AS t(message_id, image_id, object_class, confidence_score, detection_time)
WHERE message_id IS NOT NULL
  );
[0m08:00:56.920582 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:00:56.930401 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:00:56.933226 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m08:00:56.936734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:00:56.947550 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:00:56.951870 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m08:00:56.955732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:00:56.960355 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m08:00:56.962944 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:00:56.965855 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m08:00:56.982501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m08:00:56.988895 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_image_detections__dbt_backup"
[0m08:00:56.993009 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:00:56.997437 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
drop view if exists "medical_insights"."public"."fct_image_detections__dbt_backup" cascade
[0m08:00:57.003519 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m08:00:57.009369 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: Close
[0m08:00:57.012066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0ae4640>]}
[0m08:00:57.014529 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.fct_image_detections ................... [[32mCREATE VIEW[0m in 0.20s]
[0m08:00:57.017209 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_image_detections
[0m08:00:57.019467 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m08:00:57.021679 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m08:00:57.025546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.fct_image_detections, now model.medical_dbt.stg_telegram_messages)
[0m08:00:57.028003 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m08:00:57.033810 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.059749 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m08:00:57.069934 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.098220 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.100679 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: BEGIN
[0m08:00:57.103033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:57.110921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:00:57.113543 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.116803 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */

  create view "medical_insights"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

WITH raw_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        data AS raw_data,
        scraped_at
    FROM "medical_insights"."raw"."telegram_messages"
),

cleaned_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        scraped_at,
        raw_data->>'message' AS message_text,
        (raw_data->>'date')::TIMESTAMP AS message_date,
        (raw_data->>'views')::INT AS views_count,
        (raw_data->>'forwards')::INT AS forwards_count,
        (raw_data->'replies'->>'replies') AS replies_count, -- Fixed extraction for replies_count
        (raw_data->>'reactions') IS NOT NULL AS has_reactions,
        (raw_data->>'photo') IS NOT NULL AS has_photo,
        -- Extract product mentions (enhanced regex for Ethiopian context)
        REGEXP_MATCHES(
            raw_data->>'message',
            '(?i)(paracetamol|amoxicillin|ibuprofen|diclofenac|metronidazole|coartem|albendazole|ORS|syrup|tablet|capsule|suspension|injection|vaccine|antimalarial|antibiotic|antifungal|antiviral|cream|pill)s?',
            'g'
        ) AS product_mentions
    FROM raw_messages
    WHERE raw_data->>'message' IS NOT NULL OR raw_data->>'photo' IS NOT NULL
)

SELECT
    id,
    channel_name,
    message_id,
    message_text,
    message_date,
    COALESCE(views_count, 0) AS views_count,
    COALESCE(forwards_count, 0) AS forwards_count,
    COALESCE(replies_count::INT, 0) AS replies_count,
    has_reactions,
    has_photo,
    product_mentions,
    scraped_at,
    channel_name || '-' || message_id AS channel_message_unique
FROM cleaned_messages
  );
[0m08:00:57.144696 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m08:00:57.153532 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.158037 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m08:00:57.161457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:00:57.168582 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.171295 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m08:00:57.176234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:00:57.180501 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m08:00:57.183012 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.185418 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m08:00:57.191161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:00:57.198187 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."stg_telegram_messages__dbt_backup"
[0m08:00:57.201047 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:00:57.203809 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
drop view if exists "medical_insights"."public"."stg_telegram_messages__dbt_backup" cascade
[0m08:00:57.211067 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m08:00:57.216240 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: Close
[0m08:00:57.220320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0ae4640>]}
[0m08:00:57.225088 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 0.19s]
[0m08:00:57.228271 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m08:00:57.232145 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m08:00:57.234986 [info ] [Thread-1 (]: 4 of 5 START sql view model public.dim_channels ................................ [RUN]
[0m08:00:57.238503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.stg_telegram_messages, now model.medical_dbt.dim_channels)
[0m08:00:57.241833 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_channels
[0m08:00:57.249990 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_channels"
[0m08:00:57.279662 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_channels
[0m08:00:57.289731 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_channels"
[0m08:00:57.321688 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:00:57.325225 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: BEGIN
[0m08:00:57.328494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:57.337730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:00:57.340964 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:00:57.344040 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */

  create view "medical_insights"."public"."dim_channels__dbt_tmp"
    
    
  as (
    -- models/marts/dim_channels.sql

SELECT DISTINCT
    channel_name,
    MD5(channel_name) AS channel_sk -- Surrogate key for channel
FROM "medical_insights"."public"."stg_telegram_messages"
  );
[0m08:00:57.349367 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:00:57.357860 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:00:57.360802 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
alter table "medical_insights"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m08:00:57.364398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:00:57.369057 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m08:00:57.372480 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:00:57.375625 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m08:00:57.381246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:00:57.390276 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_channels__dbt_backup"
[0m08:00:57.394051 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:00:57.396893 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
drop view if exists "medical_insights"."public"."dim_channels__dbt_backup" cascade
[0m08:00:57.400679 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:00:57.404549 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: Close
[0m08:00:57.408023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac015a080>]}
[0m08:00:57.411120 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.dim_channels ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m08:00:57.413662 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m08:00:57.416899 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m08:00:57.419230 [info ] [Thread-1 (]: 5 of 5 START sql view model public.fct_messages ................................ [RUN]
[0m08:00:57.422031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_channels, now model.medical_dbt.fct_messages)
[0m08:00:57.425086 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_messages
[0m08:00:57.432483 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_messages"
[0m08:00:57.460576 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_messages
[0m08:00:57.470598 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_messages"
[0m08:00:57.504403 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:00:57.507529 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: BEGIN
[0m08:00:57.510360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:57.517225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:00:57.520083 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:00:57.522966 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */

  create view "medical_insights"."public"."fct_messages__dbt_tmp"
    
    
  as (
    -- models/marts/fct_messages.sql

WITH stg_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        message_text,
        message_date,
        views_count,
        forwards_count,
        replies_count,
        has_reactions,
        has_photo,
        product_mentions,
        scraped_at
    FROM "medical_insights"."public"."stg_telegram_messages"
),

channels AS (
    SELECT
        channel_name,
        channel_sk
    FROM "medical_insights"."public"."dim_channels"
),

dates AS (
    SELECT
        date_day,
        year,
        month,
        day_of_month
    FROM "medical_insights"."public"."dim_dates"
)

SELECT
    sm.id AS message_pk,
    sm.message_id,
    sm.message_text,
    LENGTH(sm.message_text) AS message_length,
    sm.message_date,
    sm.views_count,
    sm.forwards_count,
    sm.replies_count,
    sm.has_reactions,
    sm.has_photo,
    sm.product_mentions,
    sm.scraped_at,
    c.channel_sk,
    d.date_day AS message_date_key
FROM stg_messages sm
LEFT JOIN channels c ON sm.channel_name = c.channel_name
LEFT JOIN dates d ON sm.message_date::DATE = d.date_day
  );
[0m08:00:57.548007 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m08:00:57.557072 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:00:57.560368 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
alter table "medical_insights"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m08:00:57.563594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:00:57.568074 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m08:00:57.570595 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:00:57.574373 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m08:00:57.579056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:00:57.585390 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_messages__dbt_backup"
[0m08:00:57.589106 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:00:57.592012 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
drop view if exists "medical_insights"."public"."fct_messages__dbt_backup" cascade
[0m08:00:57.595412 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:00:57.599602 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: Close
[0m08:00:57.602588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffdeb0-9cb5-4b62-986e-527f6d8457cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac0ab4970>]}
[0m08:00:57.608089 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.fct_messages ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m08:00:57.613518 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m08:00:57.618480 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:57.621043 [debug] [MainThread]: On master: BEGIN
[0m08:00:57.625869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:00:57.634261 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:00:57.637470 [debug] [MainThread]: On master: COMMIT
[0m08:00:57.642072 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:57.645211 [debug] [MainThread]: On master: COMMIT
[0m08:00:57.648622 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:00:57.651181 [debug] [MainThread]: On master: Close
[0m08:00:57.654870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:57.658816 [debug] [MainThread]: Connection 'model.medical_dbt.fct_messages' was properly closed.
[0m08:00:57.661525 [info ] [MainThread]: 
[0m08:00:57.664304 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m08:00:57.668694 [debug] [MainThread]: Command end result
[0m08:00:57.784121 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:00:57.804984 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:00:57.836071 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m08:00:57.839654 [info ] [MainThread]: 
[0m08:00:57.843561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:00:57.846538 [info ] [MainThread]: 
[0m08:00:57.849656 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:00:57.875174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4039917, "process_in_blocks": "95312", "process_kernel_time": 0.422881, "process_mem_max_rss": "127696", "process_out_blocks": "0", "process_user_time": 3.973118}
[0m08:00:57.879126 [debug] [MainThread]: Command `dbt run` succeeded at 08:00:57.878817 after 4.41 seconds
[0m08:00:57.882352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9acbc77940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac9d3a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9acd4b6920>]}
[0m08:00:57.885538 [debug] [MainThread]: Flushing usage events
[0m08:00:59.237292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:01:53.649541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4916ba7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4915912ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4915912e90>]}


============================== 08:01:53.658009 | 8ba70d4a-0db5-429d-add4-218cb2c2b005 ==============================
[0m08:01:53.658009 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:01:53.660986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/src/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /app/src/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:01:54.035710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ba70d4a-0db5-429d-add4-218cb2c2b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491531b100>]}
[0m08:01:54.129694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ba70d4a-0db5-429d-add4-218cb2c2b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4916186590>]}
[0m08:01:54.133911 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:01:54.235848 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:01:55.083420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:01:55.086641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:01:55.185625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ba70d4a-0db5-429d-add4-218cb2c2b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4913ff5cf0>]}
[0m08:01:55.467252 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:01:55.503792 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:01:55.584392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ba70d4a-0db5-429d-add4-218cb2c2b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4913b040d0>]}
[0m08:01:55.587521 [info ] [MainThread]: Found 5 models, 21 data tests, 1 source, 433 macros
[0m08:01:55.589967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba70d4a-0db5-429d-add4-218cb2c2b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4913b04dc0>]}
[0m08:01:55.596184 [info ] [MainThread]: 
[0m08:01:55.599263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:01:55.601488 [info ] [MainThread]: 
[0m08:01:55.604311 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:01:55.613003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights_public'
[0m08:01:55.667991 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:01:55.671139 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m08:01:55.673732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:55.703078 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m08:01:55.706212 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:01:55.708988 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:01:55.722562 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m08:01:55.727546 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m08:01:55.730132 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m08:01:55.739681 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:55.742270 [debug] [MainThread]: On master: BEGIN
[0m08:01:55.744140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:01:55.750126 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:01:55.752394 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:55.754580 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:01:55.767080 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m08:01:55.770891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ba70d4a-0db5-429d-add4-218cb2c2b005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4913b23280>]}
[0m08:01:55.773651 [debug] [MainThread]: On master: ROLLBACK
[0m08:01:55.776556 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:55.778439 [debug] [MainThread]: On master: BEGIN
[0m08:01:55.780902 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:01:55.783296 [debug] [MainThread]: On master: COMMIT
[0m08:01:55.785355 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:55.787193 [debug] [MainThread]: On master: COMMIT
[0m08:01:55.789901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:01:55.792027 [debug] [MainThread]: On master: Close
[0m08:01:55.801676 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:01:55.804209 [info ] [Thread-1 (]: 1 of 21 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m08:01:55.807835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m08:01:55.810760 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:01:55.840337 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:01:55.868986 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:01:55.894184 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:01:55.928398 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:01:55.931448 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m08:01:55.934481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:55.944484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m08:01:55.948000 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:01:55.951160 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_insights"."public"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m08:01:55.956597 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:01:55.963849 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m08:01:55.966808 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m08:01:55.969546 [info ] [Thread-1 (]: 1 of 21 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.16s]
[0m08:01:55.972922 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:01:55.975606 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:01:55.978116 [info ] [Thread-1 (]: 2 of 21 START test not_null_dim_channels_channel_sk ............................ [RUN]
[0m08:01:55.980725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac)
[0m08:01:55.983359 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:01:55.990295 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:01:56.022840 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:01:56.029551 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:01:56.063447 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:01:56.066512 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: BEGIN
[0m08:01:56.069601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:56.080864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m08:01:56.083596 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:01:56.086299 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."dim_channels"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m08:01:56.092701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m08:01:56.097267 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: ROLLBACK
[0m08:01:56.100898 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: Close
[0m08:01:56.105162 [info ] [Thread-1 (]: 2 of 21 PASS not_null_dim_channels_channel_sk .................................. [[32mPASS[0m in 0.12s]
[0m08:01:56.109491 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:01:56.112242 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:01:56.114273 [info ] [Thread-1 (]: 3 of 21 START test not_null_dim_dates_date_day ................................. [RUN]
[0m08:01:56.117701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac, now test.medical_dbt.not_null_dim_dates_date_day.1717af99fb)
[0m08:01:56.120548 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:01:56.127671 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:01:56.158466 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:01:56.166797 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:01:56.199561 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:01:56.202522 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: BEGIN
[0m08:01:56.206549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:56.213806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:56.215893 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:01:56.218211 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "medical_insights"."public"."dim_dates"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m08:01:56.241231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m08:01:56.247329 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: ROLLBACK
[0m08:01:56.250385 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: Close
[0m08:01:56.253472 [info ] [Thread-1 (]: 3 of 21 PASS not_null_dim_dates_date_day ....................................... [[32mPASS[0m in 0.14s]
[0m08:01:56.256933 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:01:56.260642 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:01:56.263273 [info ] [Thread-1 (]: 4 of 21 START test not_null_fct_image_detections_detection_pk .................. [RUN]
[0m08:01:56.265648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_dates_date_day.1717af99fb, now test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6)
[0m08:01:56.267826 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:01:56.277114 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:01:56.309226 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:01:56.315321 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:01:56.349023 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:01:56.351619 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: BEGIN
[0m08:01:56.354539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:56.363013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:01:56.365735 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:01:56.368657 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select detection_pk
from "medical_insights"."public"."fct_image_detections"
where detection_pk is null



  
  
      
    ) dbt_internal_test
[0m08:01:56.373672 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:01:56.378612 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: ROLLBACK
[0m08:01:56.381733 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: Close
[0m08:01:56.385031 [info ] [Thread-1 (]: 4 of 21 PASS not_null_fct_image_detections_detection_pk ........................ [[32mPASS[0m in 0.12s]
[0m08:01:56.387985 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:01:56.391235 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:01:56.393935 [info ] [Thread-1 (]: 5 of 21 START test not_null_fct_image_detections_message_id .................... [RUN]
[0m08:01:56.397330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6, now test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8)
[0m08:01:56.399821 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:01:56.406365 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:01:56.435486 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:01:56.442068 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:01:56.465400 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:01:56.467954 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: BEGIN
[0m08:01:56.470850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:56.479849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:01:56.482426 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:01:56.484551 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_image_detections"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m08:01:56.489496 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:01:56.494721 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: ROLLBACK
[0m08:01:56.497331 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: Close
[0m08:01:56.500119 [info ] [Thread-1 (]: 5 of 21 PASS not_null_fct_image_detections_message_id .......................... [[32mPASS[0m in 0.10s]
[0m08:01:56.503207 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:01:56.506502 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:01:56.509240 [info ] [Thread-1 (]: 6 of 21 START test not_null_fct_image_detections_object_class .................. [RUN]
[0m08:01:56.511812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8, now test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24)
[0m08:01:56.513914 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:01:56.520441 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:01:56.547094 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:01:56.552276 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:01:56.578478 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:01:56.581070 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: BEGIN
[0m08:01:56.583593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:56.591056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:56.593643 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:01:56.595779 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select object_class
from "medical_insights"."public"."fct_image_detections"
where object_class is null



  
  
      
    ) dbt_internal_test
[0m08:01:56.598358 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:01:56.601536 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: ROLLBACK
[0m08:01:56.603293 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: Close
[0m08:01:56.605922 [info ] [Thread-1 (]: 6 of 21 PASS not_null_fct_image_detections_object_class ........................ [[32mPASS[0m in 0.09s]
[0m08:01:56.608496 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:01:56.610731 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:01:56.612573 [info ] [Thread-1 (]: 7 of 21 START test not_null_fct_messages_channel_sk ............................ [RUN]
[0m08:01:56.614134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24, now test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3)
[0m08:01:56.615941 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:01:56.622819 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:01:56.646026 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:01:56.651217 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:01:56.674567 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:01:56.676807 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: BEGIN
[0m08:01:56.678814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:56.684773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:01:56.687299 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:01:56.689875 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."fct_messages"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m08:01:56.819616 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.127 seconds
[0m08:01:56.828456 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: ROLLBACK
[0m08:01:56.831354 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: Close
[0m08:01:56.833978 [info ] [Thread-1 (]: 7 of 21 PASS not_null_fct_messages_channel_sk .................................. [[32mPASS[0m in 0.22s]
[0m08:01:56.836461 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:01:56.839120 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:01:56.841169 [info ] [Thread-1 (]: 8 of 21 START test not_null_fct_messages_message_date_key ...................... [RUN]
[0m08:01:56.843452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3, now test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3)
[0m08:01:56.845612 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:01:56.852268 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:01:56.879609 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:01:56.884797 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:01:56.905018 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:01:56.907536 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: BEGIN
[0m08:01:56.909677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:56.916214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:01:56.918901 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:01:56.921452 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date_key
from "medical_insights"."public"."fct_messages"
where message_date_key is null



  
  
      
    ) dbt_internal_test
[0m08:01:57.020710 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.097 seconds
[0m08:01:57.026913 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: ROLLBACK
[0m08:01:57.035711 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: Close
[0m08:01:57.041235 [error] [Thread-1 (]: 8 of 21 FAIL 4 not_null_fct_messages_message_date_key .......................... [[31mFAIL 4[0m in 0.20s]
[0m08:01:57.044545 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:01:57.046708 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:01:57.049503 [info ] [Thread-1 (]: 9 of 21 START test not_null_fct_messages_message_id ............................ [RUN]
[0m08:01:57.051718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3, now test.medical_dbt.not_null_fct_messages_message_id.de346706b5)
[0m08:01:57.054796 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:01:57.062670 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:01:57.091959 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:01:57.096644 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:01:57.119571 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:01:57.122531 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: BEGIN
[0m08:01:57.124474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:57.131555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:57.133664 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:01:57.135996 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m08:01:57.143931 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m08:01:57.148647 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m08:01:57.151493 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: Close
[0m08:01:57.154272 [info ] [Thread-1 (]: 9 of 21 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 0.10s]
[0m08:01:57.157621 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:01:57.160049 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:01:57.162134 [info ] [Thread-1 (]: 10 of 21 START test not_null_fct_messages_message_pk ........................... [RUN]
[0m08:01:57.164184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_id.de346706b5, now test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec)
[0m08:01:57.165992 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:01:57.173140 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:01:57.196643 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:01:57.201453 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:01:57.222846 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:01:57.225351 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: BEGIN
[0m08:01:57.227244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:57.233772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:57.235802 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:01:57.237928 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_insights"."public"."fct_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m08:01:57.243167 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:01:57.246737 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: ROLLBACK
[0m08:01:57.248470 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: Close
[0m08:01:57.251481 [info ] [Thread-1 (]: 10 of 21 PASS not_null_fct_messages_message_pk ................................. [[32mPASS[0m in 0.09s]
[0m08:01:57.255880 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:01:57.258437 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:01:57.260296 [info ] [Thread-1 (]: 11 of 21 START test not_null_stg_telegram_messages_id .......................... [RUN]
[0m08:01:57.262740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec, now test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m08:01:57.264307 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:01:57.271978 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:01:57.290998 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:01:57.299002 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:01:57.315222 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:01:57.317396 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m08:01:57.319177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:57.326494 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:57.328687 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:01:57.330500 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "medical_insights"."public"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m08:01:57.333307 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:01:57.336246 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m08:01:57.338776 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m08:01:57.341565 [info ] [Thread-1 (]: 11 of 21 PASS not_null_stg_telegram_messages_id ................................ [[32mPASS[0m in 0.08s]
[0m08:01:57.343844 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:01:57.345665 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:01:57.347342 [info ] [Thread-1 (]: 12 of 21 START test not_null_stg_telegram_messages_message_id .................. [RUN]
[0m08:01:57.349303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m08:01:57.350904 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:01:57.358602 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:01:57.377498 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:01:57.382264 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:01:57.403243 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:01:57.405316 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: BEGIN
[0m08:01:57.406959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:57.414073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:57.415850 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:01:57.417888 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m08:01:57.421306 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:01:57.425057 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m08:01:57.427425 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m08:01:57.429559 [info ] [Thread-1 (]: 12 of 21 PASS not_null_stg_telegram_messages_message_id ........................ [[32mPASS[0m in 0.08s]
[0m08:01:57.431176 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:01:57.432784 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:01:57.434391 [info ] [Thread-1 (]: 13 of 21 START test relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [RUN]
[0m08:01:57.436410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241)
[0m08:01:57.438331 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:01:57.452641 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:01:57.475992 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:01:57.482625 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:01:57.507790 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:01:57.510676 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: BEGIN
[0m08:01:57.513135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:57.520479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:57.523159 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:01:57.525547 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_sk as from_field
    from "medical_insights"."public"."fct_messages"
    where channel_sk is not null
),

parent as (
    select channel_sk as to_field
    from "medical_insights"."public"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m08:01:57.675248 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.147 seconds
[0m08:01:57.679319 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: ROLLBACK
[0m08:01:57.681492 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: Close
[0m08:01:57.683863 [info ] [Thread-1 (]: 13 of 21 PASS relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [[32mPASS[0m in 0.25s]
[0m08:01:57.686230 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:01:57.689106 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:01:57.691879 [info ] [Thread-1 (]: 14 of 21 START test relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [RUN]
[0m08:01:57.694022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241, now test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1)
[0m08:01:57.696288 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:01:57.706577 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:01:57.732078 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:01:57.737446 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:01:57.762200 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:01:57.764296 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: BEGIN
[0m08:01:57.766518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:57.773210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:57.776012 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:01:57.778361 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select message_date_key as from_field
    from "medical_insights"."public"."fct_messages"
    where message_date_key is not null
),

parent as (
    select date_day as to_field
    from "medical_insights"."public"."dim_dates"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m08:01:57.883879 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.103 seconds
[0m08:01:57.889000 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: ROLLBACK
[0m08:01:57.892187 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: Close
[0m08:01:57.896104 [info ] [Thread-1 (]: 14 of 21 PASS relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [[32mPASS[0m in 0.20s]
[0m08:01:57.898868 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:01:57.901176 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:01:57.904747 [info ] [Thread-1 (]: 15 of 21 START test unique_dim_channels_channel_name ........................... [RUN]
[0m08:01:57.908212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1, now test.medical_dbt.unique_dim_channels_channel_name.e57614abc8)
[0m08:01:57.910615 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:01:57.925051 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:01:57.949982 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:01:57.956095 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:01:57.982836 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:01:57.985163 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m08:01:57.987512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:57.994780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:57.997085 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:01:57.999092 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:01:58.048388 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m08:01:58.052724 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m08:01:58.058043 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: Close
[0m08:01:58.061267 [info ] [Thread-1 (]: 15 of 21 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.15s]
[0m08:01:58.063900 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:01:58.066250 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:01:58.068418 [info ] [Thread-1 (]: 16 of 21 START test unique_dim_channels_channel_sk ............................. [RUN]
[0m08:01:58.072764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_name.e57614abc8, now test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2)
[0m08:01:58.074808 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:01:58.084638 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:01:58.113609 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:01:58.120089 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:01:58.144343 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:01:58.146892 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: BEGIN
[0m08:01:58.149057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:58.157312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:01:58.160053 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:01:58.162264 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_sk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_sk is not null
group by channel_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:01:58.207820 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m08:01:58.212246 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: ROLLBACK
[0m08:01:58.215310 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: Close
[0m08:01:58.218158 [info ] [Thread-1 (]: 16 of 21 PASS unique_dim_channels_channel_sk ................................... [[32mPASS[0m in 0.15s]
[0m08:01:58.223321 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:01:58.225684 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:01:58.228190 [info ] [Thread-1 (]: 17 of 21 START test unique_dim_dates_date_day .................................. [RUN]
[0m08:01:58.231353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2, now test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7)
[0m08:01:58.233545 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:01:58.241629 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:01:58.271333 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:01:58.278877 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:01:58.308922 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:01:58.311790 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: BEGIN
[0m08:01:58.314233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:58.322549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:01:58.325962 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:01:58.328968 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_dates"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:01:58.334094 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:01:58.338918 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: ROLLBACK
[0m08:01:58.342247 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: Close
[0m08:01:58.345908 [info ] [Thread-1 (]: 17 of 21 PASS unique_dim_dates_date_day ........................................ [[32mPASS[0m in 0.11s]
[0m08:01:58.348274 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:01:58.351259 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:01:58.353640 [info ] [Thread-1 (]: 18 of 21 START test unique_fct_image_detections_detection_pk ................... [RUN]
[0m08:01:58.356875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7, now test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de)
[0m08:01:58.359998 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:01:58.368968 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:01:58.399679 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:01:58.408327 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:01:58.439566 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:01:58.442526 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: BEGIN
[0m08:01:58.445404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:58.453356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:01:58.456301 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:01:58.459347 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    detection_pk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_image_detections"
where detection_pk is not null
group by detection_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:01:58.463481 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:01:58.467778 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: ROLLBACK
[0m08:01:58.472390 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: Close
[0m08:01:58.476987 [info ] [Thread-1 (]: 18 of 21 PASS unique_fct_image_detections_detection_pk ......................... [[32mPASS[0m in 0.12s]
[0m08:01:58.479943 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:01:58.481940 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m08:01:58.483894 [info ] [Thread-1 (]: 19 of 21 START test unique_fct_messages_message_id ............................. [RUN]
[0m08:01:58.485795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de, now test.medical_dbt.unique_fct_messages_message_id.655aa1a48d)
[0m08:01:58.489727 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m08:01:58.496981 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m08:01:58.529052 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m08:01:58.536896 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m08:01:58.560072 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m08:01:58.562155 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: BEGIN
[0m08:01:58.564023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:58.570029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:01:58.572376 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m08:01:58.574502 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_messages_message_id.655aa1a48d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:01:58.672855 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.096 seconds
[0m08:01:58.677110 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: ROLLBACK
[0m08:01:58.679836 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_id.655aa1a48d: Close
[0m08:01:58.701693 [error] [Thread-1 (]: 19 of 21 FAIL 36 unique_fct_messages_message_id ................................ [[31mFAIL 36[0m in 0.22s]
[0m08:01:58.705620 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_messages_message_id.655aa1a48d
[0m08:01:58.708870 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m08:01:58.711705 [info ] [Thread-1 (]: 20 of 21 START test unique_fct_messages_message_pk ............................. [RUN]
[0m08:01:58.715045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_messages_message_id.655aa1a48d, now test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66)
[0m08:01:58.717728 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m08:01:58.725597 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m08:01:58.756551 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m08:01:58.764123 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m08:01:58.795435 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m08:01:58.798029 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: BEGIN
[0m08:01:58.800458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:58.809889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:01:58.812962 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"
[0m08:01:58.815850 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:01:58.919241 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.100 seconds
[0m08:01:58.926434 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: ROLLBACK
[0m08:01:58.930050 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66: Close
[0m08:01:58.932456 [error] [Thread-1 (]: 20 of 21 FAIL 36 unique_fct_messages_message_pk ................................ [[31mFAIL 36[0m in 0.22s]
[0m08:01:58.935632 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66
[0m08:01:58.940896 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:01:58.943475 [info ] [Thread-1 (]: 21 of 21 START test unique_stg_telegram_messages_channel_message_unique ........ [RUN]
[0m08:01:58.945863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_messages_message_pk.c7d08c9b66, now test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb)
[0m08:01:58.948115 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:01:58.958265 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:01:58.990530 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:01:58.996395 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:01:59.024333 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:01:59.026748 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: BEGIN
[0m08:01:59.028649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:59.036001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:01:59.039236 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:01:59.041478 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_message_unique as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where channel_message_unique is not null
group by channel_message_unique
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:01:59.099136 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.055 seconds
[0m08:01:59.102994 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: ROLLBACK
[0m08:01:59.108870 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: Close
[0m08:01:59.112579 [error] [Thread-1 (]: 21 of 21 FAIL 36 unique_stg_telegram_messages_channel_message_unique ........... [[31mFAIL 36[0m in 0.17s]
[0m08:01:59.115523 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:01:59.119653 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:59.122573 [debug] [MainThread]: On master: BEGIN
[0m08:01:59.124990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:01:59.131513 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:01:59.133664 [debug] [MainThread]: On master: COMMIT
[0m08:01:59.136006 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:59.138181 [debug] [MainThread]: On master: COMMIT
[0m08:01:59.141167 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:01:59.143434 [debug] [MainThread]: On master: Close
[0m08:01:59.145664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:59.147850 [debug] [MainThread]: Connection 'test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb' was properly closed.
[0m08:01:59.150137 [info ] [MainThread]: 
[0m08:01:59.152526 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m08:01:59.160242 [debug] [MainThread]: Command end result
[0m08:01:59.251602 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:01:59.264508 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:01:59.290510 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m08:01:59.292897 [info ] [MainThread]: 
[0m08:01:59.295304 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m08:01:59.298042 [info ] [MainThread]: 
[0m08:01:59.300156 [error] [MainThread]: [31mFailure in test not_null_fct_messages_message_date_key (models/marts/schema.yml)[0m
[0m08:01:59.302301 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m08:01:59.304970 [info ] [MainThread]: 
[0m08:01:59.307699 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/not_null_fct_messages_message_date_key.sql
[0m08:01:59.310129 [info ] [MainThread]: 
[0m08:01:59.312285 [error] [MainThread]: [31mFailure in test unique_fct_messages_message_id (models/marts/schema.yml)[0m
[0m08:01:59.314170 [error] [MainThread]:   Got 36 results, configured to fail if != 0
[0m08:01:59.316212 [info ] [MainThread]: 
[0m08:01:59.318148 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/unique_fct_messages_message_id.sql
[0m08:01:59.320548 [info ] [MainThread]: 
[0m08:01:59.323199 [error] [MainThread]: [31mFailure in test unique_fct_messages_message_pk (models/marts/schema.yml)[0m
[0m08:01:59.325528 [error] [MainThread]:   Got 36 results, configured to fail if != 0
[0m08:01:59.328212 [info ] [MainThread]: 
[0m08:01:59.330261 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/unique_fct_messages_message_pk.sql
[0m08:01:59.331993 [info ] [MainThread]: 
[0m08:01:59.334325 [error] [MainThread]: [31mFailure in test unique_stg_telegram_messages_channel_message_unique (models/staging/schema.yml)[0m
[0m08:01:59.336476 [error] [MainThread]:   Got 36 results, configured to fail if != 0
[0m08:01:59.338935 [info ] [MainThread]: 
[0m08:01:59.342161 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/schema.yml/unique_stg_telegram_messages_channel_message_unique.sql
[0m08:01:59.344530 [info ] [MainThread]: 
[0m08:01:59.347082 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=21
[0m08:01:59.369332 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.8848376, "process_in_blocks": "95472", "process_kernel_time": 0.376029, "process_mem_max_rss": "120320", "process_out_blocks": "0", "process_user_time": 3.7504}
[0m08:01:59.372976 [debug] [MainThread]: Command `dbt test` failed at 08:01:59.372631 after 5.89 seconds
[0m08:01:59.376318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4916ba7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4913ff5f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4913f241f0>]}
[0m08:01:59.378914 [debug] [MainThread]: Flushing usage events
[0m08:02:00.659753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:07:10.587333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ac2a7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ab00aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ab00aa10>]}


============================== 08:07:10.598078 | 5375f418-612f-4b90-9df6-e15b52f9d415 ==============================
[0m08:07:10.598078 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:07:10.600779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/src/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/src/dbt', 'send_anonymous_usage_stats': 'True'}
[0m08:07:10.961506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aafe8fd0>]}
[0m08:07:11.048915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ab00a140>]}
[0m08:07:11.052650 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:07:11.146024 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:07:11.773542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:07:11.777255 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/marts/schema.yml
[0m08:07:11.779744 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/stg_telegram_messages.sql
[0m08:07:12.662340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a1f5c130>]}
[0m08:07:12.867893 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:07:12.900950 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:07:12.956665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a1f5cb80>]}
[0m08:07:12.959751 [info ] [MainThread]: Found 5 models, 19 data tests, 1 source, 433 macros
[0m08:07:12.961968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a1f85120>]}
[0m08:07:12.965795 [info ] [MainThread]: 
[0m08:07:12.968099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:07:12.970203 [info ] [MainThread]: 
[0m08:07:12.973313 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:12.983574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights'
[0m08:07:13.032569 [debug] [ThreadPool]: Using postgres connection "list_medical_insights"
[0m08:07:13.034624 [debug] [ThreadPool]: On list_medical_insights: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights"} */

    select distinct nspname from pg_namespace
  
[0m08:07:13.036533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:13.064879 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m08:07:13.068275 [debug] [ThreadPool]: On list_medical_insights: Close
[0m08:07:13.073634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_insights, now list_medical_insights_public)
[0m08:07:13.085694 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:07:13.088494 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m08:07:13.090859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:13.097302 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:07:13.099386 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:07:13.101233 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:07:13.111879 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m08:07:13.116195 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m08:07:13.119058 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m08:07:13.131407 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:13.133554 [debug] [MainThread]: On master: BEGIN
[0m08:07:13.135561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:07:13.143279 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:07:13.145844 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:13.148193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:07:13.162032 [debug] [MainThread]: SQL status: SELECT 5 in 0.011 seconds
[0m08:07:13.166731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aa3f3460>]}
[0m08:07:13.169298 [debug] [MainThread]: On master: ROLLBACK
[0m08:07:13.172011 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:13.174062 [debug] [MainThread]: On master: BEGIN
[0m08:07:13.176576 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:07:13.178834 [debug] [MainThread]: On master: COMMIT
[0m08:07:13.180489 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:13.184186 [debug] [MainThread]: On master: COMMIT
[0m08:07:13.186865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:07:13.189202 [debug] [MainThread]: On master: Close
[0m08:07:13.198221 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m08:07:13.200837 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_dates ................................... [RUN]
[0m08:07:13.204470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m08:07:13.207312 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m08:07:13.217626 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m08:07:13.239872 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m08:07:13.290903 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_dates"
[0m08:07:13.311257 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:07:13.313781 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: BEGIN
[0m08:07:13.316031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:13.324731 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:07:13.327477 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:07:13.329998 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */

  create view "medical_insights"."public"."dim_dates__dbt_tmp"
    
    
  as (
    -- models/marts/dim_dates.sql

WITH date_spine AS (
    SELECT
        GENERATE_SERIES(
            '2023-01-01'::DATE,
            CURRENT_DATE + INTERVAL '1 year',
            '1 day'::INTERVAL
        )::DATE AS date_day
),

date_attributes AS (
    SELECT
        date_day,
        EXTRACT(YEAR FROM date_day) AS year,
        EXTRACT(MONTH FROM date_day) AS month,
        TO_CHAR(date_day, 'Month') AS month_name,
        EXTRACT(DAY FROM date_day) AS day_of_month,
        EXTRACT(DOW FROM date_day) AS day_of_week, -- Sunday = 0, Saturday = 6
        TO_CHAR(date_day, 'Day') AS day_name,
        EXTRACT(DOY FROM date_day) AS day_of_year,
        EXTRACT(WEEK FROM date_day) AS week_of_year,
        EXTRACT(QUARTER FROM date_day) AS quarter_of_year,
        TO_CHAR(date_day, 'YYYY-MM') AS year_month,
        TO_CHAR(date_day, 'YYYY-MM-DD') AS full_date_string,
        (CASE WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE ELSE FALSE END) AS is_weekend
    FROM date_spine
)

SELECT *
FROM date_attributes
  );
[0m08:07:13.358331 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m08:07:13.370874 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:07:13.376411 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m08:07:13.380571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:07:13.387470 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:07:13.390134 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m08:07:13.393021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:07:13.417646 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m08:07:13.421273 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:07:13.423193 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m08:07:13.428103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:07:13.441121 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_dates__dbt_backup"
[0m08:07:13.448660 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:07:13.450689 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
drop view if exists "medical_insights"."public"."dim_dates__dbt_backup" cascade
[0m08:07:13.457585 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m08:07:13.462600 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: Close
[0m08:07:13.467069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ad8877c0>]}
[0m08:07:13.469848 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_dates .............................. [[32mCREATE VIEW[0m in 0.26s]
[0m08:07:13.474216 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m08:07:13.476705 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_image_detections
[0m08:07:13.479473 [info ] [Thread-1 (]: 2 of 5 START sql view model public.fct_image_detections ........................ [RUN]
[0m08:07:13.482781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.fct_image_detections)
[0m08:07:13.485237 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_image_detections
[0m08:07:13.491788 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_image_detections"
[0m08:07:13.518884 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_image_detections
[0m08:07:13.527778 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_image_detections"
[0m08:07:13.554841 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:07:13.557820 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: BEGIN
[0m08:07:13.560161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:13.567937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:07:13.570831 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:07:13.573508 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */

  create view "medical_insights"."public"."fct_image_detections__dbt_tmp"
    
    
  as (
    -- models/marts/fct_image_detections.sql

SELECT
    md5(concat(message_id::text, object_class, detection_time::text)) AS detection_pk, -- surrogate key
    message_id,
    image_id,
    object_class,
    confidence_score,
    detection_time
FROM (
    VALUES
        (NULL, NULL, NULL, NULL, NULL) -- Placeholder row, to be replaced by enrichment process
) AS t(message_id, image_id, object_class, confidence_score, detection_time)
WHERE message_id IS NOT NULL
  );
[0m08:07:13.578218 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:07:13.584557 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:07:13.587495 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m08:07:13.590569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:07:13.596939 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:07:13.599345 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m08:07:13.602294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:07:13.606706 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m08:07:13.609021 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:07:13.611446 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m08:07:13.616061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:07:13.624727 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_image_detections__dbt_backup"
[0m08:07:13.627958 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:07:13.630469 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
drop view if exists "medical_insights"."public"."fct_image_detections__dbt_backup" cascade
[0m08:07:13.638888 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m08:07:13.644041 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: Close
[0m08:07:13.647510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65af35ffd0>]}
[0m08:07:13.650403 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.fct_image_detections ................... [[32mCREATE VIEW[0m in 0.16s]
[0m08:07:13.653739 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_image_detections
[0m08:07:13.656665 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m08:07:13.659633 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m08:07:13.662340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.fct_image_detections, now model.medical_dbt.stg_telegram_messages)
[0m08:07:13.664440 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m08:07:13.670229 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m08:07:13.689430 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m08:07:13.698924 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.stg_telegram_messages"
[0m08:07:13.720132 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:07:13.722391 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: BEGIN
[0m08:07:13.724402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:13.730970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:07:13.733079 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:07:13.735078 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */

  create view "medical_insights"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

WITH raw_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        data AS raw_data,
        scraped_at
    FROM "medical_insights"."raw"."telegram_messages"
),

cleaned_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        scraped_at,
        raw_data->>'message' AS message_text,
        (raw_data->>'date')::TIMESTAMP AS message_date,
        (raw_data->>'views')::INT AS views_count,
        (raw_data->>'forwards')::INT AS forwards_count,
        (raw_data->'replies'->>'replies') AS replies_count, -- Fixed extraction for replies_count
        (raw_data->>'reactions') IS NOT NULL AS has_reactions,
        (raw_data->>'photo') IS NOT NULL AS has_photo,
        -- Extract product mentions (enhanced regex for Ethiopian context)
        REGEXP_MATCHES(
            raw_data->>'message',
            '(?i)(paracetamol|amoxicillin|ibuprofen|diclofenac|metronidazole|coartem|albendazole|ORS|syrup|tablet|capsule|suspension|injection|vaccine|antimalarial|antibiotic|antifungal|antiviral|cream|pill)s?',
            'g'
        ) AS product_mentions
    FROM raw_messages
    WHERE raw_data->>'message' IS NOT NULL OR raw_data->>'photo' IS NOT NULL
),

deduped_messages AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY channel_name, message_id ORDER BY scraped_at ASC) AS rn
    FROM cleaned_messages
)

SELECT
    id,
    channel_name,
    message_id,
    message_text,
    message_date,
    COALESCE(views_count, 0) AS views_count,
    COALESCE(forwards_count, 0) AS forwards_count,
    COALESCE(replies_count::INT, 0) AS replies_count,
    has_reactions,
    has_photo,
    product_mentions,
    scraped_at,
    channel_message_unique
FROM deduped_messages
WHERE rn = 1
  );
[0m08:07:13.740331 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "channel_message_unique" does not exist
LINE 61:     channel_message_unique
             ^

[0m08:07:13.743594 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: ROLLBACK
[0m08:07:13.747297 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: Close
[0m08:07:13.759262 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  column "channel_message_unique" does not exist
  LINE 61:     channel_message_unique
               ^
  compiled code at target/run/medical_dbt/models/staging/stg_telegram_messages.sql
[0m08:07:13.762313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5375f418-612f-4b90-9df6-e15b52f9d415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65af35ffd0>]}
[0m08:07:13.765078 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.stg_telegram_messages .............. [[31mERROR[0m in 0.10s]
[0m08:07:13.767629 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m08:07:13.770048 [debug] [Thread-4 (]: Marking all children of 'model.medical_dbt.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  column "channel_message_unique" does not exist
  LINE 61:     channel_message_unique
               ^
  compiled code at target/run/medical_dbt/models/staging/stg_telegram_messages.sql.
[0m08:07:13.773571 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m08:07:13.776669 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.dim_channels ....................................... [[33mSKIP[0m]
[0m08:07:13.778818 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m08:07:13.782241 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m08:07:13.784740 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fct_messages ....................................... [[33mSKIP[0m]
[0m08:07:13.786873 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m08:07:13.790837 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:13.793052 [debug] [MainThread]: On master: BEGIN
[0m08:07:13.795406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:07:13.803030 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:07:13.805603 [debug] [MainThread]: On master: COMMIT
[0m08:07:13.807365 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:13.809940 [debug] [MainThread]: On master: COMMIT
[0m08:07:13.813076 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:07:13.815338 [debug] [MainThread]: On master: Close
[0m08:07:13.818013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:13.819879 [debug] [MainThread]: Connection 'model.medical_dbt.stg_telegram_messages' was properly closed.
[0m08:07:13.822095 [info ] [MainThread]: 
[0m08:07:13.825068 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m08:07:13.828980 [debug] [MainThread]: Command end result
[0m08:07:13.925549 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:07:13.939368 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:07:13.960892 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m08:07:13.963332 [info ] [MainThread]: 
[0m08:07:13.965207 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:07:13.967427 [info ] [MainThread]: 
[0m08:07:13.969886 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)[0m
[0m08:07:13.972298 [error] [MainThread]:   Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  column "channel_message_unique" does not exist
  LINE 61:     channel_message_unique
               ^
  compiled code at target/run/medical_dbt/models/staging/stg_telegram_messages.sql
[0m08:07:13.974397 [info ] [MainThread]: 
[0m08:07:13.976087 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/staging/stg_telegram_messages.sql
[0m08:07:13.977737 [info ] [MainThread]: 
[0m08:07:13.980198 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m08:07:14.002376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5954607, "process_in_blocks": "95752", "process_kernel_time": 0.273968, "process_mem_max_rss": "127672", "process_out_blocks": "0", "process_user_time": 4.099383}
[0m08:07:14.005397 [debug] [MainThread]: Command `dbt run` failed at 08:07:14.005129 after 3.60 seconds
[0m08:07:14.007459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ac2a7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aafe8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65abf510c0>]}
[0m08:07:14.009936 [debug] [MainThread]: Flushing usage events
[0m08:07:15.046523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:08:55.136745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605e72f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605d4969b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605d496950>]}


============================== 08:08:55.146504 | edb59b61-674e-4563-9785-0dd0bfa05c7a ==============================
[0m08:08:55.146504 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:08:55.150177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/src/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/src/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:08:55.599346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605d477160>]}
[0m08:08:55.691025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605d63c8b0>]}
[0m08:08:55.694854 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:08:55.795976 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:08:56.667691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:08:56.671917 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/stg_telegram_messages.sql
[0m08:08:57.423658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605831d3f0>]}
[0m08:08:57.600328 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:08:57.636831 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:08:57.695628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605831c670>]}
[0m08:08:57.700038 [info ] [MainThread]: Found 5 models, 19 data tests, 1 source, 433 macros
[0m08:08:57.703370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605831c640>]}
[0m08:08:57.709435 [info ] [MainThread]: 
[0m08:08:57.712420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:08:57.715164 [info ] [MainThread]: 
[0m08:08:57.718237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:08:57.725773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights'
[0m08:08:57.772226 [debug] [ThreadPool]: Using postgres connection "list_medical_insights"
[0m08:08:57.774894 [debug] [ThreadPool]: On list_medical_insights: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights"} */

    select distinct nspname from pg_namespace
  
[0m08:08:57.777365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:08:57.810284 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m08:08:57.814373 [debug] [ThreadPool]: On list_medical_insights: Close
[0m08:08:57.820380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_insights, now list_medical_insights_public)
[0m08:08:57.832895 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:08:57.836862 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m08:08:57.839109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:08:57.845903 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:08:57.848205 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:08:57.851300 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:08:57.858204 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m08:08:57.862254 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m08:08:57.864687 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m08:08:57.874270 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:57.876670 [debug] [MainThread]: On master: BEGIN
[0m08:08:57.878816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:08:57.886398 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:08:57.889059 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:57.891794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:08:57.902960 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m08:08:57.907779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60583aded0>]}
[0m08:08:57.910183 [debug] [MainThread]: On master: ROLLBACK
[0m08:08:57.913056 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:57.915402 [debug] [MainThread]: On master: BEGIN
[0m08:08:57.919422 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:08:57.922039 [debug] [MainThread]: On master: COMMIT
[0m08:08:57.924421 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:57.926677 [debug] [MainThread]: On master: COMMIT
[0m08:08:57.929215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:08:57.932318 [debug] [MainThread]: On master: Close
[0m08:08:57.942489 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m08:08:57.945294 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_dates ................................... [RUN]
[0m08:08:57.949249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m08:08:57.952190 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m08:08:57.963161 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m08:08:57.993080 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m08:08:58.048209 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_dates"
[0m08:08:58.077008 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:08:58.079839 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: BEGIN
[0m08:08:58.082573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:08:58.090572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:08:58.093158 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:08:58.096240 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */

  create view "medical_insights"."public"."dim_dates__dbt_tmp"
    
    
  as (
    -- models/marts/dim_dates.sql

WITH date_spine AS (
    SELECT
        GENERATE_SERIES(
            '2023-01-01'::DATE,
            CURRENT_DATE + INTERVAL '1 year',
            '1 day'::INTERVAL
        )::DATE AS date_day
),

date_attributes AS (
    SELECT
        date_day,
        EXTRACT(YEAR FROM date_day) AS year,
        EXTRACT(MONTH FROM date_day) AS month,
        TO_CHAR(date_day, 'Month') AS month_name,
        EXTRACT(DAY FROM date_day) AS day_of_month,
        EXTRACT(DOW FROM date_day) AS day_of_week, -- Sunday = 0, Saturday = 6
        TO_CHAR(date_day, 'Day') AS day_name,
        EXTRACT(DOY FROM date_day) AS day_of_year,
        EXTRACT(WEEK FROM date_day) AS week_of_year,
        EXTRACT(QUARTER FROM date_day) AS quarter_of_year,
        TO_CHAR(date_day, 'YYYY-MM') AS year_month,
        TO_CHAR(date_day, 'YYYY-MM-DD') AS full_date_string,
        (CASE WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE ELSE FALSE END) AS is_weekend
    FROM date_spine
)

SELECT *
FROM date_attributes
  );
[0m08:08:58.105966 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:08:58.120741 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:08:58.123897 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates" rename to "dim_dates__dbt_backup"
[0m08:08:58.127720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:08:58.136986 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:08:58.139732 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m08:08:58.142826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:08:58.162780 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m08:08:58.165548 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:08:58.168535 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m08:08:58.172728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:08:58.180217 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_dates__dbt_backup"
[0m08:08:58.188826 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m08:08:58.191302 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
drop view if exists "medical_insights"."public"."dim_dates__dbt_backup" cascade
[0m08:08:58.196254 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m08:08:58.201448 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: Close
[0m08:08:58.207171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605fd1b790>]}
[0m08:08:58.209795 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_dates .............................. [[32mCREATE VIEW[0m in 0.26s]
[0m08:08:58.212052 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m08:08:58.214893 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_image_detections
[0m08:08:58.218702 [info ] [Thread-1 (]: 2 of 5 START sql view model public.fct_image_detections ........................ [RUN]
[0m08:08:58.222069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.fct_image_detections)
[0m08:08:58.224364 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_image_detections
[0m08:08:58.228754 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_image_detections"
[0m08:08:58.256330 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_image_detections
[0m08:08:58.267623 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_image_detections"
[0m08:08:58.292892 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:08:58.295521 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: BEGIN
[0m08:08:58.298619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:08:58.307382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:08:58.310756 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:08:58.314003 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */

  create view "medical_insights"."public"."fct_image_detections__dbt_tmp"
    
    
  as (
    -- models/marts/fct_image_detections.sql

SELECT
    md5(concat(message_id::text, object_class, detection_time::text)) AS detection_pk, -- surrogate key
    message_id,
    image_id,
    object_class,
    confidence_score,
    detection_time
FROM (
    VALUES
        (NULL, NULL, NULL, NULL, NULL) -- Placeholder row, to be replaced by enrichment process
) AS t(message_id, image_id, object_class, confidence_score, detection_time)
WHERE message_id IS NOT NULL
  );
[0m08:08:58.318636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:08:58.325315 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:08:58.328198 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m08:08:58.332162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:08:58.338348 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:08:58.340709 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m08:08:58.346817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:08:58.353139 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m08:08:58.355999 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:08:58.358069 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m08:08:58.382023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m08:08:58.388549 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_image_detections__dbt_backup"
[0m08:08:58.391839 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m08:08:58.394574 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
drop view if exists "medical_insights"."public"."fct_image_detections__dbt_backup" cascade
[0m08:08:58.399699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m08:08:58.404670 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: Close
[0m08:08:58.407932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605bb51a80>]}
[0m08:08:58.410568 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.fct_image_detections ................... [[32mCREATE VIEW[0m in 0.19s]
[0m08:08:58.412807 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_image_detections
[0m08:08:58.415123 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m08:08:58.417482 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m08:08:58.420538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.fct_image_detections, now model.medical_dbt.stg_telegram_messages)
[0m08:08:58.422965 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m08:08:58.430241 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.459406 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m08:08:58.466891 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.491883 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.494626 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: BEGIN
[0m08:08:58.496815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:08:58.504491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:08:58.507217 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.509643 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */

  create view "medical_insights"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

WITH raw_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        data AS raw_data,
        scraped_at
    FROM "medical_insights"."raw"."telegram_messages"
),

cleaned_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        scraped_at,
        raw_data->>'message' AS message_text,
        (raw_data->>'date')::TIMESTAMP AS message_date,
        (raw_data->>'views')::INT AS views_count,
        (raw_data->>'forwards')::INT AS forwards_count,
        (raw_data->'replies'->>'replies') AS replies_count, -- Fixed extraction for replies_count
        (raw_data->>'reactions') IS NOT NULL AS has_reactions,
        (raw_data->>'photo') IS NOT NULL AS has_photo,
        -- Extract product mentions (enhanced regex for Ethiopian context)
        REGEXP_MATCHES(
            raw_data->>'message',
            '(?i)(paracetamol|amoxicillin|ibuprofen|diclofenac|metronidazole|coartem|albendazole|ORS|syrup|tablet|capsule|suspension|injection|vaccine|antimalarial|antibiotic|antifungal|antiviral|cream|pill)s?',
            'g'
        ) AS product_mentions,
        channel_name || '-' || message_id AS channel_message_unique
    FROM raw_messages
    WHERE raw_data->>'message' IS NOT NULL OR raw_data->>'photo' IS NOT NULL
),

deduped_messages AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY channel_name, message_id ORDER BY scraped_at ASC) AS rn
    FROM cleaned_messages
)

SELECT
    id,
    channel_name,
    message_id,
    message_text,
    message_date,
    COALESCE(views_count, 0) AS views_count,
    COALESCE(forwards_count, 0) AS forwards_count,
    COALESCE(replies_count::INT, 0) AS replies_count,
    has_reactions,
    has_photo,
    product_mentions,
    scraped_at,
    channel_message_unique
FROM deduped_messages
WHERE rn = 1
  );
[0m08:08:58.515216 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:08:58.524650 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.527025 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m08:08:58.529871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:08:58.558410 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.562370 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m08:08:58.566483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:08:58.571843 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m08:08:58.575398 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.579183 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m08:08:58.587001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:08:58.595033 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."stg_telegram_messages__dbt_backup"
[0m08:08:58.599604 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m08:08:58.602488 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
drop view if exists "medical_insights"."public"."stg_telegram_messages__dbt_backup" cascade
[0m08:08:58.609975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m08:08:58.615163 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: Close
[0m08:08:58.618656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6009c259f0>]}
[0m08:08:58.621732 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 0.20s]
[0m08:08:58.624463 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m08:08:58.628138 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m08:08:58.630891 [info ] [Thread-1 (]: 4 of 5 START sql view model public.dim_channels ................................ [RUN]
[0m08:08:58.633442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.stg_telegram_messages, now model.medical_dbt.dim_channels)
[0m08:08:58.636949 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_channels
[0m08:08:58.642745 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_channels"
[0m08:08:58.672417 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_channels
[0m08:08:58.680756 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_channels"
[0m08:08:58.714104 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:08:58.718557 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: BEGIN
[0m08:08:58.721592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:08:58.730069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:08:58.733091 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:08:58.736000 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */

  create view "medical_insights"."public"."dim_channels__dbt_tmp"
    
    
  as (
    -- models/marts/dim_channels.sql

SELECT DISTINCT
    channel_name,
    MD5(channel_name) AS channel_sk -- Surrogate key for channel
FROM "medical_insights"."public"."stg_telegram_messages"
  );
[0m08:08:58.741189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:08:58.749961 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:08:58.752152 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
alter table "medical_insights"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m08:08:58.755955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:08:58.759923 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m08:08:58.763922 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:08:58.768339 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m08:08:58.772906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:08:58.780030 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_channels__dbt_backup"
[0m08:08:58.783568 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m08:08:58.789307 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
drop view if exists "medical_insights"."public"."dim_channels__dbt_backup" cascade
[0m08:08:58.792504 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:08:58.796420 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: Close
[0m08:08:58.799399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6009c271c0>]}
[0m08:08:58.802154 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.dim_channels ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m08:08:58.805047 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m08:08:58.808966 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m08:08:58.811337 [info ] [Thread-1 (]: 5 of 5 START sql view model public.fct_messages ................................ [RUN]
[0m08:08:58.816403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_channels, now model.medical_dbt.fct_messages)
[0m08:08:58.819212 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_messages
[0m08:08:58.826024 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_messages"
[0m08:08:58.854530 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_messages
[0m08:08:58.867115 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_messages"
[0m08:08:58.895084 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:08:58.897945 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: BEGIN
[0m08:08:58.900189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:08:58.908021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:08:58.910616 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:08:58.913029 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */

  create view "medical_insights"."public"."fct_messages__dbt_tmp"
    
    
  as (
    -- models/marts/fct_messages.sql

WITH stg_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        message_text,
        message_date,
        views_count,
        forwards_count,
        replies_count,
        has_reactions,
        has_photo,
        product_mentions,
        scraped_at
    FROM "medical_insights"."public"."stg_telegram_messages"
),

channels AS (
    SELECT
        channel_name,
        channel_sk
    FROM "medical_insights"."public"."dim_channels"
),

dates AS (
    SELECT
        date_day,
        year,
        month,
        day_of_month
    FROM "medical_insights"."public"."dim_dates"
)

SELECT
    sm.id AS message_pk,
    sm.message_id,
    sm.message_text,
    LENGTH(sm.message_text) AS message_length,
    sm.message_date,
    sm.views_count,
    sm.forwards_count,
    sm.replies_count,
    sm.has_reactions,
    sm.has_photo,
    sm.product_mentions,
    sm.scraped_at,
    c.channel_sk,
    d.date_day AS message_date_key
FROM stg_messages sm
LEFT JOIN channels c ON sm.channel_name = c.channel_name
LEFT JOIN dates d ON sm.message_date::DATE = d.date_day
  );
[0m08:08:58.919207 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:08:58.926780 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:08:58.929653 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
alter table "medical_insights"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m08:08:58.933136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:08:58.938485 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m08:08:58.941190 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:08:58.943702 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m08:08:58.949163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:08:58.955018 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_messages__dbt_backup"
[0m08:08:58.957710 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m08:08:58.959825 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
drop view if exists "medical_insights"."public"."fct_messages__dbt_backup" cascade
[0m08:08:58.962285 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:08:58.967148 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: Close
[0m08:08:58.970042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edb59b61-674e-4563-9785-0dd0bfa05c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6009c5c130>]}
[0m08:08:58.972259 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.fct_messages ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m08:08:58.974219 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m08:08:58.977461 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:58.979276 [debug] [MainThread]: On master: BEGIN
[0m08:08:58.980825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:08:58.986363 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:08:58.988490 [debug] [MainThread]: On master: COMMIT
[0m08:08:58.990141 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:58.991596 [debug] [MainThread]: On master: COMMIT
[0m08:08:58.993729 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:08:58.995337 [debug] [MainThread]: On master: Close
[0m08:08:58.996804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:08:58.998240 [debug] [MainThread]: Connection 'model.medical_dbt.fct_messages' was properly closed.
[0m08:08:58.999940 [info ] [MainThread]: 
[0m08:08:59.001393 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m08:08:59.004709 [debug] [MainThread]: Command end result
[0m08:08:59.064881 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:08:59.074012 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:08:59.092299 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m08:08:59.094631 [info ] [MainThread]: 
[0m08:08:59.096744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:08:59.098684 [info ] [MainThread]: 
[0m08:08:59.100611 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m08:08:59.122933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1615586, "process_in_blocks": "95312", "process_kernel_time": 0.256515, "process_mem_max_rss": "125964", "process_out_blocks": "0", "process_user_time": 4.035188}
[0m08:08:59.125253 [debug] [MainThread]: Command `dbt run` succeeded at 08:08:59.125061 after 4.16 seconds
[0m08:08:59.127626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605e72f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605b359780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f605d477160>]}
[0m08:08:59.129582 [debug] [MainThread]: Flushing usage events
[0m08:09:00.299507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:22.953972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2a9c79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2970aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2970ae90>]}


============================== 08:10:22.963623 | e82ccef3-4380-42ce-b7ab-46627c6ee17f ==============================
[0m08:10:22.963623 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:10:22.966743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/src/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --project-dir /app/src/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:10:23.412169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e82ccef3-4380-42ce-b7ab-46627c6ee17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f29117310>]}
[0m08:10:23.507167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e82ccef3-4380-42ce-b7ab-46627c6ee17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f29f4d7e0>]}
[0m08:10:23.512053 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:10:23.618691 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:10:24.335721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:10:24.338158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:10:24.406367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e82ccef3-4380-42ce-b7ab-46627c6ee17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f27ded870>]}
[0m08:10:24.681355 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:10:24.716807 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:10:24.805049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e82ccef3-4380-42ce-b7ab-46627c6ee17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f27d1e560>]}
[0m08:10:24.807445 [info ] [MainThread]: Found 5 models, 19 data tests, 1 source, 433 macros
[0m08:10:24.809984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82ccef3-4380-42ce-b7ab-46627c6ee17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f27d1c2b0>]}
[0m08:10:24.815098 [info ] [MainThread]: 
[0m08:10:24.817179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:10:24.819015 [info ] [MainThread]: 
[0m08:10:24.821723 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:10:24.833034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights_public'
[0m08:10:24.899640 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:10:24.902441 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m08:10:24.905181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:10:24.934080 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m08:10:24.937053 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:10:24.939120 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:10:24.958806 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m08:10:24.963498 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m08:10:24.965735 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m08:10:24.975933 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:24.978361 [debug] [MainThread]: On master: BEGIN
[0m08:10:24.980354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:10:24.986653 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:10:24.988979 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:24.991659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:10:25.003446 [debug] [MainThread]: SQL status: SELECT 5 in 0.010 seconds
[0m08:10:25.008089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e82ccef3-4380-42ce-b7ab-46627c6ee17f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f27dfc4f0>]}
[0m08:10:25.010262 [debug] [MainThread]: On master: ROLLBACK
[0m08:10:25.012630 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:25.014403 [debug] [MainThread]: On master: BEGIN
[0m08:10:25.016533 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:10:25.018699 [debug] [MainThread]: On master: COMMIT
[0m08:10:25.021127 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:25.023148 [debug] [MainThread]: On master: COMMIT
[0m08:10:25.025445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:10:25.027445 [debug] [MainThread]: On master: Close
[0m08:10:25.035482 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:10:25.037243 [info ] [Thread-1 (]: 1 of 19 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m08:10:25.039153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m08:10:25.040720 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:10:25.065947 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:10:25.086523 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:10:25.110624 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:10:25.129361 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:10:25.131558 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: BEGIN
[0m08:10:25.133445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.138553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:10:25.140015 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:10:25.141526 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_insights"."public"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.144987 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:10:25.151288 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m08:10:25.153698 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m08:10:25.155791 [info ] [Thread-1 (]: 1 of 19 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.12s]
[0m08:10:25.158103 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:10:25.160187 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:10:25.161612 [info ] [Thread-1 (]: 2 of 19 START test not_null_dim_channels_channel_sk ............................ [RUN]
[0m08:10:25.163285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac)
[0m08:10:25.164864 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:10:25.171432 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:10:25.188372 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:10:25.193353 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:10:25.209654 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:10:25.211613 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: BEGIN
[0m08:10:25.213158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.218099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:10:25.219588 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:10:25.221126 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."dim_channels"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.224298 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:10:25.227240 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: ROLLBACK
[0m08:10:25.229249 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac: Close
[0m08:10:25.231047 [info ] [Thread-1 (]: 2 of 19 PASS not_null_dim_channels_channel_sk .................................. [[32mPASS[0m in 0.07s]
[0m08:10:25.232684 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:10:25.234180 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:10:25.235662 [info ] [Thread-1 (]: 3 of 19 START test not_null_dim_dates_date_day ................................. [RUN]
[0m08:10:25.237461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac, now test.medical_dbt.not_null_dim_dates_date_day.1717af99fb)
[0m08:10:25.239774 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:10:25.246417 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:10:25.262684 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:10:25.267781 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:10:25.287377 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:10:25.289329 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: BEGIN
[0m08:10:25.291032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.296556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:10:25.298288 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:10:25.300096 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "medical_insights"."public"."dim_dates"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.304138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:10:25.307027 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: ROLLBACK
[0m08:10:25.308986 [debug] [Thread-1 (]: On test.medical_dbt.not_null_dim_dates_date_day.1717af99fb: Close
[0m08:10:25.311249 [info ] [Thread-1 (]: 3 of 19 PASS not_null_dim_dates_date_day ....................................... [[32mPASS[0m in 0.07s]
[0m08:10:25.312869 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:10:25.314136 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:10:25.315624 [info ] [Thread-1 (]: 4 of 19 START test not_null_fct_image_detections_detection_pk .................. [RUN]
[0m08:10:25.317130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_dates_date_day.1717af99fb, now test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6)
[0m08:10:25.318526 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:10:25.326032 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:10:25.339627 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:10:25.344390 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:10:25.361052 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:10:25.363248 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: BEGIN
[0m08:10:25.365186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.370296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:10:25.372023 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:10:25.374115 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select detection_pk
from "medical_insights"."public"."fct_image_detections"
where detection_pk is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.376793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:10:25.379962 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: ROLLBACK
[0m08:10:25.381967 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6: Close
[0m08:10:25.384199 [info ] [Thread-1 (]: 4 of 19 PASS not_null_fct_image_detections_detection_pk ........................ [[32mPASS[0m in 0.07s]
[0m08:10:25.385951 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:10:25.387744 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:10:25.389303 [info ] [Thread-1 (]: 5 of 19 START test not_null_fct_image_detections_message_id .................... [RUN]
[0m08:10:25.391726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6, now test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8)
[0m08:10:25.394148 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:10:25.400624 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:10:25.421314 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:10:25.427946 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:10:25.451227 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:10:25.453402 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: BEGIN
[0m08:10:25.455575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.462805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:10:25.465561 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:10:25.467774 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_image_detections"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.470637 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:10:25.474078 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: ROLLBACK
[0m08:10:25.476444 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8: Close
[0m08:10:25.479122 [info ] [Thread-1 (]: 5 of 19 PASS not_null_fct_image_detections_message_id .......................... [[32mPASS[0m in 0.09s]
[0m08:10:25.481384 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:10:25.483250 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:10:25.485858 [info ] [Thread-1 (]: 6 of 19 START test not_null_fct_image_detections_object_class .................. [RUN]
[0m08:10:25.487818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8, now test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24)
[0m08:10:25.489591 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:10:25.496513 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:10:25.520692 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:10:25.526359 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:10:25.547031 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:10:25.548800 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: BEGIN
[0m08:10:25.550206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.555440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:10:25.557090 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:10:25.558807 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select object_class
from "medical_insights"."public"."fct_image_detections"
where object_class is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.561500 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:10:25.564835 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: ROLLBACK
[0m08:10:25.566693 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24: Close
[0m08:10:25.568514 [info ] [Thread-1 (]: 6 of 19 PASS not_null_fct_image_detections_object_class ........................ [[32mPASS[0m in 0.08s]
[0m08:10:25.570462 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:10:25.571946 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:10:25.573399 [info ] [Thread-1 (]: 7 of 19 START test not_null_fct_messages_channel_sk ............................ [RUN]
[0m08:10:25.576244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24, now test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3)
[0m08:10:25.577676 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:10:25.584394 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:10:25.598236 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:10:25.602689 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:10:25.617148 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:10:25.618701 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: BEGIN
[0m08:10:25.621086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.625692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:10:25.627216 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:10:25.628573 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_sk
from "medical_insights"."public"."fct_messages"
where channel_sk is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.753665 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.124 seconds
[0m08:10:25.760577 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: ROLLBACK
[0m08:10:25.763312 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3: Close
[0m08:10:25.765874 [info ] [Thread-1 (]: 7 of 19 PASS not_null_fct_messages_channel_sk .................................. [[32mPASS[0m in 0.19s]
[0m08:10:25.769096 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:10:25.771674 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:10:25.776260 [info ] [Thread-1 (]: 8 of 19 START test not_null_fct_messages_message_date_key ...................... [RUN]
[0m08:10:25.779829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3, now test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3)
[0m08:10:25.781933 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:10:25.791746 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:10:25.832495 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:10:25.838712 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:10:25.865585 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:10:25.867662 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: BEGIN
[0m08:10:25.869583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:25.875994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:10:25.878721 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:10:25.881944 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date_key
from "medical_insights"."public"."fct_messages"
where message_date_key is null



  
  
      
    ) dbt_internal_test
[0m08:10:25.996505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.112 seconds
[0m08:10:25.999847 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: ROLLBACK
[0m08:10:26.002393 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3: Close
[0m08:10:26.005018 [error] [Thread-1 (]: 8 of 19 FAIL 1 not_null_fct_messages_message_date_key .......................... [[31mFAIL 1[0m in 0.23s]
[0m08:10:26.007166 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:10:26.008790 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:10:26.010712 [info ] [Thread-1 (]: 9 of 19 START test not_null_fct_messages_message_id ............................ [RUN]
[0m08:10:26.012676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3, now test.medical_dbt.not_null_fct_messages_message_id.de346706b5)
[0m08:10:26.014593 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:10:26.021956 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:10:26.036724 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:10:26.042049 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:10:26.058240 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:10:26.060431 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: BEGIN
[0m08:10:26.062266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:26.069946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:10:26.071779 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:10:26.074683 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m08:10:26.119719 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m08:10:26.123842 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m08:10:26.126490 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_id.de346706b5: Close
[0m08:10:26.129134 [info ] [Thread-1 (]: 9 of 19 PASS not_null_fct_messages_message_id .................................. [[32mPASS[0m in 0.12s]
[0m08:10:26.130751 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:10:26.132285 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:10:26.134549 [info ] [Thread-1 (]: 10 of 19 START test not_null_fct_messages_message_pk ........................... [RUN]
[0m08:10:26.136313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_id.de346706b5, now test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec)
[0m08:10:26.137843 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:10:26.144316 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:10:26.162540 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:10:26.167437 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:10:26.183274 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:10:26.185017 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: BEGIN
[0m08:10:26.186784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:26.193576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:10:26.195547 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:10:26.197570 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_insights"."public"."fct_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m08:10:26.245851 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m08:10:26.250870 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: ROLLBACK
[0m08:10:26.254067 [debug] [Thread-1 (]: On test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec: Close
[0m08:10:26.256982 [info ] [Thread-1 (]: 10 of 19 PASS not_null_fct_messages_message_pk ................................. [[32mPASS[0m in 0.12s]
[0m08:10:26.260540 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:10:26.263122 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:10:26.265480 [info ] [Thread-1 (]: 11 of 19 START test not_null_stg_telegram_messages_id .......................... [RUN]
[0m08:10:26.267762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec, now test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m08:10:26.271808 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:10:26.281386 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:10:26.303476 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:10:26.310766 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:10:26.328856 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:10:26.330950 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: BEGIN
[0m08:10:26.332756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:26.338010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:10:26.340281 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:10:26.342000 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "medical_insights"."public"."stg_telegram_messages"
where id is null



  
  
      
    ) dbt_internal_test
[0m08:10:26.385716 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.041 seconds
[0m08:10:26.389630 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: ROLLBACK
[0m08:10:26.392890 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317: Close
[0m08:10:26.396098 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stg_telegram_messages_id ................................ [[32mPASS[0m in 0.13s]
[0m08:10:26.398457 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:10:26.400399 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:10:26.402267 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_telegram_messages_message_id .................. [RUN]
[0m08:10:26.404397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m08:10:26.406134 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:10:26.416265 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:10:26.439919 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:10:26.445942 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:10:26.469619 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:10:26.472052 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: BEGIN
[0m08:10:26.474426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:26.481984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:10:26.487310 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:10:26.489682 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_insights"."public"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m08:10:26.494280 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m08:10:26.498682 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m08:10:26.501331 [debug] [Thread-1 (]: On test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m08:10:26.504028 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_telegram_messages_message_id ........................ [[32mPASS[0m in 0.10s]
[0m08:10:26.506942 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:10:26.509392 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:10:26.511682 [info ] [Thread-1 (]: 13 of 19 START test relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [RUN]
[0m08:10:26.513907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241)
[0m08:10:26.516584 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:10:26.534087 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:10:26.561717 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:10:26.567289 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:10:26.586724 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:10:26.589598 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: BEGIN
[0m08:10:26.592832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:26.599621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:10:26.601572 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:10:26.602992 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_sk as from_field
    from "medical_insights"."public"."fct_messages"
    where channel_sk is not null
),

parent as (
    select channel_sk as to_field
    from "medical_insights"."public"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m08:10:26.735735 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.131 seconds
[0m08:10:26.739729 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: ROLLBACK
[0m08:10:26.742233 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241: Close
[0m08:10:26.744929 [info ] [Thread-1 (]: 13 of 19 PASS relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_  [[32mPASS[0m in 0.23s]
[0m08:10:26.747433 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:10:26.749426 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:10:26.751465 [info ] [Thread-1 (]: 14 of 19 START test relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [RUN]
[0m08:10:26.754051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241, now test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1)
[0m08:10:26.756780 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:10:26.766251 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:10:26.789813 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:10:26.797012 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:10:26.820242 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:10:26.822625 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: BEGIN
[0m08:10:26.825544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:26.833648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:10:26.836310 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:10:26.838738 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select message_date_key as from_field
    from "medical_insights"."public"."fct_messages"
    where message_date_key is not null
),

parent as (
    select date_day as to_field
    from "medical_insights"."public"."dim_dates"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m08:10:26.941500 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.100 seconds
[0m08:10:26.946328 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: ROLLBACK
[0m08:10:26.948874 [debug] [Thread-1 (]: On test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1: Close
[0m08:10:26.951665 [info ] [Thread-1 (]: 14 of 19 PASS relationships_fct_messages_message_date_key__date_day__ref_dim_dates_  [[32mPASS[0m in 0.20s]
[0m08:10:26.954424 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:10:26.957179 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:10:26.959759 [info ] [Thread-1 (]: 15 of 19 START test unique_dim_channels_channel_name ........................... [RUN]
[0m08:10:26.962827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1, now test.medical_dbt.unique_dim_channels_channel_name.e57614abc8)
[0m08:10:26.965096 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:10:26.978367 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:10:27.003364 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:10:27.008997 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:10:27.033958 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:10:27.036116 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: BEGIN
[0m08:10:27.038587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:27.045746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:10:27.048209 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:10:27.050143 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_name as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_name is not null
group by channel_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:10:27.103991 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.052 seconds
[0m08:10:27.109456 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: ROLLBACK
[0m08:10:27.112846 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_name.e57614abc8: Close
[0m08:10:27.115930 [info ] [Thread-1 (]: 15 of 19 PASS unique_dim_channels_channel_name ................................. [[32mPASS[0m in 0.15s]
[0m08:10:27.120410 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:10:27.122609 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:10:27.125916 [info ] [Thread-1 (]: 16 of 19 START test unique_dim_channels_channel_sk ............................. [RUN]
[0m08:10:27.128214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_name.e57614abc8, now test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2)
[0m08:10:27.130665 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:10:27.137497 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:10:27.162641 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:10:27.176741 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:10:27.202291 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:10:27.204569 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: BEGIN
[0m08:10:27.207227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:27.214883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:10:27.217369 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:10:27.219604 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_sk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_channels"
where channel_sk is not null
group by channel_sk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:10:27.268829 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.047 seconds
[0m08:10:27.272820 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: ROLLBACK
[0m08:10:27.275248 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2: Close
[0m08:10:27.278058 [info ] [Thread-1 (]: 16 of 19 PASS unique_dim_channels_channel_sk ................................... [[32mPASS[0m in 0.15s]
[0m08:10:27.280750 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:10:27.282711 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:10:27.284968 [info ] [Thread-1 (]: 17 of 19 START test unique_dim_dates_date_day .................................. [RUN]
[0m08:10:27.287187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2, now test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7)
[0m08:10:27.289038 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:10:27.297165 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:10:27.319558 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:10:27.327531 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:10:27.352586 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:10:27.355327 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: BEGIN
[0m08:10:27.358137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:27.368560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m08:10:27.371750 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:10:27.374450 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "medical_insights"."public"."dim_dates"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:10:27.380783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m08:10:27.385753 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: ROLLBACK
[0m08:10:27.388847 [debug] [Thread-1 (]: On test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7: Close
[0m08:10:27.391997 [info ] [Thread-1 (]: 17 of 19 PASS unique_dim_dates_date_day ........................................ [[32mPASS[0m in 0.10s]
[0m08:10:27.395336 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:10:27.398403 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:10:27.401068 [info ] [Thread-1 (]: 18 of 19 START test unique_fct_image_detections_detection_pk ................... [RUN]
[0m08:10:27.403638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7, now test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de)
[0m08:10:27.406002 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:10:27.414282 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:10:27.448026 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:10:27.457755 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:10:27.491828 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:10:27.494897 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: BEGIN
[0m08:10:27.497666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:27.504978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:10:27.507809 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:10:27.510783 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    detection_pk as unique_field,
    count(*) as n_records

from "medical_insights"."public"."fct_image_detections"
where detection_pk is not null
group by detection_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:10:27.514783 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:10:27.519423 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: ROLLBACK
[0m08:10:27.522232 [debug] [Thread-1 (]: On test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de: Close
[0m08:10:27.525175 [info ] [Thread-1 (]: 18 of 19 PASS unique_fct_image_detections_detection_pk ......................... [[32mPASS[0m in 0.12s]
[0m08:10:27.528441 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:10:27.531336 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:10:27.533886 [info ] [Thread-1 (]: 19 of 19 START test unique_stg_telegram_messages_channel_message_unique ........ [RUN]
[0m08:10:27.536052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de, now test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb)
[0m08:10:27.538823 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:10:27.546803 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:10:27.572992 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:10:27.579552 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:10:27.608587 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:10:27.611840 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: BEGIN
[0m08:10:27.614112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:27.620643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:10:27.623250 [debug] [Thread-1 (]: Using postgres connection "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:10:27.625778 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_message_unique as unique_field,
    count(*) as n_records

from "medical_insights"."public"."stg_telegram_messages"
where channel_message_unique is not null
group by channel_message_unique
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:10:27.679591 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m08:10:27.683432 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: ROLLBACK
[0m08:10:27.685426 [debug] [Thread-1 (]: On test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb: Close
[0m08:10:27.687705 [info ] [Thread-1 (]: 19 of 19 PASS unique_stg_telegram_messages_channel_message_unique .............. [[32mPASS[0m in 0.15s]
[0m08:10:27.690294 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:10:27.694344 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:27.696034 [debug] [MainThread]: On master: BEGIN
[0m08:10:27.697524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:10:27.703360 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:10:27.704899 [debug] [MainThread]: On master: COMMIT
[0m08:10:27.707187 [debug] [MainThread]: Using postgres connection "master"
[0m08:10:27.709119 [debug] [MainThread]: On master: COMMIT
[0m08:10:27.710870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:10:27.712641 [debug] [MainThread]: On master: Close
[0m08:10:27.714658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:10:27.716296 [debug] [MainThread]: Connection 'test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb' was properly closed.
[0m08:10:27.718348 [info ] [MainThread]: 
[0m08:10:27.720488 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m08:10:27.727578 [debug] [MainThread]: Command end result
[0m08:10:27.810641 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:10:27.826008 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:10:27.855735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m08:10:27.858340 [info ] [MainThread]: 
[0m08:10:27.861101 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:10:27.863542 [info ] [MainThread]: 
[0m08:10:27.865572 [error] [MainThread]: [31mFailure in test not_null_fct_messages_message_date_key (models/marts/schema.yml)[0m
[0m08:10:27.867488 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:10:27.869302 [info ] [MainThread]: 
[0m08:10:27.871848 [info ] [MainThread]:   compiled code at target/compiled/medical_dbt/models/marts/schema.yml/not_null_fct_messages_message_date_key.sql
[0m08:10:27.873664 [info ] [MainThread]: 
[0m08:10:27.875378 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=19
[0m08:10:27.897247 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.1129155, "process_in_blocks": "95472", "process_kernel_time": 0.398899, "process_mem_max_rss": "120520", "process_out_blocks": "0", "process_user_time": 3.719736}
[0m08:10:27.899787 [debug] [MainThread]: Command `dbt test` failed at 08:10:27.899516 after 5.12 seconds
[0m08:10:27.901999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2a9c79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f29117310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f27ded450>]}
[0m08:10:27.904292 [debug] [MainThread]: Flushing usage events
[0m08:10:29.001141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:13:56.653454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09801a7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097eeeefe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097eeeef80>]}


============================== 08:13:56.661915 | 881a09a2-4124-4cee-890e-0882f830e0a4 ==============================
[0m08:13:56.661915 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:13:56.663979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/src/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --project-dir /app/src/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:13:57.114040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '881a09a2-4124-4cee-890e-0882f830e0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e8f7100>]}
[0m08:13:57.211771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '881a09a2-4124-4cee-890e-0882f830e0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097f763970>]}
[0m08:13:57.222871 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:13:57.333877 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:13:58.142603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:13:58.145415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:13:58.255387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '881a09a2-4124-4cee-890e-0882f830e0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097d5ed810>]}
[0m08:13:58.349415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '881a09a2-4124-4cee-890e-0882f830e0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097f7bf9a0>]}
[0m08:13:58.353160 [info ] [MainThread]: Found 5 models, 19 data tests, 1 source, 433 macros
[0m08:13:58.356723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881a09a2-4124-4cee-890e-0882f830e0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097f7bd1b0>]}
[0m08:13:58.363721 [info ] [MainThread]: 
[0m08:13:58.366587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:13:58.370591 [info ] [MainThread]: 
[0m08:13:58.374904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:13:58.386648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights_public'
[0m08:13:58.530661 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:13:58.533908 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m08:13:58.537108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:58.566914 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m08:13:58.570589 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m08:13:58.573582 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:13:58.595529 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m08:13:58.600522 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m08:13:58.603874 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m08:13:58.616913 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:58.619558 [debug] [MainThread]: On master: BEGIN
[0m08:13:58.622815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:13:58.632730 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m08:13:58.635905 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:58.638958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:13:58.653812 [debug] [MainThread]: SQL status: SELECT 5 in 0.012 seconds
[0m08:13:58.660820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881a09a2-4124-4cee-890e-0882f830e0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098188b520>]}
[0m08:13:58.663218 [debug] [MainThread]: On master: ROLLBACK
[0m08:13:58.665905 [debug] [MainThread]: On master: Close
[0m08:13:58.676486 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m08:13:58.679816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m08:13:58.682665 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m08:13:58.697887 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m08:13:58.720210 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m08:13:58.723550 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m08:13:58.726267 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_image_detections
[0m08:13:58.728674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.fct_image_detections)
[0m08:13:58.730808 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_image_detections
[0m08:13:58.736802 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_image_detections"
[0m08:13:58.758492 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_image_detections
[0m08:13:58.761622 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_image_detections
[0m08:13:58.763915 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m08:13:58.765896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.fct_image_detections, now model.medical_dbt.stg_telegram_messages)
[0m08:13:58.767990 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m08:13:58.775383 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m08:13:58.796660 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m08:13:58.800554 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m08:13:58.803740 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:13:58.806369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.stg_telegram_messages, now test.medical_dbt.not_null_dim_dates_date_day.1717af99fb)
[0m08:13:58.808148 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:13:58.829725 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m08:13:58.854831 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:13:58.857912 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_dates_date_day.1717af99fb
[0m08:13:58.860390 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:13:58.864602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_dates_date_day.1717af99fb, now test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7)
[0m08:13:58.866978 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:13:58.880766 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m08:13:58.907786 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:13:58.911277 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m08:13:58.913961 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:13:58.916610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_dates_date_day.5e9dfa95c7, now test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6)
[0m08:13:58.919631 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:13:58.929708 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6"
[0m08:13:58.960298 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:13:58.964818 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6
[0m08:13:58.968473 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:13:58.971809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_detection_pk.a28b7b70a6, now test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8)
[0m08:13:58.975566 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:13:58.986059 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8"
[0m08:13:59.019205 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:13:59.022909 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8
[0m08:13:59.025982 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:13:59.031373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_message_id.fccdbca0c8, now test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24)
[0m08:13:59.034453 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:13:59.046792 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24"
[0m08:13:59.080604 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:13:59.084462 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24
[0m08:13:59.087441 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:13:59.089927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_image_detections_object_class.fd8b5f2e24, now test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de)
[0m08:13:59.092705 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:13:59.102071 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de"
[0m08:13:59.131283 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:13:59.134204 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de
[0m08:13:59.136305 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m08:13:59.138541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_fct_image_detections_detection_pk.5cb6d3f8de, now model.medical_dbt.dim_channels)
[0m08:13:59.140957 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_channels
[0m08:13:59.147070 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_channels"
[0m08:13:59.170452 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_channels
[0m08:13:59.173398 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m08:13:59.175010 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:13:59.177380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_channels, now test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317)
[0m08:13:59.181461 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:13:59.189071 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317"
[0m08:13:59.214904 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:13:59.217587 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317
[0m08:13:59.220472 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:13:59.223081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_id.1e7cfdd317, now test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6)
[0m08:13:59.225386 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:13:59.233031 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m08:13:59.255070 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:13:59.258159 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m08:13:59.260232 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:13:59.262470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_stg_telegram_messages_message_id.9b3fea71d6, now test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb)
[0m08:13:59.264388 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:13:59.272950 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb"
[0m08:13:59.299551 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:13:59.304029 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb
[0m08:13:59.307543 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m08:13:59.310385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_stg_telegram_messages_channel_message_unique.abe4de86bb, now model.medical_dbt.fct_messages)
[0m08:13:59.313059 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_messages
[0m08:13:59.321892 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_messages"
[0m08:13:59.351431 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_messages
[0m08:13:59.355403 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m08:13:59.358182 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:13:59.361194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.fct_messages, now test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m08:13:59.363808 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:13:59.374634 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m08:13:59.405943 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:13:59.409133 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b
[0m08:13:59.411725 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:13:59.414100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac)
[0m08:13:59.416344 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:13:59.426883 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac"
[0m08:13:59.456046 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:13:59.459460 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac
[0m08:13:59.461594 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:13:59.463593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_dim_channels_channel_sk.55ca11d3ac, now test.medical_dbt.unique_dim_channels_channel_name.e57614abc8)
[0m08:13:59.465518 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:13:59.473094 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_name.e57614abc8"
[0m08:13:59.498000 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:13:59.501744 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_name.e57614abc8
[0m08:13:59.503976 [debug] [Thread-1 (]: Began running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:13:59.505817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_name.e57614abc8, now test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2)
[0m08:13:59.507960 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:13:59.516531 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2"
[0m08:13:59.538748 [debug] [Thread-1 (]: Began executing node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:13:59.541472 [debug] [Thread-1 (]: Finished running node test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2
[0m08:13:59.543083 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:13:59.544604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.unique_dim_channels_channel_sk.1feb0516d2, now test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3)
[0m08:13:59.546825 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:13:59.553852 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3"
[0m08:13:59.573119 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:13:59.575658 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3
[0m08:13:59.577854 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:13:59.580292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_channel_sk.a1374519a3, now test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3)
[0m08:13:59.582541 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:13:59.589967 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3"
[0m08:13:59.610923 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:13:59.613321 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3
[0m08:13:59.615546 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:13:59.617309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_date_key.33775055f3, now test.medical_dbt.not_null_fct_messages_message_id.de346706b5)
[0m08:13:59.619673 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:13:59.628518 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_id.de346706b5"
[0m08:13:59.651797 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:13:59.655606 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_id.de346706b5
[0m08:13:59.657969 [debug] [Thread-1 (]: Began running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:13:59.660401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_id.de346706b5, now test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec)
[0m08:13:59.662660 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:13:59.674386 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec"
[0m08:13:59.699583 [debug] [Thread-1 (]: Began executing node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:13:59.703444 [debug] [Thread-1 (]: Finished running node test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec
[0m08:13:59.706267 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:13:59.708484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.not_null_fct_messages_message_pk.100eaa15ec, now test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241)
[0m08:13:59.710602 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:13:59.726430 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241"
[0m08:13:59.752798 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:13:59.756913 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241
[0m08:13:59.759508 [debug] [Thread-1 (]: Began running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:13:59.761933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_dbt.relationships_fct_messages_channel_sk__channel_sk__ref_dim_channels_.928e093241, now test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1)
[0m08:13:59.764082 [debug] [Thread-1 (]: Began compiling node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:13:59.776195 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1"
[0m08:13:59.800565 [debug] [Thread-1 (]: Began executing node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:13:59.804664 [debug] [Thread-1 (]: Finished running node test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1
[0m08:13:59.809067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:59.811299 [debug] [MainThread]: Connection 'test.medical_dbt.relationships_fct_messages_message_date_key__date_day__ref_dim_dates_.52fe6adac1' was properly closed.
[0m08:13:59.819230 [debug] [MainThread]: Command end result
[0m08:14:00.045099 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:14:00.060090 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:14:00.082019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m08:14:00.131888 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m08:14:00.134018 [info ] [MainThread]: Building catalog
[0m08:14:00.152853 [debug] [ThreadPool]: Acquiring new postgres connection 'medical_insights.information_schema'
[0m08:14:00.164022 [debug] [ThreadPool]: Using postgres connection "medical_insights.information_schema"
[0m08:14:00.166706 [debug] [ThreadPool]: On medical_insights.information_schema: BEGIN
[0m08:14:00.169975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:14:00.177709 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:14:00.179394 [debug] [ThreadPool]: Using postgres connection "medical_insights.information_schema"
[0m08:14:00.180910 [debug] [ThreadPool]: On medical_insights.information_schema: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "medical_insights.information_schema"} */

    
    

    select
        'medical_insights' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_dates')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_image_detections')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m08:14:00.194867 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.012 seconds
[0m08:14:00.201330 [debug] [ThreadPool]: On medical_insights.information_schema: ROLLBACK
[0m08:14:00.203506 [debug] [ThreadPool]: On medical_insights.information_schema: Close
[0m08:14:00.241942 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/src/dbt/target/catalog.json
[0m08:14:00.322164 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m08:14:00.334814 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m08:14:00.337194 [info ] [MainThread]: Catalog written to /app/src/dbt/target/catalog.json
[0m08:14:00.359750 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.8660724, "process_in_blocks": "98472", "process_kernel_time": 0.359484, "process_mem_max_rss": "118548", "process_out_blocks": "0", "process_user_time": 3.594846}
[0m08:14:00.362862 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:14:00.362657 after 3.87 seconds
[0m08:14:00.365328 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:14:00.367641 [debug] [MainThread]: Connection 'medical_insights.information_schema' was properly closed.
[0m08:14:00.370229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09801a7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097f763970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097d503af0>]}
[0m08:14:00.372639 [debug] [MainThread]: Flushing usage events
[0m08:14:01.403648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:15:39.378693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b203cf9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f136e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f136da0>]}


============================== 08:15:39.387683 | 1ec293d9-2cd9-4811-8acd-6bf3f2005f5e ==============================
[0m08:15:39.387683 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:15:39.391783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/src/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --project-dir /app/src/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:15:39.792719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ec293d9-2cd9-4811-8acd-6bf3f2005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b21c44dc0>]}
[0m08:15:39.873494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ec293d9-2cd9-4811-8acd-6bf3f2005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f974970>]}
[0m08:19:00.165079 [error] [MainThread]: Encountered an error:

[0m08:19:00.182172 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m08:19:00.187579 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 200.9715, "process_in_blocks": "92144", "process_kernel_time": 0.207689, "process_mem_max_rss": "104552", "process_out_blocks": "72", "process_user_time": 2.284579}
[0m08:19:00.191891 [debug] [MainThread]: Command `dbt docs serve` failed at 08:19:00.191555 after 200.98 seconds
[0m08:19:00.194443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b203cf9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1e3e73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1e3e73d0>]}
[0m08:19:00.198051 [debug] [MainThread]: Flushing usage events
[0m08:19:01.305116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:47.418826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a83db8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a7136c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a7136b30>]}


============================== 08:22:47.432329 | cbb154fb-4b5e-474e-bb9d-cbc15dc8fe2a ==============================
[0m08:22:47.432329 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:22:47.434301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/src/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve --project-dir /app/src/dbt --host 0.0.0.0', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:22:47.791126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb154fb-4b5e-474e-bb9d-cbc15dc8fe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a7297460>]}
[0m08:22:47.869798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbb154fb-4b5e-474e-bb9d-cbc15dc8fe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9a8082500>]}
[0m13:31:15.493032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9f3538b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9e0ba9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9e0ba980>]}


============================== 13:31:15.499582 | 5e6038f5-a39a-428b-9f53-b650cf7c9461 ==============================
[0m13:31:15.499582 [info ] [MainThread]: Running with dbt=1.10.4
[0m13:31:15.501104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/src/dbt/logs', 'profiles_dir': '/app/src/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/src/dbt --profiles-dir /app/src/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:15.697132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa093f4c0>]}
[0m13:31:15.754701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9eff6500>]}
[0m13:31:15.757949 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:15.823501 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m13:31:16.106139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m13:31:16.107529 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/schema.yml
[0m13:31:16.109201 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/marts/schema.yml
[0m13:31:16.110859 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/marts/dim_channels.sql
[0m13:31:16.112263 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/staging/stg_telegram_messages.sql
[0m13:31:16.113909 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/marts/fct_messages.sql
[0m13:31:16.115131 [debug] [MainThread]: Partial parsing: updated file: medical_dbt://models/marts/dim_dates.sql
[0m13:31:16.636943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a98f42800>]}
[0m13:31:16.747301 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m13:31:16.754777 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m13:31:16.784400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9c74c760>]}
[0m13:31:16.786118 [info ] [MainThread]: Found 5 models, 19 data tests, 1 source, 433 macros
[0m13:31:16.788219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9c74c880>]}
[0m13:31:16.791915 [info ] [MainThread]: 
[0m13:31:16.793604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:16.795061 [info ] [MainThread]: 
[0m13:31:16.797221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:16.803581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_insights'
[0m13:31:16.841137 [debug] [ThreadPool]: Using postgres connection "list_medical_insights"
[0m13:31:16.842881 [debug] [ThreadPool]: On list_medical_insights: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights"} */

    select distinct nspname from pg_namespace
  
[0m13:31:16.844466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:16.849760 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m13:31:16.852029 [debug] [ThreadPool]: On list_medical_insights: Close
[0m13:31:16.855795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_insights, now list_medical_insights_public)
[0m13:31:16.862303 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m13:31:16.863312 [debug] [ThreadPool]: On list_medical_insights_public: BEGIN
[0m13:31:16.864217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:16.868071 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:31:16.869926 [debug] [ThreadPool]: Using postgres connection "list_medical_insights_public"
[0m13:31:16.871117 [debug] [ThreadPool]: On list_medical_insights_public: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "list_medical_insights_public"} */
select
      'medical_insights' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'medical_insights' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:31:16.875988 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:31:16.877882 [debug] [ThreadPool]: On list_medical_insights_public: ROLLBACK
[0m13:31:16.879178 [debug] [ThreadPool]: On list_medical_insights_public: Close
[0m13:31:16.884561 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:16.888412 [debug] [MainThread]: On master: BEGIN
[0m13:31:16.889488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:16.893190 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:31:16.894444 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:16.895351 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:16.902846 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m13:31:16.904489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9e073f10>]}
[0m13:31:16.905792 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:16.906651 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:16.907451 [debug] [MainThread]: On master: BEGIN
[0m13:31:16.908278 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:31:16.909065 [debug] [MainThread]: On master: COMMIT
[0m13:31:16.909774 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:16.910522 [debug] [MainThread]: On master: COMMIT
[0m13:31:16.911808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:16.912951 [debug] [MainThread]: On master: Close
[0m13:31:16.918908 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_dates
[0m13:31:16.920174 [info ] [Thread-1 (]: 1 of 5 START sql view model public.dim_dates ................................... [RUN]
[0m13:31:16.921472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medical_insights_public, now model.medical_dbt.dim_dates)
[0m13:31:16.922921 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_dates
[0m13:31:16.930245 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_dates"
[0m13:31:16.939189 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_dates
[0m13:31:16.972437 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_dates"
[0m13:31:16.980390 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m13:31:16.982667 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: BEGIN
[0m13:31:16.989652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:16.996673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:31:17.000496 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m13:31:17.003375 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */

  create view "medical_insights"."public"."dim_dates__dbt_tmp"
    
    
  as (
    -- models/marts/dim_dates.sql

WITH date_spine AS (
    SELECT
        GENERATE_SERIES(
            '2023-01-01'::DATE,
            CURRENT_DATE + INTERVAL '1 year',
            '1 day'::INTERVAL
        )::DATE AS date_day
),

date_attributes AS (
    SELECT
        date_day,
        EXTRACT(YEAR FROM date_day) AS year,
        EXTRACT(MONTH FROM date_day) AS month,
        TO_CHAR(date_day, 'Month') AS month_name,
        EXTRACT(DAY FROM date_day) AS day_of_month,
        EXTRACT(DOW FROM date_day) AS day_of_week, -- Sunday = 0, Saturday = 6
        TO_CHAR(date_day, 'Day') AS day_name,
        EXTRACT(DOY FROM date_day) AS day_of_year,
        EXTRACT(WEEK FROM date_day) AS week_of_year,
        EXTRACT(QUARTER FROM date_day) AS quarter_of_year,
        TO_CHAR(date_day, 'YYYY-MM') AS year_month,
        TO_CHAR(date_day, 'YYYY-MM-DD') AS full_date_string,
        (CASE WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE ELSE FALSE END) AS is_weekend
    FROM date_spine
)

SELECT *
FROM date_attributes
  );
[0m13:31:17.012458 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:31:17.021529 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m13:31:17.023157 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
alter table "medical_insights"."public"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m13:31:17.024853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:31:17.038051 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m13:31:17.039356 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m13:31:17.040604 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: COMMIT
[0m13:31:17.043010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:31:17.049502 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_dates__dbt_backup"
[0m13:31:17.055731 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_dates"
[0m13:31:17.056945 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_dates"} */
drop view if exists "medical_insights"."public"."dim_dates__dbt_backup" cascade
[0m13:31:17.059397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:31:17.062562 [debug] [Thread-1 (]: On model.medical_dbt.dim_dates: Close
[0m13:31:17.065226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa093f760>]}
[0m13:31:17.066805 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.dim_dates .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m13:31:17.069283 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_dates
[0m13:31:17.070837 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_image_detections
[0m13:31:17.071870 [info ] [Thread-1 (]: 2 of 5 START sql view model public.fct_image_detections ........................ [RUN]
[0m13:31:17.073744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_dates, now model.medical_dbt.fct_image_detections)
[0m13:31:17.075235 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_image_detections
[0m13:31:17.079563 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_image_detections"
[0m13:31:17.088199 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_image_detections
[0m13:31:17.092204 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_image_detections"
[0m13:31:17.102355 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m13:31:17.103604 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: BEGIN
[0m13:31:17.104795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:17.108231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m13:31:17.109805 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m13:31:17.111179 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */

  create view "medical_insights"."public"."fct_image_detections__dbt_tmp"
    
    
  as (
    -- models/marts/fct_image_detections.sql

SELECT
    md5(concat(message_id::text, object_class, detection_time::text)) AS detection_pk, -- surrogate key
    message_id,
    image_id,
    object_class,
    confidence_score,
    detection_time
FROM (
    VALUES
        (NULL, NULL, NULL, NULL, NULL) -- Placeholder row, to be replaced by enrichment process
) AS t(message_id, image_id, object_class, confidence_score, detection_time)
WHERE message_id IS NOT NULL
  );
[0m13:31:17.114636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:31:17.119259 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m13:31:17.120779 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
alter table "medical_insights"."public"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m13:31:17.122438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:31:17.124650 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m13:31:17.125724 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m13:31:17.126524 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: COMMIT
[0m13:31:17.128505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:31:17.131159 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_image_detections__dbt_backup"
[0m13:31:17.133388 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_image_detections"
[0m13:31:17.134820 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_image_detections"} */
drop view if exists "medical_insights"."public"."fct_image_detections__dbt_backup" cascade
[0m13:31:17.136253 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:31:17.138185 [debug] [Thread-1 (]: On model.medical_dbt.fct_image_detections: Close
[0m13:31:17.139286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9bfaa3b0>]}
[0m13:31:17.140840 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.fct_image_detections ................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:31:17.142691 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_image_detections
[0m13:31:17.143685 [debug] [Thread-1 (]: Began running node model.medical_dbt.stg_telegram_messages
[0m13:31:17.144754 [info ] [Thread-1 (]: 3 of 5 START sql view model public.stg_telegram_messages ....................... [RUN]
[0m13:31:17.145817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.fct_image_detections, now model.medical_dbt.stg_telegram_messages)
[0m13:31:17.146686 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.stg_telegram_messages
[0m13:31:17.151486 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.stg_telegram_messages"
[0m13:31:17.159564 [debug] [Thread-1 (]: Began executing node model.medical_dbt.stg_telegram_messages
[0m13:31:17.163460 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.stg_telegram_messages"
[0m13:31:17.190999 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m13:31:17.192102 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: BEGIN
[0m13:31:17.193041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:17.196963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:31:17.198123 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m13:31:17.200661 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */

  create view "medical_insights"."public"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

WITH raw_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        data AS raw_data,
        scraped_at
    FROM "medical_insights"."raw"."telegram_messages"
),

cleaned_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        scraped_at,
        raw_data->>'message' AS message_text,
        (raw_data->>'date')::TIMESTAMP AS message_date,
        (raw_data->>'views')::INT AS views_count,
        (raw_data->>'forwards')::INT AS forwards_count,
        (raw_data->'replies'->>'replies') AS replies_count, -- Fixed extraction for replies_count
        (raw_data->>'reactions') IS NOT NULL AS has_reactions,
        (raw_data->>'photo') IS NOT NULL AS has_photo,
        -- Extract product mentions (enhanced regex for Ethiopian context)
        REGEXP_MATCHES(
            raw_data->>'message',
            '(?i)(paracetamol|amoxicillin|ibuprofen|diclofenac|metronidazole|coartem|albendazole|ORS|syrup|tablet|capsule|suspension|injection|vaccine|antimalarial|antibiotic|antifungal|antiviral|cream|pill)s?',
            'g'
        ) AS product_mentions,
        channel_name || '-' || message_id AS channel_message_unique
    FROM raw_messages
    WHERE raw_data->>'message' IS NOT NULL OR raw_data->>'photo' IS NOT NULL
),

deduped_messages AS (
    SELECT *,
        ROW_NUMBER() OVER (PARTITION BY channel_name, message_id ORDER BY scraped_at ASC) AS rn
    FROM cleaned_messages
)

SELECT
    id,
    channel_name,
    message_id,
    message_text,
    message_date,
    COALESCE(views_count, 0) AS views_count,
    COALESCE(forwards_count, 0) AS forwards_count,
    COALESCE(replies_count::INT, 0) AS replies_count,
    has_reactions,
    has_photo,
    product_mentions,
    scraped_at,
    channel_message_unique
FROM deduped_messages
WHERE rn = 1
  );
[0m13:31:17.207030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:31:17.210700 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m13:31:17.211776 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
alter table "medical_insights"."public"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m13:31:17.213247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:31:17.215017 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m13:31:17.216815 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m13:31:17.217845 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: COMMIT
[0m13:31:17.220262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:31:17.223196 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."stg_telegram_messages__dbt_backup"
[0m13:31:17.224318 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.stg_telegram_messages"
[0m13:31:17.225170 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.stg_telegram_messages"} */
drop view if exists "medical_insights"."public"."stg_telegram_messages__dbt_backup" cascade
[0m13:31:17.226207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:31:17.227906 [debug] [Thread-1 (]: On model.medical_dbt.stg_telegram_messages: Close
[0m13:31:17.229128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a982b6dd0>]}
[0m13:31:17.230774 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.stg_telegram_messages .................. [[32mCREATE VIEW[0m in 0.08s]
[0m13:31:17.233145 [debug] [Thread-1 (]: Finished running node model.medical_dbt.stg_telegram_messages
[0m13:31:17.235536 [debug] [Thread-1 (]: Began running node model.medical_dbt.dim_channels
[0m13:31:17.237636 [info ] [Thread-1 (]: 4 of 5 START sql view model public.dim_channels ................................ [RUN]
[0m13:31:17.239351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.stg_telegram_messages, now model.medical_dbt.dim_channels)
[0m13:31:17.240801 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.dim_channels
[0m13:31:17.244358 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.dim_channels"
[0m13:31:17.252823 [debug] [Thread-1 (]: Began executing node model.medical_dbt.dim_channels
[0m13:31:17.257400 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.dim_channels"
[0m13:31:17.268056 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m13:31:17.269845 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: BEGIN
[0m13:31:17.272896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:17.277708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:31:17.280456 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m13:31:17.282487 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */

  create view "medical_insights"."public"."dim_channels__dbt_tmp"
    
    
  as (
    -- models/marts/dim_channels.sql

SELECT DISTINCT
    channel_name,
    MD5(channel_name) AS channel_sk -- Surrogate key for channel
FROM "medical_insights"."public"."stg_telegram_messages"
  );
[0m13:31:17.286390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:31:17.290048 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m13:31:17.290977 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
alter table "medical_insights"."public"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m13:31:17.292053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:31:17.293708 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m13:31:17.294772 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m13:31:17.295679 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: COMMIT
[0m13:31:17.297935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:31:17.302477 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."dim_channels__dbt_backup"
[0m13:31:17.303733 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.dim_channels"
[0m13:31:17.304694 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.dim_channels"} */
drop view if exists "medical_insights"."public"."dim_channels__dbt_backup" cascade
[0m13:31:17.305831 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:31:17.307411 [debug] [Thread-1 (]: On model.medical_dbt.dim_channels: Close
[0m13:31:17.308481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9814a200>]}
[0m13:31:17.309774 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.dim_channels ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:31:17.311102 [debug] [Thread-1 (]: Finished running node model.medical_dbt.dim_channels
[0m13:31:17.312507 [debug] [Thread-1 (]: Began running node model.medical_dbt.fct_messages
[0m13:31:17.314021 [info ] [Thread-1 (]: 5 of 5 START sql view model public.fct_messages ................................ [RUN]
[0m13:31:17.315539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_dbt.dim_channels, now model.medical_dbt.fct_messages)
[0m13:31:17.316402 [debug] [Thread-1 (]: Began compiling node model.medical_dbt.fct_messages
[0m13:31:17.320287 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_dbt.fct_messages"
[0m13:31:17.326900 [debug] [Thread-1 (]: Began executing node model.medical_dbt.fct_messages
[0m13:31:17.330713 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_dbt.fct_messages"
[0m13:31:17.351915 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m13:31:17.353242 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: BEGIN
[0m13:31:17.354145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:17.357745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:31:17.358728 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m13:31:17.359723 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */

  create view "medical_insights"."public"."fct_messages__dbt_tmp"
    
    
  as (
    -- models/marts/fct_messages.sql

WITH stg_messages AS (
    SELECT
        id,
        channel_name,
        message_id,
        message_text,
        message_date,
        views_count,
        forwards_count,
        replies_count,
        has_reactions,
        has_photo,
        product_mentions,
        scraped_at
    FROM "medical_insights"."public"."stg_telegram_messages"
),

channels AS (
    SELECT
        channel_name,
        channel_sk
    FROM "medical_insights"."public"."dim_channels"
),

dates AS (
    SELECT
        date_day,
        year,
        month,
        day_of_month
    FROM "medical_insights"."public"."dim_dates"
)

SELECT
    sm.id AS message_pk,
    sm.message_id,
    sm.message_text,
    LENGTH(sm.message_text) AS message_length,
    sm.message_date,
    sm.views_count,
    sm.forwards_count,
    sm.replies_count,
    sm.has_reactions,
    sm.has_photo,
    sm.product_mentions,
    sm.scraped_at,
    c.channel_sk,
    d.date_day AS message_date_key
FROM stg_messages sm
LEFT JOIN channels c ON sm.channel_name = c.channel_name
LEFT JOIN dates d ON sm.message_date::DATE = d.date_day
  );
[0m13:31:17.363404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:31:17.367796 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m13:31:17.369508 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
alter table "medical_insights"."public"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m13:31:17.371087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:31:17.372914 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m13:31:17.373849 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m13:31:17.374712 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: COMMIT
[0m13:31:17.376681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:31:17.379470 [debug] [Thread-1 (]: Applying DROP to: "medical_insights"."public"."fct_messages__dbt_backup"
[0m13:31:17.380778 [debug] [Thread-1 (]: Using postgres connection "model.medical_dbt.fct_messages"
[0m13:31:17.381672 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "medical_dbt", "target_name": "dev", "node_id": "model.medical_dbt.fct_messages"} */
drop view if exists "medical_insights"."public"."fct_messages__dbt_backup" cascade
[0m13:31:17.383056 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:31:17.384792 [debug] [Thread-1 (]: On model.medical_dbt.fct_messages: Close
[0m13:31:17.386100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6038f5-a39a-428b-9f53-b650cf7c9461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a98f93e20>]}
[0m13:31:17.387255 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.fct_messages ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:31:17.388451 [debug] [Thread-1 (]: Finished running node model.medical_dbt.fct_messages
[0m13:31:17.390617 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:17.391842 [debug] [MainThread]: On master: BEGIN
[0m13:31:17.392851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:17.397083 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:31:17.398717 [debug] [MainThread]: On master: COMMIT
[0m13:31:17.399695 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:17.400600 [debug] [MainThread]: On master: COMMIT
[0m13:31:17.401657 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:17.402830 [debug] [MainThread]: On master: Close
[0m13:31:17.404016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:17.405005 [debug] [MainThread]: Connection 'model.medical_dbt.fct_messages' was properly closed.
[0m13:31:17.405922 [info ] [MainThread]: 
[0m13:31:17.407550 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m13:31:17.409547 [debug] [MainThread]: Command end result
[0m13:31:17.447477 [debug] [MainThread]: Wrote artifact WritableManifest to /app/src/dbt/target/manifest.json
[0m13:31:17.472335 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/src/dbt/target/semantic_manifest.json
[0m13:31:17.487159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/src/dbt/target/run_results.json
[0m13:31:17.497511 [info ] [MainThread]: 
[0m13:31:17.499751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:17.501688 [info ] [MainThread]: 
[0m13:31:17.503481 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:31:17.506774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.086855, "process_in_blocks": "6960", "process_kernel_time": 0.111044, "process_mem_max_rss": "127560", "process_out_blocks": "64", "process_user_time": 2.392495}
[0m13:31:17.507925 [debug] [MainThread]: Command `dbt run` succeeded at 13:31:17.507816 after 2.09 seconds
[0m13:31:17.509225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9f3538b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a98f83c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9f001930>]}
[0m13:31:17.510646 [debug] [MainThread]: Flushing usage events
[0m13:31:18.648435 [debug] [MainThread]: An error was encountered while trying to flush usage events
